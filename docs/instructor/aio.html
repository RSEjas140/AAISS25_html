<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>AISS25: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/swc/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicons/swc/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicons/swc/favicon-16x16.png">
<link rel="manifest" href="../favicons/swc/site.webmanifest">
<link rel="mask-icon" href="../favicons/swc/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav software"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="swc-logo" alt="Aberystwyth AI Summer School 2025" src="../assets/images/software-logo.svg"><span class="badge text-bg-warning">
          <abbr title="This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-triangle" style="border-radius: 5px"></i>
              Alpha
            </a>
            <span class="visually-hidden">This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav software" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Aberystwyth AI Summer School 2025" src="../assets/images/software-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      AISS25
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            AISS25
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<hr>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  AISS25
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress software">
    <div class="progress-bar software" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-worked-example.html">1. Working Example</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="01-problem-definition.html">2. Problem Definition</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="02-data-exploration-and-preprocessing.html">3. Data exploration and Preprocessing</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-model-selection%202.html">4. Machine learning: Model Selection</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-training.html">5. Machine learning: model training</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-00-worked-example"><p>Content from <a href="00-worked-example.html">Working Example</a></p>
<hr>
<p>Last updated on 2025-07-06 |

        <a href="https://github.com/RSEjas140/AAISS25_html/edit/main/episodes/00-worked-example.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 70 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What can a typical machine learning project look like from start to
finish?</li>
<li>How can I approach solving a problem with machine learning in
Python?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the core structure and key stages of a machine learning
project</li>
<li>Run through a complete worked example, from data to evaluation</li>
<li>Begin exploring how to design your own ML solution for a problem in
your domain</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="section level3">
<h3 id="time-to-dive-right-in">Time to Dive Right In<a class="anchor" aria-label="anchor" href="#time-to-dive-right-in"></a>
</h3>
<p>We’re going to jump straight into the deep end by running a worked
example that you’ve already set up during the summary and installation
steps. <strong>Don’t worry if you don’t understand everything right away
— that’s completely normal.</strong> This first run-through is meant to
give you a high-level sense of how all the pieces fit together.</p>
<p>Throughout the week, we’ll break down each stage of this process in
detail, so by the end you’ll have a solid understanding of each part. As
you go through this example, try and think about how these steps might
apply to your own data.</p>
<blockquote>
<p><strong>Note:</strong> For transparency, all scenarios in these
lessons are entirely fictional and not intended to represent real-world
data or fieldwork.</p>
</blockquote>
<p><br></p>
</div>
<section><h2 class="section-heading" id="scenario-pick-a-penguin">Scenario: Pick a Penguin 🐧<a class="anchor" aria-label="anchor" href="#scenario-pick-a-penguin"></a>
</h2>
<hr class="half-width">
<p>A team of marine biologists working in Antarctica is keen to
<strong>identify penguin species</strong>, as the balance between these
species is a crucial indicator of climate change and the overall health
of marine ecosystems. However, capturing penguins to determine their
species is both <strong>costly</strong> and <strong>disruptive to
wildlife</strong>.</p>
<p>To minimize costs and reduce disturbance, they are exploring whether
remote camera stations equipped with automated detection algorithms
could monitor and track penguin colonies without close contact or
physical handling. As a <strong>first step</strong>, they want to
evaluate how reliably <strong>species can be classified based on
observable features</strong> alone.</p>
<p><strong>They have already assembled a dataset</strong> containing
individual penguins with known species labels, along with various
characteristics such as the island where each was found, bill length and
depth, flipper length, body mass, and sex.</p>
<p>Because they collected the data themselves, they are highly confident
in its overall quality and content. However, the data for the island
variable has been corrupted due to an unknown processing error, so it
will need to be removed from the analysis.</p>
<p><br></p>
<p><img src="../fig/penguins2.png" alt="Penguins" class="figure"><br><em>Guide to Penguins, <a href="https://uk.expeditions.com/expedition-stories/stories/meet-the-penguins-of-the-southern-ocean" class="external-link">NatGeoUK_Expeditions</a></em></p>
<p><br></p>
<p>Based on this dataset, they want to explore the following
question:</p>
<div id="problem-definition" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="problem-definition" class="callout-inner">
<h3 class="callout-title">Problem definition</h3>
<div class="section level4 callout-content">
<h4 id="can-we-accurately-predict-penguin-species-adelie-chinstrap-gentoo-using-features-such-as-bill-length-bill-depth-flipper-length-body-mass-and-sex-additionally-which-of-these-features-are-most-important-for-distinguishing-between-species">Can we accurately <strong>predict penguin species</strong> (Adelie,
Chinstrap, Gentoo) using features such as bill length, bill depth,
flipper length, body mass, and sex? Additionally, which of these
<strong>features are most important</strong> for distinguishing between
species?<a class="anchor" aria-label="anchor" href="#can-we-accurately-predict-penguin-species-adelie-chinstrap-gentoo-using-features-such-as-bill-length-bill-depth-flipper-length-body-mass-and-sex-additionally-which-of-these-features-are-most-important-for-distinguishing-between-species"></a>
</h4>
</div>
</div>
</div>
<p><br></p>
<div id="your-task" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="your-task" class="callout-inner">
<h3 class="callout-title">Your task</h3>
<div class="callout-content">
<p>We’ll use this scenario to walk through the typical stages of a
machine learning project. Now that we’ve defined the problem, here are
the next steps on our journey:</p>
<ul>
<li>
<strong>Import the data:</strong> Load the penguin dataset into our
environment.</li>
<li>
<strong>Explore the data:</strong> Understand its structure, look
for patterns, and identify any missing or unusual values.</li>
<li>
<strong>Preprocess the data:</strong> Clean and transform the data
so it’s ready for modeling.</li>
<li>
<strong>Select a model:</strong> Choose an algorithm to predict
species based on the available features.</li>
<li>
<strong>Train and test:</strong> Split the data to train the model
and evaluate how well it performs on new data.</li>
<li>
<strong>Evaluate results:</strong> Measure the model’s accuracy and
see which features are most influential in distinguishing penguin
species.</li>
</ul>
</div>
</div>
</div>
<p><br></p>
<hr></section><section><h2 class="section-heading" id="import-libraries">Import Libraries<a class="anchor" aria-label="anchor" href="#import-libraries"></a>
</h2>
<hr class="half-width">
<p>If you attended the Python introduction session, some of this code
should look familiar. We’ll start by <strong>importing the libraries we
need</strong> and then <strong>loading our dataset</strong> so we can
begin exploring it.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># import the libraries we intend to use</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier, plot_tree</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, ConfusionMatrixDisplay</span></code></pre>
</div>
<p><br></p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># use pandas to import our csv datafile</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>df_peng <span class="op">=</span> pd.read_csv(<span class="st">'data/penguins.csv'</span>)</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="inspect-the-data">Inspect the Data<a class="anchor" aria-label="anchor" href="#inspect-the-data"></a>
</h2>
<hr class="half-width">
<p>Before doing anything else, we want to understand what our data looks
like. We’ll start by inspecting the <strong>first 10 rows</strong> and
checking the <strong>shape of the table</strong> to see how many rows
(records of penguins) and how many columns (features) it contains.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Show me first 10 rows and the shape of the table</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="bu">print</span>(df_peng.head(<span class="dv">10</span>))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  species     island  bill_length_mm  ...  flipper_length_mm  body_mass_g     sex
0  Adelie  Torgersen            39.1  ...              181.0       3750.0    Male
1  Adelie  Torgersen            39.5  ...              186.0       3800.0  Female
2  Adelie  Torgersen            40.3  ...              195.0       3250.0  Female
3  Adelie  Torgersen             NaN  ...                NaN          NaN     NaN
4  Adelie  Torgersen            36.7  ...              193.0       3450.0  Female
5  Adelie  Torgersen            39.3  ...              190.0       3650.0    Male
6  Adelie  Torgersen            38.9  ...              181.0       3625.0  Female
7  Adelie  Torgersen            39.2  ...              195.0       4675.0    Male
8  Adelie  Torgersen            34.1  ...              193.0       3475.0     NaN
9  Adelie  Torgersen            42.0  ...              190.0       4250.0     NaN

[10 rows x 7 columns]</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="bu">print</span>(df_peng.shape)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>(344, 7)</code></pre>
</div>
<p><br></p>
<p>We can see that there are some <strong>missing values</strong> (NaN)
in the dataset. Overall, the data includes <strong>334 rows</strong> and
<strong>7 columns</strong>. Before we check that the contents match what
we expect, we’ll remove the <strong>island</strong> column since we’ve
been told this data is corrupted.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co">#drop island due to the processing error</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>df_peng <span class="op">=</span> df_peng.drop(<span class="st">"island"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co"># check species column is as expected</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'species::'</span>, df_peng[<span class="st">'species'</span>].unique())</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>species:: ['Adelie' 'Chinstrap' 'Gentoo']</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># check all column headers</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'column headers:'</span>, df_peng.columns)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>column headers: Index(['species', 'bill_length_mm', 'bill_depth_mm', 'flipper_length_mm',
       'body_mass_g', 'sex'],
      dtype='object')</code></pre>
</div>
<p><br></p>
<p>We can see that the dataset contains the expected species and
features (now without the island column). Next, we’ll focus on the
columns with numeric values and visualize their distributions to check
for any outliers.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Which features are we able to visualise distribution?</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>distribution_features <span class="op">=</span> [<span class="st">'bill_length_mm'</span>, <span class="st">'bill_depth_mm'</span>, <span class="st">'flipper_length_mm'</span>, <span class="st">'body_mass_g'</span>]</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co"># enumerate gives us a numeric value as well as our feature during our loop</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="cf">for</span> i, feature <span class="kw">in</span> <span class="bu">enumerate</span>(distribution_features, <span class="dv">1</span>): <span class="co">#starting from 1 in our numeric loop</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>    </span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>    <span class="co"># plot position</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, i) </span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>    </span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>    <span class="co">#create a histogram from our feature with 10 bins </span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>    df_peng[feature].hist(bins<span class="op">=</span><span class="dv">10</span>) </span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>    </span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>    <span class="co"># add axis labels</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>    plt.xlabel(feature)</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>    plt.ylabel(<span class="st">'Count'</span>)</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>plt.show()</span></code></pre>
</div>
<figure><img src="../fig/00-worked-example-rendered-unnamed-chunk-5-1.png" width="1152" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p><br></p>
<p>We don’t see any suspicious values, which is a good sign, but we
still need to investigate the missing values we identified earlier.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># How many Null values do we have?</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="bu">print</span>(df_peng.isna().<span class="bu">sum</span>())</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>species               0
bill_length_mm        2
bill_depth_mm         2
flipper_length_mm     2
body_mass_g           2
sex                  11
dtype: int64</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="bu">print</span>(df_peng.isna().mean() <span class="op">*</span> <span class="dv">100</span>) </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>species              0.000000
bill_length_mm       0.581395
bill_depth_mm        0.581395
flipper_length_mm    0.581395
body_mass_g          0.581395
sex                  3.197674
dtype: float64</code></pre>
</div>
<p>We can see that there are only minimal missing values in the dataset,
with the highest being in the <strong>sex</strong> column, where just
over 3% of the data is missing.</p>
</section><section><h2 class="section-heading" id="preprocessing">Preprocessing<a class="anchor" aria-label="anchor" href="#preprocessing"></a>
</h2>
<hr class="half-width">
<p>To keep things simple, we’ll remove any rows that contain missing
values. This approach may be a little niave, but we’ll explore more
sophisticated options later in the week.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co">#Pre-processing - to 'fix' we remove any rows that have NaN values</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#check shape before removal</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Pre cleaning shape:'</span>, df_peng.shape)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Pre cleaning shape: (344, 6)</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># drop all rows that have NaN values</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>df_peng_clean <span class="op">=</span> df_peng.dropna()</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#check shape after removal</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Post cleaning shape:'</span>, df_peng_clean.shape)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Post cleaning shape: (333, 6)</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co">#manual check first 10 rows for confirmation</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="bu">print</span>(df_peng_clean.head(<span class="dv">10</span>))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   species  bill_length_mm  ...  body_mass_g     sex
0   Adelie            39.1  ...       3750.0    Male
1   Adelie            39.5  ...       3800.0  Female
2   Adelie            40.3  ...       3250.0  Female
4   Adelie            36.7  ...       3450.0  Female
5   Adelie            39.3  ...       3650.0    Male
6   Adelie            38.9  ...       3625.0  Female
7   Adelie            39.2  ...       4675.0    Male
12  Adelie            41.1  ...       3200.0  Female
13  Adelie            38.6  ...       3800.0    Male
14  Adelie            34.6  ...       4400.0    Male

[10 rows x 6 columns]</code></pre>
</div>
<p><br></p>
<p>We split the dataset into two separate components:
<strong>features</strong> (<code>X</code>) and <strong>labels</strong>
(<code>y</code>). The features (<code>X</code>) include all the measured
characteristics of each penguin that will be used as input to the
machine learning model, such as bill dimensions, flipper length, body
mass, and encoded sex. The labels (<code>y</code>) consist solely of the
<code>species</code> column, which represents the target variable we
want our model to predict.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># split the features and labeled data</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="co"># features</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>X <span class="op">=</span> df_peng_clean.drop(<span class="st">"species"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co"># label</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>y <span class="op">=</span> df_peng_clean[<span class="st">"species"</span>]</span></code></pre>
</div>
<p><br></p>
<p>We now need to convert the <code>sex</code> column from its
categorical values into a numeric format to make it suitable for machine
learning models. Most models require all input features to be
represented as numbers, so this transformation ensures that the
<code>sex</code> information can be interpreted during training and
prediction.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co">#label encoder to change catergorical data to numeric</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>le <span class="op">=</span> LabelEncoder()</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co"># sex is female or male conver to 0,1 </span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>X[<span class="st">"sex"</span>] <span class="op">=</span> le.fit_transform(X[<span class="st">"sex"</span>])</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="training-test-split">Training &amp; Test split<a class="anchor" aria-label="anchor" href="#training-test-split"></a>
</h2>
<hr class="half-width">
<p>We split our data into two parts: <strong>80% for training the
model</strong> and <strong>20% for testing how well it performs on new,
unseen data</strong>. The <code>random_state</code> ensures we get the
same split each time we run the code, making results reproducible.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co">#split our data into 20% testing 80% training (random state allows for reproducability)</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>    X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">0</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>)</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="model-selection-training">Model Selection &amp; Training<a class="anchor" aria-label="anchor" href="#model-selection-training"></a>
</h2>
<hr class="half-width">
<p>We select a decision tree as our initial baseline model because it
provides a high level of <strong>interpretability and
explainability</strong>. In our problem definition, we stated that
beyond predicting penguin species, we also want to understand
<strong>which features are important for making those
predictions</strong>.</p>
<p>A decision tree naturally reveals this by showing us the sequence of
decisions (feature splits) it makes, along with the thresholds it uses.
This makes it easy to see, for example, whether flipper length or bill
depth is more influential in classifying the species. As a result, using
a decision tree helps us both establish a benchmark for predictive
accuracy and gain direct insights into the factors driving our
classifications.</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co">#Generate a decision tree classifier, max depth of 2 means maximum 2 checks to split the data</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>clf <span class="op">=</span> DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">0</span>, max_depth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="co"># train the model on our training data</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>clf.fit(X_train, y_train)</span></code></pre>
</div>
<style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-1 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  display: none;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  display: block;
  width: 100%;
  overflow: visible;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}

.estimator-table summary {
    padding: .5rem;
    font-family: monospace;
    cursor: pointer;
}

.estimator-table details[open] {
    padding-left: 0.1rem;
    padding-right: 0.1rem;
    padding-bottom: 0.3rem;
}

.estimator-table .parameters-table {
    margin-left: auto !important;
    margin-right: auto !important;
}

.estimator-table .parameters-table tr:nth-child(odd) {
    background-color: #fff;
}

.estimator-table .parameters-table tr:nth-child(even) {
    background-color: #f6f6f6;
}

.estimator-table .parameters-table tr:hover {
    background-color: #e0e0e0;
}

.estimator-table table td {
    border: 1px solid rgba(106, 105, 104, 0.232);
}

.user-set td {
    color:rgb(255, 94, 0);
    text-align: left;
}

.user-set td.value pre {
    color:rgb(255, 94, 0) !important;
    background-color: transparent !important;
}

.default td {
    color: black;
    text-align: left;
}

.user-set td i,
.default td i {
    color: black;
}

.copy-paste-icon {
    background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NDggNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNy4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjUgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTIwOCAwTDMzMi4xIDBjMTIuNyAwIDI0LjkgNS4xIDMzLjkgMTQuMWw2Ny45IDY3LjljOSA5IDE0LjEgMjEuMiAxNC4xIDMzLjlMNDQ4IDMzNmMwIDI2LjUtMjEuNSA0OC00OCA0OGwtMTkyIDBjLTI2LjUgMC00OC0yMS41LTQ4LTQ4bDAtMjg4YzAtMjYuNSAyMS41LTQ4IDQ4LTQ4ek00OCAxMjhsODAgMCAwIDY0LTY0IDAgMCAyNTYgMTkyIDAgMC0zMiA2NCAwIDAgNDhjMCAyNi41LTIxLjUgNDgtNDggNDhMNDggNTEyYy0yNi41IDAtNDgtMjEuNS00OC00OEwwIDE3NmMwLTI2LjUgMjEuNS00OCA0OC00OHoiLz48L3N2Zz4=);
    background-repeat: no-repeat;
    background-size: 14px 14px;
    background-position: 0;
    display: inline-block;
    width: 14px;
    height: 14px;
    cursor: pointer;
}
</style>
<div id="sk-container-id-1" class="sk-top-container">
<div class="sk-text-repr-fallback">
<pre>DecisionTreeClassifier(max_depth=2, random_state=0)</pre>
<b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b>
</div>
<div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable">
<input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>DecisionTreeClassifier</div></div>
<div>
<a class="external-link sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.7/modules/generated/sklearn.tree.DecisionTreeClassifier.html">?<span>Documentation for DecisionTreeClassifier</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span>
</div></label><div class="sk-toggleable__content fitted" data-param-prefix="">
        <div class="estimator-table">
            <details><summary>Parameters</summary><table class="table parameters-table"><tbody>
<tr class="default">
<td><i class="copy-paste-icon" onclick="copyToClipboard('criterion',
                          this.parentElement.nextElementSibling)"></i></td>
            <td class="param">criterion </td>
            <td class="value">'gini'</td>
        </tr>
<tr class="default">
<td><i class="copy-paste-icon" onclick="copyToClipboard('splitter',
                          this.parentElement.nextElementSibling)"></i></td>
            <td class="param">splitter </td>
            <td class="value">'best'</td>
        </tr>
<tr class="user-set">
<td><i class="copy-paste-icon" onclick="copyToClipboard('max_depth',
                          this.parentElement.nextElementSibling)"></i></td>
            <td class="param">max_depth </td>
            <td class="value">2</td>
        </tr>
<tr class="default">
<td><i class="copy-paste-icon" onclick="copyToClipboard('min_samples_split',
                          this.parentElement.nextElementSibling)"></i></td>
            <td class="param">min_samples_split </td>
            <td class="value">2</td>
        </tr>
<tr class="default">
<td><i class="copy-paste-icon" onclick="copyToClipboard('min_samples_leaf',
                          this.parentElement.nextElementSibling)"></i></td>
            <td class="param">min_samples_leaf </td>
            <td class="value">1</td>
        </tr>
<tr class="default">
<td><i class="copy-paste-icon" onclick="copyToClipboard('min_weight_fraction_leaf',
                          this.parentElement.nextElementSibling)"></i></td>
            <td class="param">min_weight_fraction_leaf </td>
            <td class="value">0.0</td>
        </tr>
<tr class="default">
<td><i class="copy-paste-icon" onclick="copyToClipboard('max_features',
                          this.parentElement.nextElementSibling)"></i></td>
            <td class="param">max_features </td>
            <td class="value">None</td>
        </tr>
<tr class="user-set">
<td><i class="copy-paste-icon" onclick="copyToClipboard('random_state',
                          this.parentElement.nextElementSibling)"></i></td>
            <td class="param">random_state </td>
            <td class="value">0</td>
        </tr>
<tr class="default">
<td><i class="copy-paste-icon" onclick="copyToClipboard('max_leaf_nodes',
                          this.parentElement.nextElementSibling)"></i></td>
            <td class="param">max_leaf_nodes </td>
            <td class="value">None</td>
        </tr>
<tr class="default">
<td><i class="copy-paste-icon" onclick="copyToClipboard('min_impurity_decrease',
                          this.parentElement.nextElementSibling)"></i></td>
            <td class="param">min_impurity_decrease </td>
            <td class="value">0.0</td>
        </tr>
<tr class="default">
<td><i class="copy-paste-icon" onclick="copyToClipboard('class_weight',
                          this.parentElement.nextElementSibling)"></i></td>
            <td class="param">class_weight </td>
            <td class="value">None</td>
        </tr>
<tr class="default">
<td><i class="copy-paste-icon" onclick="copyToClipboard('ccp_alpha',
                          this.parentElement.nextElementSibling)"></i></td>
            <td class="param">ccp_alpha </td>
            <td class="value">0.0</td>
        </tr>
<tr class="default">
<td><i class="copy-paste-icon" onclick="copyToClipboard('monotonic_cst',
                          this.parentElement.nextElementSibling)"></i></td>
            <td class="param">monotonic_cst </td>
            <td class="value">None</td>
        </tr>
</tbody></table></details>
</div>
    </div>
</div></div></div>
</div>
<script>function copyToClipboard(text, element) {
    // Get the parameter prefix from the closest toggleable content
    const toggleableContent = element.closest('.sk-toggleable__content');
    const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';
    const fullParamName = paramPrefix ? `${paramPrefix}${text}` : text;

    const originalStyle = element.style;
    const computedStyle = window.getComputedStyle(element);
    const originalWidth = computedStyle.width;
    const originalHTML = element.innerHTML.replace('Copied!', '');

    navigator.clipboard.writeText(fullParamName)
        .then(() => {
            element.style.width = originalWidth;
            element.style.color = 'green';
            element.innerHTML = "Copied!";

            setTimeout(() => {
                element.innerHTML = originalHTML;
                element.style = originalStyle;
            }, 2000);
        })
        .catch(err => {
            console.error('Failed to copy:', err);
            element.style.color = 'red';
            element.innerHTML = "Failed!";
            setTimeout(() => {
                element.innerHTML = originalHTML;
                element.style = originalStyle;
            }, 2000);
        });
    return false;
}

document.querySelectorAll('.fa-regular.fa-copy').forEach(function(element) {
    const toggleableContent = element.closest('.sk-toggleable__content');
    const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';
    const paramName = element.parentElement.nextElementSibling.textContent.trim();
    const fullParamName = paramPrefix ? `${paramPrefix}${paramName}` : paramName;

    element.setAttribute('title', fullParamName);
});
</script></section><section><h2 class="section-heading" id="results-and-evaluation">Results and Evaluation<a class="anchor" aria-label="anchor" href="#results-and-evaluation"></a>
</h2>
<hr class="half-width">
<p>We use our trained decision tree to <strong>predict the species of
the penguins in our test set</strong>, which represents data the model
has never seen before. This helps us evaluate how well the model
generalizes to new examples.</p>
<p>To see how accurately it performs across each species, we display the
results as a <strong>confusion matrix</strong>. This highlights where
the model makes correct predictions and where it confuses one species
for another.</p>
<p>Finally, we visualize the decision tree itself. This reveals the
exact sequence of decisions the model makes, which features it finds
most important, and the specific thresholds it uses to classify penguins
into different species.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># Predict the species of the test set (unseen data) using the model we have created </span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>y_pred <span class="op">=</span> clf.predict(X_test)</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co"># Display results as a confusion matrix</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(y_test, y_pred, labels<span class="op">=</span>clf.classes_)</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>cm_display <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm, display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>cm_display.plot(cmap<span class="op">=</span><span class="st">"Blues"</span>, colorbar<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay object at 0x000001B63C9D98D0&gt;</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># Visualise the decision tree</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">7</span>))</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>plot_tree(clf, feature_names<span class="op">=</span>X.columns, class_names<span class="op">=</span>clf.classes_, filled<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>plt.title(<span class="st">'Confusion Matrix'</span>)</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>plt.show()</span></code></pre>
</div>
<p><img src="../fig/00-worked-example-rendered-unnamed-chunk-12-3.png" width="1344" style="display: block; margin: auto;" class="figure"><img src="../fig/00-worked-example-rendered-unnamed-chunk-12-4.png" width="672" style="display: block; margin: auto;" class="figure"></p>
</section><section><h2 class="section-heading" id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<hr class="half-width">
<p>In this worked example, we followed a machine learning workflow from
start to finish. We built a decision tree classifier to predict penguin
species based on physical measurements. This not only gave us a baseline
for predictive accuracy, but also provided clear insight into which
features the model found most important for distinguishing between
species.</p>
<p>As we discussed this approach was overly simple but as we progress
through the week, we’ll dive deeper into each of these stages, explore
more sophisticated methods.</p>
<p><br></p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>A typical machine learning project follows a structured pipeline:
data exploration, cleaning, preprocessing, model selection, training,
and evaluation.</li>
<li>Even simple models like decision trees can provide valuable insights
into which features drive predictions, making them excellent for
building intuition and explainability.</li>
<li>Don’t worry if you didn’t follow every detail. Remember, this was
about gaining a high-level overview of the entire process, so that when
we dive into each section in detail later, you’ll have the context to
understand how it all fits together.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-01-problem-definition"><p>Content from <a href="01-problem-definition.html">Problem Definition</a></p>
<hr>
<p>Last updated on 2025-07-05 |

        <a href="https://github.com/RSEjas140/AAISS25_html/edit/main/episodes/01-problem-definition.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 120 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I determine what type of problem my data is suited for?</li>
<li>How do I know what is an appropriate question for a machine learning
model to answer?</li>
<li>How can I clearly define a machine learning problem?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Articulate a clear and measurable AI/ML problem definition</li>
<li>Identify whether a task is supervised or unsupervised</li>
<li>Distinguish between classification and regression tasks</li>
<li>Distinguish between clustering and dimensionality reduction
tasks</li>
<li>Use appropriate machine learning terms when framing a problem</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>In the previous session, we explored (and ideally ran) a working
example of a machine learning (ML) project. This provided a sense of
what ML can do and the typical stages involved in building, training and
evaluating a ML model.</p>
<p>Now, we take a step back and ask: <strong>how do we get to that
point?</strong></p>
<p>Before we can build a solution, we need to define the problem. That
means deciding what we want ML to achieve. Ideally, we want to
<strong>harness tasks that computers are exceptionally good at</strong>,
such as spotting patterns in massive datasets, performing millions of
calculations quickly, or consistently applying the same rules without
fatigue.</p>
<p>However, computers (and ML) are <strong>not good at
everything</strong>. They struggle with tasks requiring common sense,
deep contextual understanding, or handling messy, ambiguous problems
without clear definitions.</p>
<p>Just because computers can do things human can’t doesn’t mean they
can do things human’s find simple; this distinction is not always
obvious if you’re just starting out.</p>
<p><br></p>
<p><img src="https://imgs.xkcd.com/comics/tasks.png" alt="Tasks" class="figure"><br><em>“Tasks” by Randall Munroe, <a href="https://xkcd.com/1425" class="external-link">xkcd.com/1425</a>, used under <a href="https://creativecommons.org/licenses/by-nc/2.5/" class="external-link">CC BY-NC
2.5</a>.</em></p>
<p>For example:</p>
<ul>
<li><p>You could ask your phone to <strong>detect duplicate photos in
your gallery</strong>, even if they’re slightly resized or compressed —
a task that could take a person days to do accurately by eye
(<strong>computers are great at precise, large-scale comparisons, humans
not so much</strong>).</p></li>
<li><p>But to asking your phone to <strong>pick out the photo that best
captures the mood of a family gathering</strong>, becomes almost
impossible for a computer as without complex definition and training it
has no natural sense of emotional relevance in photos (<strong>intuitive
for humans, baffling for machines</strong>).</p></li>
</ul>
<p>So part of defining your ML problem is figuring out <strong>whether
it plays to these computational strengths</strong>, or whether it risks
tackling something machines are fundamentally ill-suited to handle.</p>
<p>A good starting point is accurately defining the problem. We can
begin by asking…</p>
</section><section><h2 class="section-heading" id="how-can-we-articulate-the-problem">How Can We Articulate the Problem?<a class="anchor" aria-label="anchor" href="#how-can-we-articulate-the-problem"></a>
</h2>
<hr class="half-width">
<p>A well-structured ML problem should be:</p>
<ul>
<li>
<strong>Clear</strong>: The question should use precise, unambiguous
language that explicitly defines the objective.</li>
<li>
<strong>Measurable</strong>: The problem must involve inputs and
outputs that are well-defined, observable, and quantifiable.</li>
<li>
<strong>Feasible</strong>: The required data should exist (or be
collectible), be accessible, and be sufficient in both quality and
quantity.</li>
<li>
<strong>Appropriate</strong>: The question should align with the
kinds of problems ML can solve, typically involving prediction,
classification, or pattern recognition.</li>
<li>
<strong>Ethically Responsible</strong>: The question should avoid
discriminatory inputs and must not reinforce bias or result in
harm.</li>
</ul>
<blockquote>
<p>This is not an exhaustive checklist. Other factors, such as the
scope, reproducibility, or specific project priorities, may also be
important. If you’re unsure, don’t hesitate to ask for guidance.</p>
</blockquote>
<p>We can consider some examples to better understand why these factors
are important.</p>
<p><br></p>
<div class="section level3">
<h3 id="is-the-question-clear">Is the question clear?<a class="anchor" aria-label="anchor" href="#is-the-question-clear"></a>
</h3>
<p><strong>Example Question:</strong></p>
</div>
<div class="section level3">
<h3 id="can-we-use-ai-to-look-at-diseases-in-crops">
<strong>“Can we use AI to look at diseases in crops?”</strong><a class="anchor" aria-label="anchor" href="#can-we-use-ai-to-look-at-diseases-in-crops"></a>
</h3>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> ❓ What might we want to change? </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<ul>
<li>The task is vague – “look at” doesn’t describe a specific ML
task.<br>
</li>
<li>“Diseases in crops” is broad – which disease? which crops?<br>
</li>
<li>It’s difficult to interpret and action meaningfully.</li>
<li>This isn’t a bad ‘starting place’ just a bad ‘finishing place’</li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler2" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler2" aria-expanded="false" aria-controls="collapseSpoiler2">
  <h3 class="accordion-header" id="headingSpoiler2">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> ✅ What could we add? </h3>
</button>
<div id="collapseSpoiler2" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler2" aria-labelledby="headingSpoiler2">
<div class="accordion-body">
<p>-<strong>“Can we predict the presence of <em>leaf rust</em> in
<em>wheat crops</em> using <em>drone image data</em>?”</strong></p>
<p><strong>Why it’s better:</strong><br>
- Specifies the task: <em>predict the presence</em> of a disease.<br>
- Identifies a specific disease (<em>leaf rust</em>) and crop
(<em>wheat</em>).<br>
- Defines the data source (<em>drone image data</em>).<br>
- These elements narrow the focus, resulting in a much clearer
objective.</p>
</div>
</div>
</div>
</div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="are-the-features-measurable">Are the features measurable?<a class="anchor" aria-label="anchor" href="#are-the-features-measurable"></a>
</h3>
<p><strong>Example Question:</strong></p>
</div>
<div class="section level3">
<h3 id="can-we-predict-how-bad-a-patients-tumour-is">
<strong>“Can we predict how bad a patient’s tumour
is?”</strong><a class="anchor" aria-label="anchor" href="#can-we-predict-how-bad-a-patients-tumour-is"></a>
</h3>
<div id="accordionSpoiler3" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler3" aria-expanded="false" aria-controls="collapseSpoiler3">
  <h3 class="accordion-header" id="headingSpoiler3">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> ❓ What might we change? </h3>
</button>
<div id="collapseSpoiler3" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler3" aria-labelledby="headingSpoiler3">
<div class="accordion-body">
<ul>
<li>“bad” does not have a precisely defined range<br>
</li>
<li>If the output lacks consistent, measurable categories then it is
unsuitable for model training</li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler4" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler4" aria-expanded="false" aria-controls="collapseSpoiler4">
  <h3 class="accordion-header" id="headingSpoiler4">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> ✅ What could we add? </h3>
</button>
<div id="collapseSpoiler4" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler4" aria-labelledby="headingSpoiler4">
<div class="accordion-body">
<ul>
<li><strong>“Can we classify tumour types from MRI scans (benign vs
malignant)?”</strong></li>
</ul>
<p><strong>Why it’s better:</strong><br>
- Defines a binary, clearly labelled classification task.<br>
- Uses structured input data (MRI scans).<br>
- Aligns with typical medical data used in supervised learning.</p>
</div>
</div>
</div>
</div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="is-the-data-needed-feasible">Is the data needed feasible?<a class="anchor" aria-label="anchor" href="#is-the-data-needed-feasible"></a>
</h3>
<p><strong>Example Question :</strong></p>
</div>
<div class="section level3">
<h3 id="can-we-predict-oak-tree-health-from-the-trees-number-of-green-vs-non-green-leaves">
<strong>“Can we predict oak tree health from the tree’s number of
green vs non-green leaves?”</strong><a class="anchor" aria-label="anchor" href="#can-we-predict-oak-tree-health-from-the-trees-number-of-green-vs-non-green-leaves"></a>
</h3>
<div id="accordionSpoiler5" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler5" aria-expanded="false" aria-controls="collapseSpoiler5">
  <h3 class="accordion-header" id="headingSpoiler5">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> ❓ What might we change? </h3>
</button>
<div id="collapseSpoiler5" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler5" aria-labelledby="headingSpoiler5">
<div class="accordion-body">
<ul>
<li>Leaf colour counts are difficult to collect consistently at
scale.</li>
<li>What about leaves that are half green? or yellowy-green?</li>
<li>Assumes the existence of data that may be unreliable, unavailable or
volatile.<br>
</li>
<li>No indication of how the data would be collected or validated.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler6" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler6" aria-expanded="false" aria-controls="collapseSpoiler6">
  <h3 class="accordion-header" id="headingSpoiler6">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> ✅ What could we add? </h3>
</button>
<div id="collapseSpoiler6" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler6" aria-labelledby="headingSpoiler6">
<div class="accordion-body">
<ul>
<li><strong>“Can we predict oak tree health from labelled phenotypic
data collected by forestry personnel?”</strong></li>
</ul>
<p><strong>Why it’s better:</strong><br>
- Relies on structured, expert-collected phenotypic data<br>
- Improves feasibility through realistic data access<br>
- More likely to meet the quality and quantity needs of ML</p>
</div>
</div>
</div>
</div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="is-the-question-appropriate-for-ml-models">Is the question appropriate for ML models?<a class="anchor" aria-label="anchor" href="#is-the-question-appropriate-for-ml-models"></a>
</h3>
<p><strong>Example Question :</strong></p>
</div>
<div class="section level3">
<h3 id="can-ai-determine-which-music-is-the-best">
<strong>“Can AI determine which music is the best?”</strong><a class="anchor" aria-label="anchor" href="#can-ai-determine-which-music-is-the-best"></a>
</h3>
<div id="accordionSpoiler7" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler7" aria-expanded="false" aria-controls="collapseSpoiler7">
  <h3 class="accordion-header" id="headingSpoiler7">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> ❓ What might we change? </h3>
</button>
<div id="collapseSpoiler7" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler7" aria-labelledby="headingSpoiler7">
<div class="accordion-body">
<ul>
<li>“Best” is subjective and lacks a ground truth label<br>
</li>
<li>The question is not suitable for objective modelling with ML</li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler8" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler8" aria-expanded="false" aria-controls="collapseSpoiler8">
  <h3 class="accordion-header" id="headingSpoiler8">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> ✅ What could we add? </h3>
</button>
<div id="collapseSpoiler8" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler8" aria-labelledby="headingSpoiler8">
<div class="accordion-body">
<ul>
<li><strong>“Can our model recommend new music based on a user’s
preferences using track features such as tempo and key?”</strong></li>
</ul>
<p><strong>Why it’s better:</strong><br>
- Uses measurable inputs (e.g., tempo, key) and labelled
preferences<br>
- Frames the task as a recommendation problem, which aligns well with
ML<br>
- Avoids subjectivity by focusing on data-driven feedback</p>
</div>
</div>
</div>
</div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="are-there-ethical-implications-to-consider">Are there ethical implications to consider?<a class="anchor" aria-label="anchor" href="#are-there-ethical-implications-to-consider"></a>
</h3>
<p><strong>Example Question :</strong></p>
</div>
<div class="section level3">
<h3 id="can-we-stream-children-into-sets-based-on-their-predicted-academic-ability-using-their-postcode">
<strong>“Can we stream children into sets based on their predicted
academic ability using their postcode?”</strong><a class="anchor" aria-label="anchor" href="#can-we-stream-children-into-sets-based-on-their-predicted-academic-ability-using-their-postcode"></a>
</h3>
<div id="accordionSpoiler9" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler9" aria-expanded="false" aria-controls="collapseSpoiler9">
  <h3 class="accordion-header" id="headingSpoiler9">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> ❓ What might we change? </h3>
</button>
<div id="collapseSpoiler9" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler9" aria-labelledby="headingSpoiler9">
<div class="accordion-body">
<ul>
<li>While technically feasible, this raises serious ethical
concerns<br>
</li>
<li>Postcode is a proxy for socioeconomic status and may encode
structural bias<br>
</li>
<li>Using it could reinforce inequality or lead to discriminatory
decisions</li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler10" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler10" aria-expanded="false" aria-controls="collapseSpoiler10">
  <h3 class="accordion-header" id="headingSpoiler10">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> ✅ What could we add? </h3>
</button>
<div id="collapseSpoiler10" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler10" aria-labelledby="headingSpoiler10">
<div class="accordion-body">
<ul>
<li><strong>“Can we identify regions where additional educational
resources are most needed?”</strong></li>
</ul>
<p><strong>Why it’s better:</strong><br>
- Shifts focus from labelling an individual to supporting a
community<br>
- Frames the task in a socially constructive way<br>
- Avoids using sensitive features that could propagate bias</p>
</div>
</div>
</div>
</div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="be-mindfull">Be mindfull<a class="anchor" aria-label="anchor" href="#be-mindfull"></a>
</h3>
<p>These are the kinds of considerations you need to make when defining
your problem. One important thing to keep in mind…</p>
<div id="just-because-you-can-doesnt-mean-you-should" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="just-because-you-can-doesnt-mean-you-should" class="callout-inner">
<h3 class="callout-title">⚠️ “Just because you can, doesn’t mean you should”</h3>
<div class="callout-content">
<p>One of the most important, and often overlooked, questions in ML
is:<br><strong>Who or what is this model helping?</strong></p>
<p>Technical feasibility is only one part of the equation. Responsible
AI begins with responsible questions. AI is a tool, how we use it is up
to us.</p>
</div>
</div>
</div>
<p><br></p>
<div id="breakout-task-reflect-on-your-problem-definition" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="breakout-task-reflect-on-your-problem-definition" class="callout-inner">
<h3 class="callout-title">📝 Breakout Task: Reflect on Your Problem Definition</h3>
<div class="callout-content">
<ul>
<li>Discuss with those around you:
<ul>
<li>What does your problem definition look like at this point?<br>
</li>
<li>Have you adjusted or refined it since starting this session?<br>
</li>
<li>Is there anything new you might need to consider (e.g., clearer
objectives, feasibility, ethical implications etc.)?</li>
</ul>
</li>
</ul>
<p>Be prepared to share one insight or question with the group.</p>
</div>
</div>
</div>
<p><br></p>
<hr>
<p><br></p>
</div>
</section><section><h2 class="section-heading" id="considering-data-format">Considering Data Format<a class="anchor" aria-label="anchor" href="#considering-data-format"></a>
</h2>
<hr class="half-width">
<p>We are moving on to understanding your data and the first thing to
consider is <strong>how your data is stored and structured</strong>?
Understanding your data’s format early helps avoid surprises (like
trying to feed raw text into a model that expects numerical arrays).</p>
<p>The <strong>format of your data</strong> has a big impact on:</p>
<ul>
<li>How you load it into your analysis environment</li>
<li>What kind of preprocessing you’ll need</li>
<li>Which libraries or ML tools are appropriate</li>
<li>How computationally demanding your pipeline might be</li>
</ul>
<p><br></p>
<div class="section level3">
<h3 id="common-data-formats">📚 Common data formats<a class="anchor" aria-label="anchor" href="#common-data-formats"></a>
</h3>
<table class="table">
<colgroup>
<col width="17%">
<col width="28%">
<col width="53%">
</colgroup>
<thead><tr>
<th><strong>Data Format</strong></th>
<th><strong>Examples</strong></th>
<th><strong>Typical considerations</strong></th>
</tr></thead>
<tbody>
<tr>
<td><strong>Tabular</strong></td>
<td>CSV, Excel</td>
<td>Check column consistency, delimiters, missing data</td>
</tr>
<tr>
<td><strong>Free text</strong></td>
<td>Surveys, articles, tweets</td>
<td>Requires cleaning: tokenisation, stopwords removal</td>
</tr>
<tr>
<td><strong>Images</strong></td>
<td>JPEG, PNG, TIFF</td>
<td>Resize, normalise, convert to arrays</td>
</tr>
</tbody>
</table>
<p><br></p>
<div id="breakout-task-quick-questions-to-understand-your-data-format" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="breakout-task-quick-questions-to-understand-your-data-format" class="callout-inner">
<h3 class="callout-title">📝 Breakout Task: Quick questions to understand your data format</h3>
<div class="callout-content">
<ul>
<li>Is your data tabular, text, images, or something else?</li>
<li>How will you load it?</li>
<li>Does it require special libraries or custom parsing?</li>
<li>What does one data point look like?</li>
<li>Does it need modifying before analysis?</li>
</ul>
</div>
</div>
</div>
<p><br></p>
</div>
</section><section><h2 class="section-heading" id="the-data-in-context">The Data in Context<a class="anchor" aria-label="anchor" href="#the-data-in-context"></a>
</h2>
<hr class="half-width">
<p>Now that we have begun to understand what makes a good machine
learning question, we must ensure that our <strong>data aligns with that
question</strong>. A model’s performance often suffers not due to
algorithm choice, but because of a mismatch between the question being
asked and the data being used to answer it.</p>
<p><img src="https://dataedo-website.s3.amazonaws.com/cartoon/null_product.png?1664927074" alt="Cartoon illustrating poor data understanding" class="figure"><br><em>“Best Selling Product” by Piotr Kononow, <a href="https://dataedo.com/cartoon/best-selling-product" class="external-link">dataedo.com/cartoon/best-selling-product</a>,
used under <a href="https://creativecommons.org/licenses/by-nc/2.5/" class="external-link">CC
BY-NC 2.5</a>.</em></p>
<p><br></p>
<div id="understand-your-data-or-misunderstand-your-results" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="understand-your-data-or-misunderstand-your-results" class="callout-inner">
<h3 class="callout-title">💡 “Understand Your Data, or Misunderstand Your Results”</h3>
<div class="callout-content">
<ul>
<li><strong>The better we understand our dataset, the more confidently
we can select and apply the appropriate ML approach.</strong></li>
</ul>
<p>This includes knowing <strong>where</strong> the data came from,
<strong>why</strong> it was collected, <strong>how</strong> it was
gathered, and <strong>what</strong> its limitations are.</p>
<p><strong>Not all datasets are created equal</strong>. The origins and
context of your data strongly influence what kinds of approaches you can
take.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="but-wait-there-is-nothing-i-can-change-about-my-data-now">“But wait… there is nothing I can change about my data now?”<a class="anchor" aria-label="anchor" href="#but-wait-there-is-nothing-i-can-change-about-my-data-now"></a>
</h3>
<p><br></p>
<div id="overlook-the-context-inherit-the-consequences" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="overlook-the-context-inherit-the-consequences" class="callout-inner">
<h3 class="callout-title">⚠️ “Overlook the Context, Inherit the Consequences”</h3>
<div class="callout-content">
<p>In many real-world scenarios we begin with data that has already been
collected, often for a different purpose than the one we now intend to
explore.</p>
<p>Ideally, we might design a data collection process tailored to our
machine learning goals. But in practice, we are often working
retrospectively, trying to understand what can be discovered from the
data we already have, without the option to amend, expand, or recollect
it.</p>
<p>If you are generating synthetic data or designing a future collection
process, you’ll have more control. But for the purpose of this session,
we assume:</p>
<blockquote>
<p><strong>It’s true that the data is fixed.</strong><br>
It has already been collected, and we cannot influence how, why, or from
whom it was gathered. However, this context has significant implications
for the entire machine learning process, as it shapes what can be
modelled, how results should be interpreted, and where caution must be
applied.</p>
</blockquote>
</div>
</div>
</div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="key-questions-to-ask-about-your-data">Key Questions to Ask About Your Data<a class="anchor" aria-label="anchor" href="#key-questions-to-ask-about-your-data"></a>
</h3>
<p>These questions build directly on our earlier criteria for good
problem formulation. They help you assess how the <strong>origin and
structure of your data</strong> may shape what you can realistically
model.</p>
<div id="accordionSpoiler11" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler11" aria-expanded="false" aria-controls="collapseSpoiler11">
  <h3 class="accordion-header" id="headingSpoiler11">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> 1. Who collected the data? </h3>
</button>
<div id="collapseSpoiler11" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler11" aria-labelledby="headingSpoiler11">
<div class="accordion-body">
<ul>
<li>Was it you, your team, or a third party?</li>
<li>If external: Is the source reputable (e.g., academic, government,
commercial)?</li>
<li>Is the collector contactable?</li>
</ul>
<blockquote>
<p>The more we know about who collected the data, the more we can judge
how trustworthy and appropriate it is for our task.</p>
</blockquote>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler12" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler12" aria-expanded="false" aria-controls="collapseSpoiler12">
  <h3 class="accordion-header" id="headingSpoiler12">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> 2. How was the data collected? </h3>
</button>
<div id="collapseSpoiler12" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler12" aria-labelledby="headingSpoiler12">
<div class="accordion-body">
<ul>
<li>Was it gathered via surveys, sensors, web scraping, manual input, or
experiments?</li>
<li>Was the process automated or did it rely on subjective human
judgment?</li>
<li>Are there known issues such as selection bias or noise?</li>
</ul>
<blockquote>
<p>The collection method shapes the reliability, completeness, and
consistency of your dataset.</p>
</blockquote>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler13" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler13" aria-expanded="false" aria-controls="collapseSpoiler13">
  <h3 class="accordion-header" id="headingSpoiler13">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> 3. Why was the data collected? </h3>
</button>
<div id="collapseSpoiler13" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler13" aria-labelledby="headingSpoiler13">
<div class="accordion-body">
<ul>
<li>Was it collected for scientific research, business operations, legal
compliance, or another reason?</li>
<li>Was it designed to answer the question you’re asking, or are you
repurposing it?</li>
</ul>
<blockquote>
<p>The original purpose influences how well the data matches your
intended ML task.</p>
</blockquote>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler14" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler14" aria-expanded="false" aria-controls="collapseSpoiler14">
  <h3 class="accordion-header" id="headingSpoiler14">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> 4. When and where was it collected? </h3>
</button>
<div id="collapseSpoiler14" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler14" aria-labelledby="headingSpoiler14">
<div class="accordion-body">
<ul>
<li>Is the data recent and representative of current conditions?</li>
<li>Could location or time-specific events affect its
generalisability?</li>
</ul>
<blockquote>
<p>For example, a model trained on pre-COVID mobility data may not
reflect current behaviours.</p>
</blockquote>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler15" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler15" aria-expanded="false" aria-controls="collapseSpoiler15">
  <h3 class="accordion-header" id="headingSpoiler15">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> 5. Is the data documented? </h3>
</button>
<div id="collapseSpoiler15" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler15" aria-labelledby="headingSpoiler15">
<div class="accordion-body">
<ul>
<li>Is there meta data explaining the columns and values?</li>
<li>Are the units, formats, and variable names clearly defined?</li>
<li>Is the treatment of missing values transparent?</li>
</ul>
<blockquote>
<p>Good documentation reduces the risk of misinterpretation and helps
support your pre-processing steps.</p>
</blockquote>
</div>
</div>
</div>
</div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="examples-of-how-data-context-shapes-ml-pipeline-decisions">Examples of how Data Context Shapes ML Pipeline Decisions<a class="anchor" aria-label="anchor" href="#examples-of-how-data-context-shapes-ml-pipeline-decisions"></a>
</h3>
<p>Scenario 1: You have been given a large dataset on customers eating
habits collected as part of a health food company’s loyalty card
programme.</p>
<div id="accordionSpoiler16" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler16" aria-expanded="false" aria-controls="collapseSpoiler16">
  <h3 class="accordion-header" id="headingSpoiler16">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> ⚠️ Risks </h3>
</button>
<div id="collapseSpoiler16" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler16" aria-labelledby="headingSpoiler16">
<div class="accordion-body">
<ul>
<li>The data mainly represents customers already interested in buying
healthy products.</li>
<li>It may not generalise to the broader population’s eating
habits.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler17" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler17" aria-expanded="false" aria-controls="collapseSpoiler17">
  <h3 class="accordion-header" id="headingSpoiler17">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> ✅ How to work with it </h3>
</button>
<div id="collapseSpoiler17" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler17" aria-labelledby="headingSpoiler17">
<div class="accordion-body">
<ul>
<li>Restrict your analysis to questions about <em>this customer
group</em>.</li>
<li>Clearly note the demographic limitation in any reports.</li>
<li>If recorded in the data you could inspect the demographic to better
understand the participant makeup.</li>
</ul>
</div>
</div>
</div>
</div>
<p><br></p>
<p>Scenario 2: You’re given a series of air quality readings from
low-cost sensors mounted onto city buses.</p>
<div id="accordionSpoiler18" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler18" aria-expanded="false" aria-controls="collapseSpoiler18">
  <h3 class="accordion-header" id="headingSpoiler18">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> ⚠️ Risks </h3>
</button>
<div id="collapseSpoiler18" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler18" aria-labelledby="headingSpoiler18">
<div class="accordion-body">
<ul>
<li>The data is biased towards higher pollution hotspots, missing
residential areas or parks.</li>
<li>Could misrepresent overall city air quality.</li>
<li>How reliable are the sensors?</li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler19" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler19" aria-expanded="false" aria-controls="collapseSpoiler19">
  <h3 class="accordion-header" id="headingSpoiler19">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> ✅ How to work with it </h3>
</button>
<div id="collapseSpoiler19" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler19" aria-labelledby="headingSpoiler19">
<div class="accordion-body">
<ul>
<li>Frame your project around <em>high-traffic pollution
monitoring</em>, not general air quality.</li>
<li>Use this data to identify peak exposure zones for traffic planners,
rather than claiming citywide averages.</li>
<li>Could be combined with bus routes to understand the data
better.</li>
<li>Can you find documentation reporting the error range of the
sensors?</li>
</ul>
</div>
</div>
</div>
</div>
<p><br></p>
<p>Scenario 3: You’re analysing water consumption data from a chain of
hotels, you discover the data was all collected between May and
September.</p>
<div id="accordionSpoiler20" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler20" aria-expanded="false" aria-controls="collapseSpoiler20">
  <h3 class="accordion-header" id="headingSpoiler20">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> ⚠️ Risks </h3>
</button>
<div id="collapseSpoiler20" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler20" aria-labelledby="headingSpoiler20">
<div class="accordion-body">
<ul>
<li>It may reflect heavy tourist usage, not typical yearly demand.</li>
<li>Are the hotels in hot climates? Are they refilling their pools?</li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler21" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler21" aria-expanded="false" aria-controls="collapseSpoiler21">
  <h3 class="accordion-header" id="headingSpoiler21">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> ✅ How to work with it </h3>
</button>
<div id="collapseSpoiler21" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler21" aria-labelledby="headingSpoiler21">
<div class="accordion-body">
<ul>
<li>Use the data to study peak scenarios.</li>
<li>Avoid generalising to average annual water needs unless you can
adjust using known seasonal factors.</li>
</ul>
</div>
</div>
</div>
</div>
<p><br></p>
<p>Scenario 4: You receive a weather dataset and the columns named
<code>Rate</code>, ‘rate2’, <code>Wind</code>, <code>Temp</code>… with
no clear documentation, you believe you can deduce their meaning from
the context of the dataset.</p>
<div id="accordionSpoiler22" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler22" aria-expanded="false" aria-controls="collapseSpoiler22">
  <h3 class="accordion-header" id="headingSpoiler22">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> ⚠️ Risks </h3>
</button>
<div id="collapseSpoiler22" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler22" aria-labelledby="headingSpoiler22">
<div class="accordion-body">
<ul>
<li>You might misinterpret what these columns mean — e.g. thinking
<code>rate</code> is a rate of increase when it is a rate of
decrease.</li>
<li>Data could be redundant (duplication) which is difficult to confirm
if you don’t understand the columns.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSpoiler23" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler23" aria-expanded="false" aria-controls="collapseSpoiler23">
  <h3 class="accordion-header" id="headingSpoiler23">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> ✅ How to work with it </h3>
</button>
<div id="collapseSpoiler23" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler23" aria-labelledby="headingSpoiler23">
<div class="accordion-body">
<ul>
<li>Conduct exploratory analysis to check plausible ranges (e.g. your
data is for a weather station in Aberystwyth and ‘temp’ rarely goes
above 20 and has never gone above 35, probably safe to assum it is in
Celsius).</li>
<li>Cross-reference any example records or outputs you can find.</li>
<li>Document all working assumptions</li>
<li>Speak to the collectors (if possible)</li>
</ul>
</div>
</div>
</div>
</div>
<p><br></p>
<div id="breakout-task-consider-your-datas-context" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="breakout-task-consider-your-datas-context" class="callout-inner">
<h3 class="callout-title">📝 Breakout Task: Consider your data’s context</h3>
<div class="callout-content">
<ul>
<li>With the people around you, discuss:
<ul>
<li>Who collected your data, and why?</li>
<li>How was it collected — and could that process introduce bias or
gaps?</li>
<li>When and where was it gathered — does that affect how generalisable
it is?</li>
<li>Is the documentation clear, or do you have questions about what
columns mean?</li>
<li>If none of these risks are relevant, why not? and are there any
risks that are?</li>
</ul>
</li>
</ul>
<p>Try to identify at least <strong>one risk or limitation</strong> in
your data’s context that might influence your machine learning pipeline
(e.g., needing extra cleaning, restricting your conclusions, or choosing
fairness-aware metrics).</p>
<p>Be ready to share your observations.</p>
</div>
</div>
</div>
<hr>
</div>
</section><section><h2 class="section-heading" id="framing-your-problem">Framing your Problem<a class="anchor" aria-label="anchor" href="#framing-your-problem"></a>
</h2>
<hr class="half-width">
<p>Next it is a good idea to <strong>frame our question</strong>. This
means working out exactly <strong>what kind of machine learning problem
we’re trying to solve</strong> so we can communicate it clearly, both to
ourselves and to others who understand ML.</p>
<p><br></p>
<div class="section level3">
<h3 id="terminology-time">🕒 Terminology Time<a class="anchor" aria-label="anchor" href="#terminology-time"></a>
</h3>
<p>Let’s start with two important terms in machine learning:</p>
<div class="section level4">
<h4 id="features">
<strong>Features</strong><a class="anchor" aria-label="anchor" href="#features"></a>
</h4>
<p>Features are the individual pieces of information that you use to
help make predictions. They are the <strong>inputs</strong> to your
model.</p>
<p><strong>Examples:</strong></p>
<ul>
<li>The length and width of flower petals<br>
</li>
<li>A person’s age, height, and cholesterol level<br>
</li>
<li>A pixel value</li>
</ul>
</div>
<div class="section level4">
<h4 id="labels">
<strong>Labels</strong><a class="anchor" aria-label="anchor" href="#labels"></a>
</h4>
<p>Labels are the <strong>answers you’re trying to predict or
explain</strong>.</p>
<p><strong>Examples:</strong></p>
<ul>
<li>The type of flower (iris setosa, iris virginica, etc.)<br>
</li>
<li>Whether a patient has a disease</li>
<li>Is this image a cat?</li>
</ul>
</div>
<div class="section level4">
<h4 id="also-known-as">📚 Also known as…<a class="anchor" aria-label="anchor" href="#also-known-as"></a>
</h4>
<table class="table">
<colgroup>
<col width="43%">
<col width="56%">
</colgroup>
<thead><tr>
<th><strong>ML Term</strong></th>
<th><strong>Also Called</strong></th>
</tr></thead>
<tbody>
<tr>
<td>Feature</td>
<td>Input, variable, independent variable, attribute, predictor,
<strong>X</strong>
</td>
</tr>
<tr>
<td>Label</td>
<td>Target, outcome, response, dependent variable, ground truth, class,
<strong>y</strong>
</td>
</tr>
</tbody>
</table>
<p><br></p>
</div>
</div>
<div class="section level3">
<h3 id="but-wait-what-if-i-dont-have-labels-in-my-dataset">But wait… what if I don’t have labels in my dataset?<a class="anchor" aria-label="anchor" href="#but-wait-what-if-i-dont-have-labels-in-my-dataset"></a>
</h3>
<p>That’s fine, this is a critical question that will start to shape
your entire project.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="supervised-and-unsupervised-learning-">Supervised and Unsupervised Learning.<a class="anchor" aria-label="anchor" href="#supervised-and-unsupervised-learning-"></a>
</h3>
<p>Before we choose an algorithm, we need to answer:</p>
<p><br></p>
<div id="are-we-dealing-with-supervised-or-unsupervised-learning" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="are-we-dealing-with-supervised-or-unsupervised-learning" class="callout-inner">
<h3 class="callout-title">“Are we dealing with supervised or unsupervised learning?”</h3>
<div class="callout-content">
<p><img src="../fig/begflow.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
</div>
</div>
</div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="supervised-learning">
<strong>Supervised Learning</strong><a class="anchor" aria-label="anchor" href="#supervised-learning"></a>
</h3>
<p><br></p>
<p>You already <strong>have the answers</strong> (the labels). The goal
is to teach the model to predict the correct label given new data.</p>
<p><strong>Example:</strong> - A botanist has recorded the length and
width of flower petals and also classified each flower’s species.<br>
- Your question: <em>Can we predict the species of flower based on petal
length and width?</em></p>
<p>Supervised learning is used when:</p>
<ul>
<li>You have data that includes both <strong>inputs (features)</strong>
and <strong>known outputs (labels)</strong>.</li>
<li>You want to see how well you can predict a known outcome from the
inputs.</li>
</ul>
<p><br></p>
</div>
<div class="section level3">
<h3 id="unsupervised-learning">
<strong>Unsupervised Learning</strong><a class="anchor" aria-label="anchor" href="#unsupervised-learning"></a>
</h3>
<p><br></p>
<p>You <strong>do not have labels</strong>. The goal here is to explore
your data and uncover hidden patterns or groupings.</p>
<p><strong>Example:</strong> - You measured the length and width of many
flower petals from a region, but don’t know their species.<br>
- Your question: <em>Can we find natural groupings (clusters) in the
data that might correspond to different flower species?</em></p>
<p>Unsupervised learning is used when:</p>
<ul>
<li>You only have <strong>input data (features)</strong> and want to
discover relationships, structures, or clusters that you didn’t know
about beforehand.</li>
</ul>
<p><br></p>
<hr>
<p><br></p>
</div>
<div class="section level3">
<h3 id="ok-im-interested-in-supervised-learning-now-what">Ok I’m Interested in Supervised Learning, Now What?<a class="anchor" aria-label="anchor" href="#ok-im-interested-in-supervised-learning-now-what"></a>
</h3>
<p><br></p>
</div>
<div class="section level3">
<h3 id="terminology-time-1">🕒 Terminology Time<a class="anchor" aria-label="anchor" href="#terminology-time-1"></a>
</h3>
<table class="table">
<colgroup>
<col width="17%">
<col width="52%">
<col width="30%">
</colgroup>
<thead><tr>
<th><strong>Label Type</strong></th>
<th><strong>Description</strong></th>
<th><strong>Example Values</strong></th>
</tr></thead>
<tbody>
<tr>
<td>Categorical</td>
<td>Data divided into distinct groups or categories</td>
<td>
<code>['Yes', 'No']</code> or
<code>['UK', 'France', 'Spain']</code>
</td>
</tr>
<tr>
<td>Continuous</td>
<td>Numeric data that can take on any value within a range (measurable
quantities)</td>
<td>
<code>3.5</code>, <code>98.6</code>, <code>12.0</code>,
<code>4.2</code>
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>If we are dealing with <strong>supervised learning</strong>, the next
question is:</p>
<p><br></p>
<div id="are-our-labels-describing-categories-or-quantities" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="are-our-labels-describing-categories-or-quantities" class="callout-inner">
<h3 class="callout-title">“Are our labels describing categories or quantities?”</h3>
<div class="callout-content">
<p><img src="../fig/supflow.png" alt="Diagram distinguishing classification and regression tasks" class="figure">.</p>
</div>
</div>
</div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="classification">
<strong>Classification</strong><a class="anchor" aria-label="anchor" href="#classification"></a>
</h3>
<p><br></p>
<p>You want to predict <strong>which category</strong> something belongs
to.</p>
<p><strong>Example:</strong> - Given features like flower petal length
and width, predict whether the flower is a <em>setosa</em>,
<em>versicolor</em>, or <em>virginica</em>.</p>
<p>Classification is used when:</p>
<ul>
<li>Your <strong>labels are categorical</strong> (belonging to distinct
groups or classes).</li>
<li>The task is to assign inputs to discrete categories.</li>
</ul>
<blockquote>
<p><strong>Note:</strong><br>
There are different sub-types of classification (e.g., binary vs
multiclass vs multilabel) to describe different kinds of
classification.</p>
</blockquote>
<p><br></p>
</div>
<div class="section level3">
<h3 id="regression">
<strong>Regression</strong><a class="anchor" aria-label="anchor" href="#regression"></a>
</h3>
<p><br></p>
<p>You want to predict a <strong>numeric value</strong>.</p>
<p><strong>Example:</strong> - Given petal length, predict the
<strong>petal width</strong>.</p>
<p>Regression is used when:</p>
<ul>
<li>Your <strong>labels are continuous numerical values</strong>.</li>
<li>The task is to predict quantities that can take on a range of
values.</li>
</ul>
<p><br></p>
<hr>
<p><br></p>
</div>
<div class="section level3">
<h3 id="ok-i-know-im-doing-unsupervised-learning-now-what">Ok I Know I’m Doing Unsupervised Learning, Now What?<a class="anchor" aria-label="anchor" href="#ok-i-know-im-doing-unsupervised-learning-now-what"></a>
</h3>
<p><br></p>
</div>
<div class="section level3">
<h3 id="terminology-time-2">🕒 Terminology Time<a class="anchor" aria-label="anchor" href="#terminology-time-2"></a>
</h3>
<table class="table">
<colgroup>
<col width="18%">
<col width="55%">
<col width="26%">
</colgroup>
<thead><tr>
<th><strong>Unsupervised Task</strong></th>
<th><strong>Description</strong></th>
<th><strong>Typical Goal</strong></th>
</tr></thead>
<tbody>
<tr>
<td>Clustering</td>
<td>Grouping data points based on similarity (no predefined labels)</td>
<td>Discover hidden groupings or patterns</td>
</tr>
<tr>
<td>Dimensional Reduction</td>
<td>Simplifying data by reducing the number of features</td>
<td>Visualisation or Understanding</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>If we are dealing with <strong>unsupervised learning</strong>, the
next question is:</p>
<p><br></p>
<div id="are-we-trying-to-group-similar-things-or-reduce-complexity" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="are-we-trying-to-group-similar-things-or-reduce-complexity" class="callout-inner">
<h3 class="callout-title">“Are we trying to group similar things, or reduce complexity?”</h3>
<div class="callout-content">
<p><img src="../fig/wholeflow.png" alt="Diagram showing difference between clustering and dimensionality reduction" class="figure">.</p>
</div>
</div>
</div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="clustering">
<strong>Clustering</strong><a class="anchor" aria-label="anchor" href="#clustering"></a>
</h3>
<p><br></p>
<p>You want to find <strong>groups or clusters</strong> in your
data.</p>
<p><strong>Example:</strong> - You analyse a series of petal lengths and
widths to determine if there are <strong>distinct groups</strong> within
the data.</p>
<p>Clustering is used when:</p>
<ul>
<li>You have <strong>unlabelled data</strong>.</li>
<li>You suspect some structure or grouping exists and want the algorithm
to <strong>discover it for you</strong>.</li>
</ul>
<p><br></p>
</div>
<div class="section level3">
<h3 id="dimensionality-reduction">
<strong>Dimensionality Reduction</strong><a class="anchor" aria-label="anchor" href="#dimensionality-reduction"></a>
</h3>
<p><br></p>
<p>You want to <strong>simplify your data</strong> by reducing the
number of features, while preserving important structures or
relationships.</p>
<p><strong>Example:</strong> - You have 100’s of features about petals
you believe they are not all important and you want to
<strong>reduce</strong> the overall number of features.</p>
<p>Dimensionality reduction is used when:</p>
<ul>
<li>Your dataset has <strong>many features</strong>, and you want to:
<ul>
<li>Visualise it more easily</li>
<li>Reduce noise or redundancy</li>
<li>Speed up future modelling</li>
</ul>
</li>
</ul>
<blockquote>
<p>You can think of it as <strong>compressing data to keep the most
important patterns</strong>.</p>
</blockquote>
<p><br></p>
</div>
</section><section><h2 class="section-heading" id="challenges">Challenges<a class="anchor" aria-label="anchor" href="#challenges"></a>
</h2>
<hr class="half-width">
<p><br></p>
<div id="problem-scenario-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="problem-scenario-1" class="callout-inner">
<h3 class="callout-title">🦞 Problem Scenario 1</h3>
<div class="callout-content">
<p>New UK fishing legislation has forced boats to release lobsters under
a certain weight. However, <strong>weighing lobsters on a boat is costly
and cumbersome</strong>, so the fishing industry is exploring more
efficient ways to gauge lobster weight.</p>
<p>A dataset from a group of marine biologists in Canada includes the
length and weight of thousands of lobsters caught along various parts of
the coastline. They want to know if this existing data could be used to
estimate the weight of a lobster from its length, as length is more
easily captured through pre-existing on-board imaging systems.</p>
<p><strong>What type of ML problem is this?</strong><br>
- Supervised or Unsupervised?<br>
- Classification, Regression, Clustering, or Dimensionality
Reduction?<br>
- What are the inputs and outputs?</p>
<p><strong>Also discuss:</strong> - What might a clear problem
definition look like? - What considerations do we need to give the
data?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ul>
<li>✅ <strong>Supervised Learning</strong><br>
</li>
<li>✅ <strong>Regression</strong> — because the task is to predict a
continuous numeric output (weight) from an input (length).<br>
</li>
<li>
<strong>Inputs (features):</strong> lobster length<br>
</li>
<li>
<strong>Output (label):</strong> lobster weight</li>
</ul>
<div class="section level3">
<h3 id="a-clear-problem-definition-could-be">A clear problem definition could be:<a class="anchor" aria-label="anchor" href="#a-clear-problem-definition-could-be"></a>
</h3>
<blockquote>
<p>“Can we predict the weight of a lobster based on its length
measurements using a regression model trained on historical
length-weight data from Canadian lobster populations?”</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="data-considerations">Data considerations:<a class="anchor" aria-label="anchor" href="#data-considerations"></a>
</h3>
<ul>
<li>The data comes from Canadian lobsters, so we should check if
<strong>growth patterns are similar for UK lobsters</strong>, or if a
local dataset is needed for best accuracy.</li>
<li>Ensure the data covers the <strong>full range of sizes relevant to
UK fishing regulations</strong>, or risk poor predictions at critical
cutoffs.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p><br></p>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>🚜 Problem Scenario 2 A group of agricultural researchers have
acquired hand written soil data records from several different farms.
These logs record moisture, pH, and nutrient levels every week. The
researchers hope to discover natural groupings of soil conditions across
the region to better target fertilizer treatments.</p>
<p>What type of ML problem is this?</p>
<p>Supervised or Unsupervised?</p>
<p>Classification, Regression, Clustering, or Dimensional Reduction?</p>
<p>What are the inputs and outputs?</p>
<p>Also discuss:</p>
<p>What might a clear problem definition look like?</p>
<p>What considerations do we need to give the data?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>✅ Unsupervised Learning</p>
<p>✅ Clustering — because the goal is to uncover natural groupings
(clusters) without pre-labelled outcomes.</p>
<p>Inputs (features): sensor measurements (moisture, pH, nutrient
levels)</p>
<p>No explicit outputs (labels) since the task is to find structure.</p>
<p>A clear problem definition could be: “Can we identify distinct
clusters of soil conditions based on moisture, pH, and nutrient levels
to guide targeted fertilizer application?”</p>
<p>Data considerations: Individual farmers may have different standards,
leading to inconsistencies or mismatches between data.</p>
<p>Instruments may differ between farms and this may also lead to
inconsistencies between data sets.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="section level3">
<h3 id="applying-it-to-your-problem">Applying it to your problem<a class="anchor" aria-label="anchor" href="#applying-it-to-your-problem"></a>
</h3>
<p><br></p>
<div id="discussion8" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Take some time to think about your own dataset and research question
(or a project you hope to start). Try to use what we’ve covered in this
session to explore:</p>
<p>What type of ML problem is this?</p>
<p>Supervised or Unsupervised?</p>
<p>Classification, Regression, Clustering, or Dimensionality
Reduction?</p>
<p>What are your inputs (features) and outputs (labels), if
applicable?</p>
<p>How would you write a clear problem definition?</p>
<p>Are there any data context considerations or ethical risks?</p>
<p>Use this exercise to create the first slide of your slide deck. You
will be using your slide to introduce yourself and your problem to the
group.</p>
</div>
</div>
</div>
<hr>
<p><br></p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Defining your problem clearly is a critical step in any ML project.
A poorly defined question can lead to poor or even meaningless
results.</li>
<li>Machine learning is best suited for tasks that play to computational
strengths (e.g., pattern recognition, scale, consistency).</li>
<li>A good ML problem is clear, measurable, feasible, appropriate for
ML, and ethically sound.</li>
<li>Developing an understanding of the shared vocabulary is essential
for clearly categorising and efficiently discussing your problem
type.</li>
<li>The context of your data is crucial for understanding the
limitations of your analysis and the conclusions you can reliably
draw.</li>
</ul>
</div>
</div>
</div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="final-note">Final note<a class="anchor" aria-label="anchor" href="#final-note"></a>
</h3>
<p><br></p>
<p><img src="https://imgs.xkcd.com/comics/here_to_help.png" alt="Here to Help" class="figure"><br><em>“Here to Help” by Randall Munroe, <a href="https://xkcd.com/1536" class="external-link">xkcd.com/1536</a>, used under <a href="https://creativecommons.org/licenses/by-nc/2.5/" class="external-link">CC BY-NC
2.5</a>.</em></p>
<p><br></p>
<blockquote>
<p>None of this is easy, so try not to get discouraged.<br>
Defining a good ML problem, and understanding your data’s limitations,
is challenging work.<br>
Remember, there is no silver bullet, and we’re here to help you navigate
it.</p>
</blockquote>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-02-data-exploration-and-preprocessing"><p>Content from <a href="02-data-exploration-and-preprocessing.html">Data exploration and Preprocessing</a></p>
<hr>
<p>Last updated on 2025-07-08 |

        <a href="https://github.com/RSEjas140/AAISS25_html/edit/main/episodes/02-data-exploration-and-preprocessing.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 120 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I read in data to Pandas?</li>
<li>How can I access specific sections of my data?</li>
<li>How does Pandas store data in rows and columns?</li>
<li>How can I clean up messy data?</li>
<li>How can I learn more about missing values, distributions and
structures in my data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Know the difference between a Series and a Dataframe</li>
<li>Know how to use <code>loc[]</code> to access data</li>
<li>Know how to apply basic data cleaning operations</li>
<li>Know how to use some more sophisticated Pandas functions to explore
and manipulate data</li>
<li>Know some techniques for preparing your data for machine
learning</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>You’ve seen briefly how to use Pandas to read in a data file when we
looked at the Penguin data. Real-world datasets are often - usually -
nearly always? - quite messy; so much so that data scientists spend the
majority of their time organising and cleaning data <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
<p>We’re going to work with a real dataset from an annual salary survey
from the website <a href="https://www.askamanager.org/2025/04/how-much-money-do-you-make-8.html" class="external-link">askamanager.org</a>.
Have a look at the website and browse the questions, then read in the <a href="../data/AAM_salary_survey_2025_responses.csv">data file</a>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># Read the raw salary-survey responses</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>survey_path <span class="op">=</span> <span class="st">"data/AAM_salary_survey_2025_responses.csv"</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>survey_data <span class="op">=</span> pd.read_csv(survey_path)</span></code></pre>
</div>
<p>A DataFrame contains labelled data. Each row and each column has a
label. The labels are stored in an index.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># print the column labels</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="bu">print</span>(survey_data.columns)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Index(['Timestamp', 'Age', 'Industry', 'Functional area of job', 'Job title',
       'Additional context', 'Annual salary',
       'Additional monetary compensation', 'Currency', 'Currency - other',
       'Income - additional context', 'Country', 'State', 'City/region',
       'Remote or on-site?', 'Unionized?', 'Years of experience',
       'Years in field', 'Highest level of education', 'Gender', 'Race',
       'Disabled?'],
      dtype='object')</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Show the first few lines</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>survey_data.head()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>           Timestamp  ... Disabled?
0  4/8/2025 11:01:58  ...       Yes
1  4/8/2025 11:02:05  ...        No
2  4/8/2025 11:02:26  ...        No
3  4/8/2025 11:02:30  ...        No
4  4/8/2025 11:02:31  ...        No

[5 rows x 22 columns]</code></pre>
</div>
<p>A DataFrame can contain a mix of data types.</p>
<p>We can see that there’s lots of interesting data in there. Here’s a
small list of questions we might want to ask: - What’s the distribution
of total income across all jobs? - Do unionised jobs earn more or less
than non-unionised? - Does salary go up with age, years of experience,
and education level? - Do people earning additional income tend to have
higher base salaries?</p>
<p>We’ll work through these, learning some more Pandas and data
manipulation skills along the way.</p>
</section><section><h2 class="section-heading" id="use-dataframe-dtypes-to-show-the-datatypes-of-each-column">Use <code>DataFrame.dtypes</code> to show the datatypes of each
column<a class="anchor" aria-label="anchor" href="#use-dataframe-dtypes-to-show-the-datatypes-of-each-column"></a>
</h2>
<hr class="half-width">
<p>Each column in a DataFrame is a Series. Series contain labelled data
too, but a Series can only contain a single data type.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># List the column headings and their inferred dtypes</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>survey_data.dtypes</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Timestamp                            object
Age                                  object
Industry                             object
Functional area of job               object
Job title                            object
Additional context                   object
Annual salary                         int64
Additional monetary compensation    float64
Currency                             object
Currency - other                     object
Income - additional context          object
Country                              object
State                                object
City/region                          object
Remote or on-site?                   object
Unionized?                           object
Years of experience                  object
Years in field                       object
Highest level of education           object
Gender                               object
Race                                 object
Disabled?                            object
dtype: object</code></pre>
</div>
<p>Pandas will try to work out what this should be, but sometimes does a
bad job. When it has a mixture of strings and numbers, it picks the most
generic type possible, which is <code>object</code>.</p>
</section><section><h2 class="section-heading" id="select-a-value-by-its-index-label-using-loc">Select a value by its index label using <code>loc[]</code>
<a class="anchor" aria-label="anchor" href="#select-a-value-by-its-index-label-using-loc"></a>
</h2>
<hr class="half-width">
<p>Note that the list of datatypes above is itself a Series! The index
labels are the column headings from <code>survey_results</code>, and the
values are the data types. We can pull out a single value with a label
from this series using the function <code>loc[]</code></p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>survey_data.dtypes.loc[<span class="st">"Age"</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fu">dtype</span><span class="op">(</span><span class="st">'O'</span><span class="op">)</span></span></code></pre>
</div>
<p>Notice the square brackets!</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>The <code>loc[]</code> function is really useful, and confusing, and
we’ll see more of it later. For now, remember that it takes square
brackets, and it lets you access data by its <em>label</em>.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="select-a-column-from-a-dataframe-with-column-name">Select a column from a DataFrame with
<code>["Column name"]</code>
<a class="anchor" aria-label="anchor" href="#select-a-column-from-a-dataframe-with-column-name"></a>
</h2>
<hr class="half-width">
<p>You can select a column with square brackets containing the column
name.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>survey_data[<span class="st">"Industry"</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0                                Nonprofits
1                               Health Care
2                               Engineering
3                                Nonprofits
4              Education (Higher Education)
                       ...
8229                                 Retail
8230     Government &amp; Public Administration
8231     Government &amp; Public Administration
8232    Education (Early/Primary/Secondary)
8233           Education (Higher Education)
Name: Industry, Length: 8234, dtype: object</code></pre>
</div>
<p>This is really a shortcut for</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>survey_data.loc[:, <span class="st">"Industry"</span>]</span></code></pre>
</div>
<p>Used on a DataFrame, <code>loc[]</code> takes two arguments - the
first one is the rows you want and the second one is the columns. Just
like with lists, you can slice with <code>start:stop</code>, and missing
out either one uses the endpoints.</p>
</section><section><h2 class="section-heading" id="cast-a-column-to-a-different-data-type-with-astype">Cast a column to a different data type with
<code>astype()</code>
<a class="anchor" aria-label="anchor" href="#cast-a-column-to-a-different-data-type-with-astype"></a>
</h2>
<hr class="half-width">
<p>You can change the data type of a column by selecting the column and
calling <code>astype()</code>, with the desired type as an argument.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>survey_data[<span class="st">"Industry"</span>].astype(<span class="st">"string"</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0                                Nonprofits
1                               Health Care
2                               Engineering
3                                Nonprofits
4              Education (Higher Education)
                       ...
8229                                 Retail
8230     Government &amp; Public Administration
8231     Government &amp; Public Administration
8232    Education (Early/Primary/Secondary)
8233           Education (Higher Education)
Name: Industry, Length: 8234, dtype: string</code></pre>
</div>
<p>This doesn’t modify the original, it makes a copy, so we haven’t yet
saved the result. What if we want to change the data types of all the
columns that contain <code>objects</code> to strings? (I have a hunch
this might come in handy later…) We <em>could</em> do this manually, but
I’m lazy, so let’s get the computer do the work.</p>
<p>You can change multiple columns at once by calling
<code>astype()</code> on the DataFrame and passing in a dictionary that
maps column names to data types. Here’s one way to build this
dictionary:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>dtypes_dict <span class="op">=</span> {}</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co"># loop through the columns with dtype object and add them to a dictionary</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="cf">for</span> column_name <span class="kw">in</span> survey_data.dtypes[survey_data.dtypes <span class="op">==</span> <span class="bu">object</span>].index:</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  dtypes_dict[column_name] <span class="op">=</span> <span class="st">"string"</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  </span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>dtypes_dict</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{'Timestamp': 'string', 'Age': 'string', 'Industry': 'string', 'Functional area of job': 'string', 'Job title': 'string', 'Additional context': 'string', 'Currency': 'string', 'Currency - other': 'string', 'Income - additional context': 'string', 'Country': 'string', 'State': 'string', 'City/region': 'string', 'Remote or on-site?': 'string', 'Unionized?': 'string', 'Years of experience': 'string', 'Years in field': 'string', 'Highest level of education': 'string', 'Gender': 'string', 'Race': 'string', 'Disabled?': 'string'}</code></pre>
</div>
<p>Now let’s use that to set the data types in our DataFrame. Remember
that we need to save the results.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>survey_data <span class="op">=</span> survey_data.astype(dtypes_dict)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>survey_data.dtypes</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Timestamp                           string[python]
Age                                 string[python]
Industry                            string[python]
Functional area of job              string[python]
Job title                           string[python]
Additional context                  string[python]
Annual salary                                int64
Additional monetary compensation           float64
Currency                            string[python]
Currency - other                    string[python]
Income - additional context         string[python]
Country                             string[python]
State                               string[python]
City/region                         string[python]
Remote or on-site?                  string[python]
Unionized?                          string[python]
Years of experience                 string[python]
Years in field                      string[python]
Highest level of education          string[python]
Gender                              string[python]
Race                                string[python]
Disabled?                           string[python]
dtype: object</code></pre>
</div>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Describe the key variables in this survey: - Which columns are
<em>categorical</em> (nominal)? - Which are <em>ordinal</em> (have an
inherent order)? - Which are <em>numeric</em> (continuous or
discrete)?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Numeric: - Annual salary - Additional monetary compensation</p>
<p>Categorical: - Industry - Functional area of job - Job title - Remote
or on-site? - Country - State - City/region - Currency and Currency -
other</p>
<p>Ordinal: - Age - Years of experience - Years in field - Highest level
of education</p>
<p>Note that numeric variables that are grouped into bins are ordinal
when the bins are of different sizes!</p>
<p>Also highest level of education could be considered categorical,
because it’s not easy to sort every value.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="find-missing-values-with-isna">Find missing values with <code>isna()</code>
<a class="anchor" aria-label="anchor" href="#find-missing-values-with-isna"></a>
</h2>
<hr class="half-width">
<p>Do any of the columns have missing values? We can find them, count
them up in each column, and sort the results as follows:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Count missing values per column</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>survey_data.isna().<span class="bu">sum</span>().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Currency - other                    8191
Income - additional context         7496
Additional context                  6402
Additional monetary compensation    2108
State                               1529
Race                                  91
Unionized?                            85
Functional area of job                65
Disabled?                             37
Industry                              34
Gender                                33
Remote or on-site?                    26
Highest level of education            16
City/region                            5
Job title                              1
Age                                    0
Timestamp                              0
Annual salary                          0
Country                                0
Currency                               0
Years in field                         0
Years of experience                    0
dtype: int64</code></pre>
</div>
<p>Lots of the columns have missing values - even some columns that are
required in the survey, like <code>Job title</code>. What’s doing on
here?</p>
<div id="callout2" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>Pandas <code>read_csv()</code> function does a lot of work under the
hood. From the documentation:</p>
<blockquote>
<p>By default the following values are interpreted as NaN: “ “, “#N/A”,
“#N/A N/A”, “#NA”, “-1.#IND”, “-1.#QNAN”, “-NaN”, “-nan”, “1.#IND”,
“1.#QNAN”, “<na>”, “N/A”, “NA”, “NULL”, “NaN”, “None”, “n/a”, “nan”,
“null “.</na></p>
</blockquote>
</div>
</div>
</div>
<p>We also have the answer to our earlier question about the data type
of <code>Additional monetary compensation</code>. It contains
<code>NaN</code> values, which Pandas treats as a <code>float64</code>,
forcing the whole column to be float64.</p>
<div id="how-we-should-treat-missing-values-depends-on-the-analysis-we-want-to-do." class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="how-we-should-treat-missing-values-depends-on-the-analysis-we-want-to-do." class="callout-inner">
<h3 class="callout-title">How we should treat missing values depends on the analysis we want to do.</h3>
<div class="callout-content">

</div>
</div>
</div>
<p>How should we deal with the missing values? In some cases the missing
data is irrelevant. Each column needs to be considered differently. For
example: - we don’t need <code>Currency - other</code> if there is a
value in the <code>Currency</code> column - we don’t care about
<code>State</code> unless we’re only looking at the US - We can safely
assume that a missing value in
<code>Additional monetary compensation</code> means £0 - if we want to
know whether <code>Unionized?</code> makes a difference to earnings, a
row with no value there is useless to us</p>
<p>Pandas has some useful functions for this.</p>
</section><section><h2 class="section-heading" id="use-fillna-to-fill-missing-values-in-a-column">Use <code>fillna()</code> to fill missing values in a column<a class="anchor" aria-label="anchor" href="#use-fillna-to-fill-missing-values-in-a-column"></a>
</h2>
<hr class="half-width">
<p>With <code>Additional monetary compensation</code> we can replace
missing values with 0. We can also change the type to be
<code>int64</code></p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>survey_data[<span class="st">"Additional monetary compensation"</span>] <span class="op">=</span> survey_data[<span class="st">"Additional monetary compensation"</span>].fillna(<span class="dv">0</span>).astype(<span class="st">"int"</span>)</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="use-dropna-on-a-dataframe-to-remove-rows-or-columns-with-missing-values">Use <code>dropna()</code> on a DataFrame to remove rows or columns
with missing values<a class="anchor" aria-label="anchor" href="#use-dropna-on-a-dataframe-to-remove-rows-or-columns-with-missing-values"></a>
</h2>
<hr class="half-width">
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Pandas has a useful function, <code>dropna()</code>. Use the docs
pages (by running <code>help(survey_data.dropna)</code> or typing
<code>survey_data.drop_na(</code> and Shift+Tab) to find how to drop
rows that have missing values in the <code>Unionized?</code> column.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>survey_data <span class="op">=</span> survey_data.dropna(subset<span class="op">=</span>[<span class="st">"Unionized?"</span>], axis<span class="op">=</span><span class="st">"rows"</span>)</span></code></pre>
</div>
<p>Note that <code>axis="rows"</code> (or <code>"index"</code>, or
<code>0</code>) is the default, so we don’t strictly need to include
it.</p>
</div>
</div>
</div>
</div>
<div id="callout4" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>Does dropping <code>NA</code>s disproportionately affect any subgroup
(e.g., a particular country)? Consider whether that matters for your
analysis.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="use-value_counts-to-count-occurrences-of-categorical-variables">Use <code>value_counts</code> to count occurrences of categorical
variables<a class="anchor" aria-label="anchor" href="#use-value_counts-to-count-occurrences-of-categorical-variables"></a>
</h2>
<hr class="half-width">
<p>Let’s get a sense of where the data is coming from. This is an
American website, in English, so the top results shouldn’t be a
surprise:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>survey_data[<span class="st">"Country"</span>].value_counts().head()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Country
United States     6691
Canada             541
United Kingdom     444
Australia          141
Germany             68
Name: count, dtype: Int64</code></pre>
</div>
<p>What about the age column?</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>survey_data[<span class="st">"Age"</span>].value_counts()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Age
35-44         3403
25-34         2258
45-54         1597
55-64          711
18-24           88
65 or over      88
under 18         4
Name: count, dtype: Int64</code></pre>
</div>
<p>We want to know how income is distributed, but the income figures are
in different currencies, and some people have additional income on top
of their salaries, so we can’t compare directly. We’ll need to create a
new feature from our existing data. Let’s see what currencies we’ve
got.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>survey_data[<span class="st">"Currency"</span>].value_counts()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Currency
USD      6722
CAD       541
GBP       442
EUR       192
AUD       139
NZD        51
Other      36
JPY         9
SEK         8
CHF         7
ZAR         2
Name: count, dtype: Int64</code></pre>
</div>
<p><code>Currency</code> uses three letter codes. We can work with that
to convert everyone’s earnings to the same currency using exchange rate
data.</p>
<p>But first, notice that we have 36 “Other”. Wouldn’t it be nice to see
what those are?</p>
</section><section><h2 class="section-heading" id="use-loc-with-boolean-masking-to-select-values-according-to-logical-rules">Use <code>loc[]</code> with boolean masking to select values
according to logical rules<a class="anchor" aria-label="anchor" href="#use-loc-with-boolean-masking-to-select-values-according-to-logical-rules"></a>
</h2>
<hr class="half-width">
<p>As well as labels, we can use <code>loc[]</code> to access data based
on logical conditions. This is called boolean indexing or masking. First
we create a mask:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>survey_data[<span class="st">"Currency"</span>] <span class="op">==</span> <span class="st">"Other"</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0       False
1       False
2       False
3       False
4       False
        ...
8229    False
8230    False
8231    False
8232    False
8233    False
Name: Currency, Length: 8149, dtype: boolean</code></pre>
</div>
<p>This is a Series of booleans with the same index as
<code>survey_data</code>, containing True where the
<code>Currency</code> column contains “Other” and False everywhere
else.</p>
<p>Then we pass that mask into <code>loc[]</code> to tell it which rows
we want:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>survey_data.loc[survey_data[<span class="st">"Currency"</span>] <span class="op">==</span> <span class="st">"Other"</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>               Timestamp  ...                    Disabled?
545    4/8/2025 11:20:01  ...                           No
690    4/8/2025 11:24:17  ...                           No
985    4/8/2025 11:36:03  ...                           No
1210   4/8/2025 11:45:27  ...                           No
2369   4/8/2025 12:42:14  ...                           No
2513   4/8/2025 12:51:16  ...                           No
3704   4/8/2025 14:28:43  ...                           No
3975   4/8/2025 15:06:03  ...  Not sure / it's complicated
4701   4/8/2025 17:24:31  ...                           No
5377   4/8/2025 20:54:00  ...                           No
5414   4/8/2025 21:04:21  ...                           No
5643   4/8/2025 22:39:29  ...                           No
5860    4/9/2025 1:45:27  ...  Not sure / it's complicated
5902    4/9/2025 2:58:14  ...                           No
5905    4/9/2025 2:59:47  ...                           No
5918    4/9/2025 3:25:56  ...                           No
5979    4/9/2025 4:45:59  ...                           No
6009    4/9/2025 5:32:34  ...                           No
6083    4/9/2025 6:58:28  ...                           No
6253    4/9/2025 9:10:41  ...  Not sure / it's complicated
6320    4/9/2025 9:38:26  ...                          Yes
6348    4/9/2025 9:52:12  ...                           No
6431   4/9/2025 10:33:51  ...                           No
7117   4/9/2025 22:40:56  ...  Not sure / it's complicated
7155   4/10/2025 0:36:14  ...                           No
7168   4/10/2025 1:21:24  ...                           No
7198   4/10/2025 5:23:30  ...                           No
7289   4/10/2025 9:52:42  ...                           No
7366  4/10/2025 12:09:19  ...                           No
7390  4/10/2025 12:52:34  ...  Not sure / it's complicated
7689   4/12/2025 8:17:59  ...                           No
7805  4/14/2025 10:14:33  ...                           No
7965   4/17/2025 2:19:12  ...  Not sure / it's complicated
8001   4/18/2025 1:43:20  ...                           No
8080  4/25/2025 18:34:12  ...                           No
8186   5/14/2025 2:35:42  ...                           No

[36 rows x 22 columns]</code></pre>
</div>
<p>But we’re really only interested in one column -
<code>Currency - other</code>. We can pass that into <code>loc</code> as
well to just get a Series containing the elements of interest, and then
count the values like before:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>survey_data.loc[survey_data[<span class="st">"Currency"</span>] <span class="op">==</span> <span class="st">"Other"</span>, <span class="st">"Currency - other"</span>].value_counts()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Currency - other
SGD                    6
NOK                    5
MXN                    2
Sek                    2
NZD                    2
AED                    2
PLN                    2
CZK                    2
TTD                    1
INR                    1
DKK (danish crowns)    1
BRL                    1
INR Indian Rupee       1
SEK                    1
DKK                    1
Sfr                    1
HUF                    1
KES                    1
MYR                    1
IDR                    1
Rupees                 1
Name: count, dtype: Int64</code></pre>
</div>
<p>There aren’t many of each - 6 Singaporean Dollars, 5 Norwegian
Kroners, 2 UAE Dirhams, etc. At this point we have to make a decision
about how much we care about this fairly small number of values. We
could decide it’s not worth the effort, but we’re going to be thorough
and clean up these values, even though it’s a bit fiddly, because it’s a
great chance to practice some more Pandas skills!</p>
<p>Let’s tidy up the <code>Currency</code> column. The three letter
codes in our <code>Currency - other</code> column look valid, so let’s
copy them straight over to <code>Currency</code>.</p>
<p>This is going to take a few steps: - find the rows where the length
of the <code>Currency - other</code> field is 3 - capitalise them, to
catch that pesky Swiss Franc (Sfr) - copy them to the
<code>Currency</code> column in the same rows</p>
</section><section><h2 class="section-heading" id="pandas-can-run-str-functions-on-string-columns">Pandas can run <code>str</code> functions on string columns<a class="anchor" aria-label="anchor" href="#pandas-can-run-str-functions-on-string-columns"></a>
</h2>
<hr class="half-width">
<p>Finding the length of a string can be done efficiently with Pandas
<code>str</code> package. To make a Series containing all the
lengths:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>other_currency_len <span class="op">=</span> survey_data[<span class="st">"Currency - other"</span>].<span class="bu">str</span>.<span class="bu">len</span>()</span></code></pre>
</div>
<p>We can turn <code>curr_lengths</code> into a boolean mask like
this:</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>other_currency_len <span class="op">==</span> <span class="dv">3</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0       &lt;NA&gt;
1       &lt;NA&gt;
2       &lt;NA&gt;
3       &lt;NA&gt;
4       &lt;NA&gt;
        ...
8229    &lt;NA&gt;
8230    &lt;NA&gt;
8231    &lt;NA&gt;
8232    &lt;NA&gt;
8233    &lt;NA&gt;
Name: Currency - other, Length: 8149, dtype: boolean</code></pre>
</div>
<div id="challenge3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Use boolean masking to find the values for <code>Currency</code>
corresponding to answers to <code>Currency - other</code> that are
exactly 3 characters long.</p>
<p>As a simple but incomplete sanity check, we know they should all be
“Other”!</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>survey_data.loc[other_currency_len <span class="op">==</span> <span class="dv">3</span>, <span class="st">"Currency"</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>545     Other
690     Other
1210    Other
2369    Other
2513    Other
3704    Other
3975    Other
4701    Other
5377    Other
5414    Other
5643    Other
5902    Other
5905    Other
5918    Other
5979    Other
6009    Other
6083    Other
6253    Other
6320    Other
6348    Other
6431    Other
7117    Other
7155    Other
7168    Other
7198    Other
7289    Other
7366    Other
7689    Other
7805    Other
7965    Other
8001    Other
8080    Other
8186    Other
Name: Currency, dtype: string</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<em> (continued)</em>
</h3>
<div class="callout-content">
<p>Can you figure out, or guess, how to make those elements all upper
case?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>Use the function <code>str.upper()</code>:</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>survey_data.loc[other_currency_len <span class="op">==</span> <span class="dv">3</span>, <span class="st">"Currency - other"</span>].<span class="bu">str</span>.upper()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>545     TTD
690     INR
1210    NOK
2369    MXN
2513    SEK
3704    SEK
3975    NOK
4701    NZD
5377    BRL
5414    NZD
5643    SGD
5902    DKK
5905    SEK
5918    NOK
5979    CZK
6009    HUF
6083    SFR
6253    NOK
6320    PLN
6348    KES
6431    MXN
7117    MYR
7155    IDR
7168    SGD
7198    SGD
7289    SGD
7366    NOK
7689    SGD
7805    AED
7965    CZK
8001    SGD
8080    PLN
8186    AED
Name: Currency - other, dtype: string</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<em> (continued)</em>
</h3>
<div class="callout-content">
<p>Finally, use those values to replace the original values in the
<code>Currency</code> column.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<p>We have to make sure that we add the modified values to the right
column:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>survey_data.loc[other_currency_len <span class="op">==</span> <span class="dv">3</span>, <span class="st">"Currency"</span>] <span class="op">=</span> survey_data.loc[other_currency_len <span class="op">==</span> <span class="dv">3</span>, <span class="st">"Currency - other"</span>].<span class="bu">str</span>.upper()</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>If we did those last few steps correctly, we should have far fewer
“Other” values:</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>survey_data.loc[survey_data[<span class="st">"Currency"</span>] <span class="op">==</span> <span class="st">"Other"</span>, <span class="st">"Currency - other"</span>].value_counts()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Currency - other
DKK (danish crowns)    1
INR Indian Rupee       1
Rupees                 1
Name: count, dtype: Int64</code></pre>
</div>
<p>Good. The last few we’ll have to do manually. Let’s assume that
“Rupees” also refers to Indian rupees (and not Mauritius, Nepal,
Pakistan, Sri Lanka, or any of the other countries with a currency
called Rupees).</p>
<div id="challenge6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Can you use what you’ve learned so far to fix the remaining values in
the <code>Currency</code> column, based on the answers in the
<code>Currency - other</code> column?</p>
</div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1"> Give me a hint </h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" data-bs-parent="#accordionHint1" aria-labelledby="headingHint1">
<div class="accordion-body">
<p>You need to locate a single value, and set it to the desired value.
First think about how to find the row you’re interested in. Then which
column you want. Then pass both into <code>loc[]</code></p>
</div>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">
<p>Here’s the first one:</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>survey_data.loc[survey_data[<span class="st">"Currency - other"</span>] <span class="op">==</span> <span class="st">"DKK (danish crowns)"</span>, <span class="st">"Currency"</span>] <span class="op">=</span> <span class="st">"DKK"</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7"> Show me the solution </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" data-bs-parent="#accordionSolution7" aria-labelledby="headingSolution7">
<div class="accordion-body">
<p>Here are the other two:</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>survey_data.loc[survey_data[<span class="st">"Currency - other"</span>] <span class="op">==</span> <span class="st">"INR Indian Rupee"</span>, <span class="st">"Currency"</span>] <span class="op">=</span> <span class="st">"INR"</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>survey_data.loc[survey_data[<span class="st">"Currency - other"</span>] <span class="op">==</span> <span class="st">"Rupees"</span>, <span class="st">"Currency"</span>] <span class="op">=</span> <span class="st">"INR"</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>OK, time to do the conversions. The U.K. government publishes average
annual GBP exchange rates on its website. You can find the data from
March 2025 in the file <code>data/average_csv_2025-3.csv</code>.</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co"># Read the FX-rate file (average 2025 exchange rates)</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>gbp_conversions <span class="op">=</span> pd.read_csv(<span class="st">"data/average_csv_2025-3.csv"</span>, index_col<span class="op">=</span><span class="st">"Country"</span>)</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>gbp_conversions.head()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>             Unit Of Currency  ... Currency Units per £1
Country                        ...
Abu Dhabi              Dirham  ...                4.6865
Albania                   Lek  ...              118.5071
Algeria                 Dinar  ...              171.2515
Angola           Readj Kwanza  ...             1142.7772
Antigua    E Caribbean Dollar  ...                3.4492

[5 rows x 4 columns]</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>gbp_conversions.columns</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Index(['Unit Of Currency', 'Currency Code',
       'Sterling value of Currency Unit £', 'Currency Units per £1'],
      dtype='object')</code></pre>
</div>
<p>Let’s get this ready to map values from any currency into GBP: -
we’re only interested in two columns: <code>Currency Code</code> and
<code>Sterling value of Currency Unit £</code> - we can give these
shorter names to save ourselves some typing - we want to look up values
using the currency code, so we should set that as the index, and then
it’s only one column that we’re interested in</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a>gbp_map <span class="op">=</span> gbp_conversions.loc[:, [<span class="st">"Currency Code"</span>, <span class="st">"Sterling value of Currency Unit £"</span>]]</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>gbp_map <span class="op">=</span> gbp_map.rename(columns<span class="op">=</span>{<span class="st">"Currency Code"</span>: <span class="st">"Currency"</span>, <span class="st">"Sterling value of Currency Unit £"</span>: <span class="st">"Exchange rate"</span>})</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>gbp_map <span class="op">=</span> gbp_map.set_index(<span class="st">"Currency"</span>)[<span class="st">"Exchange rate"</span>]</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>gbp_map</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Currency
AED    0.2134
ALL    0.0084
DZD    0.0058
AOA    0.0009
XCD    0.2899
        ...
VND    0.0000
XPF    0.0071
WST    0.2834
YER    0.0031
ZMW    0.0295
Name: Exchange rate, Length: 162, dtype: float64</code></pre>
</div>
</section><section><h2 class="section-heading" id="check-which-values-occur-in-a-series-with-isin">Check which values occur in a Series with <code>isin()</code>
<a class="anchor" aria-label="anchor" href="#check-which-values-occur-in-a-series-with-isin"></a>
</h2>
<hr class="half-width">
<p>Let’s check that all our currency codes appear in the exchange rate
data.</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a>survey_data[<span class="st">"Currency"</span>].isin(gbp_map.index).mean()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fu">np.float64</span><span class="op">(</span><span class="fl">0.9456375015339306</span><span class="op">)</span></span></code></pre>
</div>
<p>Only 95%! Let’s find the ones that are missing. We’ll need to use a
logical operator for negation, <code>~</code>. This turns True to False
and False to True.</p>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a>survey_data.loc[<span class="op">~</span>survey_data[<span class="st">"Currency"</span>].isin(gbp_map.index), <span class="st">"Currency"</span>].value_counts()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Currency
GBP    442
SFR      1
Name: count, dtype: Int64</code></pre>
</div>
<p>That makes sense! The U.K. Government data doesn’t include a GBP-GBP
exchange rate (we can probably work that one out in our heads).</p>
<p>Let’s add it manually to make our calculations easier</p>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>gbp_map.loc[<span class="st">"GBP"</span>] <span class="op">=</span> <span class="dv">1</span></span></code></pre>
</div>
<p>We can use these conversions to put every salary in GBP. We’ll also
need to add any additional compensation to get the total.</p>
</section><section><h2 class="section-heading" id="use-map-to-efficiently-apply-a-function-to-every-element">Use <code>map()</code> to efficiently apply a function to every
element<a class="anchor" aria-label="anchor" href="#use-map-to-efficiently-apply-a-function-to-every-element"></a>
</h2>
<hr class="half-width">
<p>First let’s convert the salary and additional compensation columns.
We can try to use <code>gbp_map</code> to get the exchange rates based
on currency codes</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>survey_data[<span class="st">"Currency"</span>].<span class="bu">map</span>(gbp_map)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>pandas.errors.InvalidIndexError: Reindexing only valid with uniquely valued Index objects</code></pre>
</div>
<p>Uh oh! There’s a problem. Can you guess what’s happened here? It’s
not obvious, but the error message gives a clue.</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Show details </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>The exchange rates data contains some duplicate currencies, because
some countries use the same currency (e.g. Bhutan uses INR). That means
we have some duplciate values in the index, and Pandas doesn’t know
which one we want - it doesn’t matter to Pandas that they’re the
same!</p>
<p>You can check this with</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>gbp_map.index.value_counts()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Currency
XOF    8
XCD    7
XAF    6
AED    3
XPF    3
      ..
VND    1
WST    1
YER    1
ZMW    1
GBP    1
Name: count, Length: 141, dtype: int64</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="remove-duplicate-values-with-drop_duplicates-or-duplicated">Remove duplicate values with <code>drop_duplicates()</code> or
<code>duplicated()</code>
<a class="anchor" aria-label="anchor" href="#remove-duplicate-values-with-drop_duplicates-or-duplicated"></a>
</h2>
<hr class="half-width">
<p>As usual Pandas has a function that can help us here:
<code>drop_duplicates()</code>. We need to remove duplicates from the
<em>index</em>, not the values - otherwise we’d be removing currencies
with the same rate, not necessarily the same code.</p>
<p>We could use <code>drop_duplicates()</code> on the index, but we have
no good way to map that back to the values. We can also use the
<code>duplicated()</code> function on the index to find labels that are
duplicated, and then use that to filter the DataFrame.</p>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>gbp_map <span class="op">=</span> gbp_map[<span class="op">~</span>gbp_map.index.duplicated(keep<span class="op">=</span><span class="st">'first'</span>)]</span></code></pre>
</div>
<p>There’s that negation operator again. We want to include labels that
aren’t duplicated, so we use <code>~</code> to negate the boolean mask
returned by <code>duplicated()</code>. We also told duplicated to ignore
the first occurrence of each label with <code>keep='first'</code>.</p>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a>gbp_map.index.value_counts()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Currency
AED    1
ALL    1
DZD    1
AOA    1
XCD    1
      ..
VND    1
WST    1
YER    1
ZMW    1
GBP    1
Name: count, Length: 141, dtype: int64</code></pre>
</div>
<p>That’s better!</p>
<p>Now we can use <code>map()</code> to convert the currency values to
GBP:</p>
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a>survey_data[<span class="st">"Currency"</span>].<span class="bu">map</span>(gbp_map)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0       0.7836
1       1.0000
2       0.7836
3       0.7836
4       0.5654
         ...
8229    1.0000
8230    0.7836
8231    0.7836
8232    0.7836
8233    1.0000
Name: Currency, Length: 8149, dtype: float64</code></pre>
</div>
<p>We can add new columns to our DataFrame containing the converted
amounts. When we’re adding columns we should use <code>loc[]</code>:</p>
<div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a>survey_data.loc[:, <span class="st">"Annual salary GBP"</span>] <span class="op">=</span> survey_data[<span class="st">"Annual salary"</span>] <span class="op">*</span> survey_data[<span class="st">"Currency"</span>].<span class="bu">map</span>(gbp_map)</span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a>survey_data.loc[:, <span class="st">"Additional monetary compensation GBP"</span>] <span class="op">=</span> survey_data[<span class="st">"Additional monetary compensation"</span>] <span class="op">*</span> survey_data.loc[:, <span class="st">"Currency"</span>].<span class="bu">map</span>(gbp_map)</span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>survey_data.loc[:, <span class="st">"Total GBP"</span>] <span class="op">=</span> survey_data[<span class="st">"Annual salary GBP"</span>] <span class="op">+</span> survey_data[<span class="st">"Additional monetary compensation GBP"</span>]</span></code></pre>
</div>
<p>Now we’re finally ready to plot the distribution we’re interested in:
a histogram of total compensation in GBP.</p>
<div class="codewrapper sourceCode" id="cb68">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">5</span>))</span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>plt.hist(survey_data[<span class="st">"Total GBP"</span>], bins<span class="op">=</span><span class="dv">50</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a>plt.show()</span></code></pre>
</div>
<figure><img src="../fig/02-data-exploration-and-preprocessing-rendered-unnamed-chunk-38-1.png" width="768" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Ah. Looks like almost all the values are condensed into a single
band, but the axis range is huge, because someone claims to earn around
£800 million.</p>
<p>Let’s have a quick look at the stats. Explore the values with
describe:</p>
<div class="codewrapper sourceCode" id="cb69">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a>survey_data[<span class="st">"Total GBP"</span>].describe()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>count    8.148000e+03
mean     1.992544e+05
std      9.427335e+06
min      0.000000e+00
25%      5.060330e+04
50%      7.002600e+04
75%      1.018680e+05
max      8.478568e+08
Name: Total GBP, dtype: float64</code></pre>
</div>
<div id="challenge7" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Can you pull out the row containing the maximum value of
<code>Total GBP</code> and print it as a column?</p>
</div>
</div>
</div>
<div id="accordionHint2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint2" aria-expanded="false" aria-controls="collapseHint2">
  <h4 class="accordion-header" id="headingHint2"> Give me a hint </h4>
</button>
<div id="collapseHint2" class="accordion-collapse collapse" data-bs-parent="#accordionHint2" aria-labelledby="headingHint2">
<div class="accordion-body">
<p>You can use <code>survey_data["Total GBP"].max()</code> to find the
maximum value, and then use <code>loc[]</code> to select the row with
that value.</p>
</div>
</div>
</div>
</div>
<div id="accordionHint3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint3" aria-expanded="false" aria-controls="collapseHint3">
  <h4 class="accordion-header" id="headingHint3"> Give me a hint </h4>
</button>
<div id="collapseHint3" class="accordion-collapse collapse" data-bs-parent="#accordionHint3" aria-labelledby="headingHint3">
<div class="accordion-body">
<p>Use <code>T</code> to flip the orientation from a row to a column</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8"> Show me the solution </h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" data-bs-parent="#accordionSolution8" aria-labelledby="headingSolution8">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb71">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a>survey_data.loc[survey_data[<span class="st">"Total GBP"</span>] <span class="op">==</span> survey_data[<span class="st">"Total GBP"</span>].<span class="bu">max</span>()].T</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                                                          7708
Timestamp                                   4/12/2025 12:37:12
Age                                                      55-64
Industry                                  Hospitality &amp; Events
Functional area of job                Property or Construction
Job title                                      Program Manager
Additional context                                        &lt;NA&gt;
Annual salary                                       1082000000
Additional monetary compensation                          2000
Currency                                                   USD
Currency - other                                          &lt;NA&gt;
Income - additional context                               &lt;NA&gt;
Country                                          United States
State                                               Washington
City/region                                      Pierce County
Remote or on-site?                                     On-site
Unionized?                                                  No
Years of experience                                31-40 years
Years in field                                     11-20 years
Highest level of education                        Some college
Gender                                                     Man
Race                                                     White
Disabled?                                                   No
Annual salary GBP                                  847855200.0
Additional monetary compensation GBP                    1567.2
Total GBP                                          847856767.2</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="remove-outliers">Remove outliers<a class="anchor" aria-label="anchor" href="#remove-outliers"></a>
</h2>
<hr class="half-width">
<p>A property and construction program manager for a hospitality and
events company on a salary of $1 billion seems unlikely to me. How does
it compare to the next few largest values?</p>
<div class="codewrapper sourceCode" id="cb73">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="co"># get the highest five values in Total GBP</span></span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a>survey_data.sort_values(<span class="st">"Total GBP"</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">15</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>               Timestamp  ...     Total GBP
7708  4/12/2025 12:37:12  ...  8.478568e+08
6888   4/9/2025 16:04:03  ...  7.262507e+07
4109   4/8/2025 15:26:31  ...  1.222416e+07
2715   4/8/2025 13:05:27  ...  3.844906e+06
5739   4/8/2025 23:47:05  ...  1.030434e+06
1209   4/8/2025 11:45:22  ...  9.951720e+05
1161   4/8/2025 11:43:16  ...  8.462880e+05
3845   4/8/2025 14:47:32  ...  8.227800e+05
4884   4/8/2025 18:14:58  ...  7.840717e+05
2113   4/8/2025 12:24:17  ...  7.052400e+05
2531   4/8/2025 12:52:21  ...  7.000000e+05
3498   4/8/2025 14:05:22  ...  6.268800e+05
5353   4/8/2025 20:46:59  ...  5.892672e+05
5848    4/9/2025 1:31:47  ...  5.798640e+05
1570   4/8/2025 11:59:31  ...  5.649756e+05

[15 rows x 25 columns]</code></pre>
</div>
<p>The max is more than 10 times the next largest value. I think we can
safely delete at least the largest row, and maybe anything else over,
say, £1 million.</p>
<div class="codewrapper sourceCode" id="cb75">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a>survey_data <span class="op">=</span> survey_data[survey_data[<span class="st">"Total GBP"</span>] <span class="op">&lt;</span> <span class="fl">1e6</span>]</span></code></pre>
</div>
<div id="callout5" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>Survey data, particularly when collected online, is notoriously
noisy. Some people are stupid, some peopel make mistakes, and some just
like to mess with surveys. As a results, there is usually a reasonable
percentage of responses that can’t be trusted. If you’re lucky, these
are obvious.</p>
<p>This is sometimes know as the “Lizardman Factor” or “Lizardman’s
constant”, named after a 2012 survey that found that 4% of people
believed that shape-shifting reptilian people have taken on human form
and now control our world.</p>
</div>
</div>
</div>
<p>Let’s check the distribution again, now that we’ve removed the
outliers:</p>
<div class="codewrapper sourceCode" id="cb76">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">5</span>))</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>plt.hist(survey_data[<span class="st">"Total GBP"</span>], bins<span class="op">=</span><span class="dv">50</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>plt.show()</span></code></pre>
</div>
<figure><img src="../fig/02-data-exploration-and-preprocessing-rendered-unnamed-chunk-43-3.png" width="768" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>That’s better! We can see a more reasonable distribution of salaries,
with a long thiin tail towards the top end.</p>
</section><section><h2 class="section-heading" id="compare-salaries-by-country-using-groupby">Compare salaries by country using <code>groupby()</code>
<a class="anchor" aria-label="anchor" href="#compare-salaries-by-country-using-groupby"></a>
</h2>
<hr class="half-width">
<p>Let’s look at the average salary by country. We’ll use
<code>groupby()</code> to group the data by country, and then calculate
the mean of the total compensation for each group.</p>
<div class="codewrapper sourceCode" id="cb77">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a>country_salary <span class="op">=</span> survey_data.groupby(<span class="st">"Country"</span>)[<span class="st">"Total GBP"</span>].mean().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>country_salary</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Country
Hong Kong                 270342.0000
Caribbean                 239487.7500
UAE                       220228.8000
Europe for US company     215490.0000
Finlanf                   193614.0000
                             ...
Vietnam                     9707.2368
India                       7723.6500
The country of Europe       1352.5920
Trinidad and Tobago          623.7000
Indonesia                      0.0000
Name: Total GBP, Length: 78, dtype: float64</code></pre>
</div>
<p>We can plot this as a bar chart to make it easier to see the
differences:</p>
<div class="codewrapper sourceCode" id="cb79">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>), layout<span class="op">=</span><span class="st">"constrained"</span>)</span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>country_salary.plot(kind<span class="op">=</span><span class="st">'barh'</span>)</span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">4</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>(array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33,
       34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50,
       51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67,
       68, 69, 70, 71, 72, 73, 74, 75, 76, 77]), [Text(0, 0, 'Hong Kong'), Text(0, 1, 'Caribbean'), Text(0, 2, 'UAE'), Text(0, 3, 'Europe for US company '), Text(0, 4, 'Finlanf'), Text(0, 5, 'México '), Text(0, 6, 'Nigeria'), Text(0, 7, 'Israel'), Text(0, 8, 'Switzerland'), Text(0, 9, 'Mongolia'), Text(0, 10, 'Saudi Arabia'), Text(0, 11, 'Aotearoa New Zealand '), Text(0, 12, 'Ghana'), Text(0, 13, 'Switzerland '), Text(0, 14, 'Jamaica'), Text(0, 15, 'United States'), Text(0, 16, 'switzerland'), Text(0, 17, 'Luxembourg '), Text(0, 18, 'Czech Republic'), Text(0, 19, 'United Arab Emirates'), Text(0, 20, 'Denmark'), Text(0, 21, 'Ireland'), Text(0, 22, 'new zealand'), Text(0, 23, 'Singapore'), Text(0, 24, 'New Zealand '), Text(0, 25, 'france'), Text(0, 26, 'Luxembourg'), Text(0, 27, 'Australia'), Text(0, 28, 'China'), Text(0, 29, 'the Netherlands'), Text(0, 30, 'Norway'), Text(0, 31, 'Austria '), Text(0, 32, 'Canada'), Text(0, 33, 'Netherlands '), Text(0, 34, 'Italy'), Text(0, 35, 'Netherlands'), Text(0, 36, 'Southeast Asia'), Text(0, 37, 'United Kingdom'), Text(0, 38, 'NZ'), Text(0, 39, 'Austria'), Text(0, 40, 'New Zealand'), Text(0, 41, 'Kenya'), Text(0, 42, 'Finland'), Text(0, 43, 'South Africa'), Text(0, 44, 'Germany'), Text(0, 45, 'Belgium'), Text(0, 46, 'The Netherlands '), Text(0, 47, 'Portugal'), Text(0, 48, 'France'), Text(0, 49, 'Hungary'), Text(0, 50, 'North Macedonia'), Text(0, 51, 'Greece '), Text(0, 52, 'South Korea'), Text(0, 53, 'I live in Canada, but my employer is in the USA'), Text(0, 54, 'Sweden'), Text(0, 55, 'Sweden '), Text(0, 56, 'Spain'), Text(0, 57, 'Finland '), Text(0, 58, 'The Netherlands'), Text(0, 59, 'Remotely moving in Southeast Asia'), Text(0, 60, 'Aotearoa New Zealand'), Text(0, 61, 'il'), Text(0, 62, 'argentina '), Text(0, 63, 'Mexico'), Text(0, 64, 'Brazil'), Text(0, 65, 'Poland'), Text(0, 66, 'Internationally - multiple countries as needed '), Text(0, 67, 'Japan'), Text(0, 68, 'Belgium '), Text(0, 69, 'Japan '), Text(0, 70, 'Latvia'), Text(0, 71, 'Malaysia'), Text(0, 72, 'Czechia'), Text(0, 73, 'Vietnam'), Text(0, 74, 'India'), Text(0, 75, 'The country of Europe'), Text(0, 76, 'Trinidad and Tobago'), Text(0, 77, 'Indonesia')])</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb81">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a>plt.layout()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>AttributeError: module 'matplotlib.pyplot' has no attribute 'layout'</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb83">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a>plt.show()</span></code></pre>
</div>
<figure><img src="../fig/02-data-exploration-and-preprocessing-rendered-unnamed-chunk-45-5.png" width="960" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We can see that a lot of the countries have been entered manually, so
the data is messy. We won’t clean these up now. Note that in a rigorous
analysis you would want to normalise for cost of living,
purchasing-power parity (PPP), and so on.</p>
</section><section><h2 class="section-heading" id="use-groupby-to-perform-calculations-on-groups-of-data">Use <code>groupby()</code> to perform calculations on groups of
data<a class="anchor" aria-label="anchor" href="#use-groupby-to-perform-calculations-on-groups-of-data"></a>
</h2>
<hr class="half-width">
<p>Let’s move onto our next question: - Do unionised jobs earn more or
less than non-unionised?</p>
<div class="codewrapper sourceCode" id="cb84">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a>union_salary <span class="op">=</span> survey_data.groupby(<span class="st">"Unionized?"</span>)[<span class="st">"Total GBP"</span>].mean()</span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a>union_salary</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Unionized?
No     87951.627244
Yes    64302.693696
Name: Total GBP, dtype: float64</code></pre>
</div>
<p>At first glance, the unionised jobs earn less Let’s look in more
detail with a box plot.</p>
<div class="codewrapper sourceCode" id="cb86">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="co"># plot a box-and-whisker diagram of the total compensation by union status</span></span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>))</span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a>survey_data.boxplot(</span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a>  by<span class="op">=</span><span class="st">"Unionized?"</span>,</span>
<span id="cb86-6"><a href="#cb86-6" tabindex="-1"></a>  column<span class="op">=</span><span class="st">"Total GBP"</span>,</span>
<span id="cb86-7"><a href="#cb86-7" tabindex="-1"></a>)</span>
<span id="cb86-8"><a href="#cb86-8" tabindex="-1"></a>plt.show()</span></code></pre>
</div>
<p><img src="../fig/02-data-exploration-and-preprocessing-rendered-unnamed-chunk-47-7.png" width="672" style="display: block; margin: auto;" class="figure"><img src="../fig/02-data-exploration-and-preprocessing-rendered-unnamed-chunk-47-8.png" width="576" style="display: block; margin: auto;" class="figure">
That seems to hold up. We could run some statistical tests to figure out
for sure, but let’s move on.</p>
</section><section><h2 class="section-heading" id="use-ordinalencoder-for-features-that-have-an-implicit-order">Use <code>OrdinalEncoder()</code> for features that have an implicit
order<a class="anchor" aria-label="anchor" href="#use-ordinalencoder-for-features-that-have-an-implicit-order"></a>
</h2>
<hr class="half-width">
<p>Our next question was: - Does salary go up with age, years of
experience, and education level?</p>
<p>Salary is a numeric variable, but age, years of experience, and
education level are all categorical variables with an implicit order. We
can use the <code>OrdinalEncoder</code> from scikit-learn to convert
these into numeric values that we can use in our analysis.</p>
<p>OrdinalEncoder is slightly more complicated than the LabelEncoder we
saw on Day 1. We want to specify the order of our categories to respect
the underlying order, so we have to manually define the categories based
on what we know about the data:</p>
<div class="codewrapper sourceCode" id="cb87">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a>ordinal_cols <span class="op">=</span> [<span class="st">"Age"</span>, <span class="st">"Years of experience"</span>, <span class="st">"Years in field"</span>, <span class="st">"Highest level of education"</span>]</span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> ordinal_cols:</span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">:</span><span class="ch">\n</span><span class="sc">{</span>survey_data[col]<span class="sc">.</span>value_counts()<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Age:
Age
35-44         3400
25-34         2258
45-54         1596
55-64          709
18-24           88
65 or over      88
under 18         4
Name: count, dtype: Int64

Years of experience:
Years of experience
11-20 years         3311
21-30 years         1747
8-10 years          1222
5-7 years            761
31-40 years          593
2-4 years            334
41 years or more     119
1 year or less        56
Name: count, dtype: Int64

Years in field:
Years in field
11-20 years         2547
8-10 years          1561
5-7 years           1355
2-4 years           1130
21-30 years         1005
31-40 years          272
1 year or less       239
41 years or more      34
Name: count, dtype: Int64

Highest level of education:
Highest level of education
Bachelor's degree                     3387
Master's degree                       2912
Doctorate                              570
Professional degree (MD, JD, etc.)     447
Some college                           435
                                      ...
Did not graduate high school             1
High school dropout                      1
Canadian College Diploma                 1
CPA designation w/Bachelor Degree        1
Master's +                               1
Name: count, Length: 90, dtype: Int64</code></pre>
</div>
<ul>
<li>The categories for the two “Years…” columns are the same.</li>
<li>The Education columns accepts free text, so it has lots of rare
answers as well as the 7 default options. Let’s ignore all but the top
7</li>
</ul>
<div class="codewrapper sourceCode" id="cb89">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a>age_category <span class="op">=</span> [<span class="st">"under 18"</span>, <span class="st">"18-24"</span>, <span class="st">"25-34"</span>, <span class="st">"35-44"</span>, <span class="st">"45-54"</span>, <span class="st">"55-64"</span>, <span class="st">"65 or over"</span>]</span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a>experience_category <span class="op">=</span> [</span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a>    <span class="st">"1 year or less"</span>, </span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a>    <span class="st">"2-4 years"</span>, </span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a>    <span class="st">"5-7 years"</span>, </span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a>    <span class="st">"8-10 years"</span>, </span>
<span id="cb89-8"><a href="#cb89-8" tabindex="-1"></a>    <span class="st">"11-20 years"</span>, </span>
<span id="cb89-9"><a href="#cb89-9" tabindex="-1"></a>    <span class="st">"21-30 years"</span>, </span>
<span id="cb89-10"><a href="#cb89-10" tabindex="-1"></a>    <span class="st">"31-40 years"</span>, </span>
<span id="cb89-11"><a href="#cb89-11" tabindex="-1"></a>    <span class="st">"41 years or more"</span>,</span>
<span id="cb89-12"><a href="#cb89-12" tabindex="-1"></a>]</span>
<span id="cb89-13"><a href="#cb89-13" tabindex="-1"></a></span>
<span id="cb89-14"><a href="#cb89-14" tabindex="-1"></a>education_category <span class="op">=</span> [</span>
<span id="cb89-15"><a href="#cb89-15" tabindex="-1"></a>    <span class="st">"Less than secondary"</span>,</span>
<span id="cb89-16"><a href="#cb89-16" tabindex="-1"></a>    <span class="st">"High school / secondary"</span>,</span>
<span id="cb89-17"><a href="#cb89-17" tabindex="-1"></a>    <span class="st">"Some college"</span>,</span>
<span id="cb89-18"><a href="#cb89-18" tabindex="-1"></a>    <span class="st">"Bachelor's degree"</span>,</span>
<span id="cb89-19"><a href="#cb89-19" tabindex="-1"></a>    <span class="st">"Master's degree"</span>,</span>
<span id="cb89-20"><a href="#cb89-20" tabindex="-1"></a>    <span class="st">"Professional degree (JD, MD, etc.)"</span>,</span>
<span id="cb89-21"><a href="#cb89-21" tabindex="-1"></a>    <span class="st">"Doctorate"</span>,</span>
<span id="cb89-22"><a href="#cb89-22" tabindex="-1"></a>]</span></code></pre>
</div>
<p>We can then create an OrdinalEncoder with these categories:</p>
<div class="codewrapper sourceCode" id="cb90">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OrdinalEncoder</span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a>ordinal_encoder <span class="op">=</span> OrdinalEncoder(categories<span class="op">=</span>[age_category, experience_category, experience_category, education_category])</span></code></pre>
</div>
<p>Now we can use this encoder to transform the ordinal columns in our
DataFrame. We’ll apply it to the columns <code>age</code>,
<code>years_experience</code>, and
<code>highest_level_of_education</code>, and save this data in a new
dataframe. We’ll also add the numeric data columns. And let’s not forget
to ignore the rows that contain the less common education answers!</p>
<div class="codewrapper sourceCode" id="cb91">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a>ordinal_cols <span class="op">=</span> [<span class="st">"Age"</span>, <span class="st">"Years of experience"</span>, <span class="st">"Years in field"</span>, <span class="st">"Highest level of education"</span>]</span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a>survey_data_standard_education <span class="op">=</span> survey_data[survey_data[<span class="st">"Highest level of education"</span>].isin(education_category)]</span>
<span id="cb91-4"><a href="#cb91-4" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" tabindex="-1"></a>survey_data_encoded <span class="op">=</span> survey_data_standard_education[[<span class="st">"Annual salary GBP"</span>, <span class="st">"Additional monetary compensation GBP"</span>, <span class="st">"Total GBP"</span>]].copy()</span>
<span id="cb91-6"><a href="#cb91-6" tabindex="-1"></a>survey_data_encoded[ordinal_cols] <span class="op">=</span> ordinal_encoder.fit_transform(survey_data_standard_education[ordinal_cols])</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="calculate-correlations-with-dataframe-corr">Calculate correlations with <code>DataFrame.corr()</code>
<a class="anchor" aria-label="anchor" href="#calculate-correlations-with-dataframe-corr"></a>
</h2>
<hr class="half-width">
<p>Let’s calculate the correlations and see the relationships between
these variables. We can calculate the correlation matrix with
<code>corr()</code>, and visualise the results in a heatmap with
<code>imshow()</code>:</p>
<div class="codewrapper sourceCode" id="cb92">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="co"># Calculate the correlation matrix</span></span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>correlation_matrix <span class="op">=</span> survey_data_encoded.corr()</span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>), layout<span class="op">=</span><span class="st">"constrained"</span>)</span>
<span id="cb92-5"><a href="#cb92-5" tabindex="-1"></a>heatmap <span class="op">=</span> ax.imshow(correlation_matrix, cmap<span class="op">=</span><span class="st">'coolwarm'</span>)</span>
<span id="cb92-6"><a href="#cb92-6" tabindex="-1"></a></span>
<span id="cb92-7"><a href="#cb92-7" tabindex="-1"></a>ax.set_xticks(<span class="bu">range</span>(<span class="bu">len</span>(correlation_matrix.columns)))</span>
<span id="cb92-8"><a href="#cb92-8" tabindex="-1"></a>ax.set_yticks(<span class="bu">range</span>(<span class="bu">len</span>(correlation_matrix.columns)))</span>
<span id="cb92-9"><a href="#cb92-9" tabindex="-1"></a></span>
<span id="cb92-10"><a href="#cb92-10" tabindex="-1"></a>ax.set_xticklabels(correlation_matrix.columns, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb92-11"><a href="#cb92-11" tabindex="-1"></a>ax.set_yticklabels(correlation_matrix.columns)</span>
<span id="cb92-12"><a href="#cb92-12" tabindex="-1"></a></span>
<span id="cb92-13"><a href="#cb92-13" tabindex="-1"></a>fig.colorbar(heatmap, ax<span class="op">=</span>ax, orientation<span class="op">=</span><span class="st">'vertical'</span>, label<span class="op">=</span><span class="st">'Correlation Coefficient'</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;matplotlib.colorbar.Colorbar object at 0x000001D6E5859010&gt;</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb94">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a>plt.show()</span></code></pre>
</div>
<figure><img src="../fig/02-data-exploration-and-preprocessing-rendered-unnamed-chunk-52-11.png" width="960" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This shows some interesting patterns. What do you notice?</p>
<div id="accordionSpoiler2" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler2" aria-expanded="false" aria-controls="collapseSpoiler2">
  <h3 class="accordion-header" id="headingSpoiler2">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Show details </h3>
</button>
<div id="collapseSpoiler2" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler2" aria-labelledby="headingSpoiler2">
<div class="accordion-body">
<ul>
<li>The strongest correlation is between <code>Annual salary GBP</code>
and <code>Total GBP</code>
</li>
<li>
<code>Additional monetary compensation GBP</code> is correlated with
<code>Total GBP</code>, but its contribution is weaker than the
salary</li>
<li>
<code>Annual salary</code> and
<code>Additional monetary compensation GBP</code> are at best weakly
correlated with each other</li>
<li>The time fields, Age, Years of experience, and Years in field, form
a cluster</li>
<li>There appears to be no relationship between any of the time factors
and the compensation factors</li>
<li>Education level is not correlated with anything</li>
</ul>
</div>
</div>
</div>
</div>
<p>Now let’s plot the relationships between these variables.</p>
<div class="codewrapper sourceCode" id="cb95">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="co"># Use matplotlib to plot Total compensation GBP against the other columns in survey_data_encoded</span></span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>), layout<span class="op">=</span><span class="st">"constrained"</span>)</span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a></span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a></span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a><span class="kw">def</span> scatter_plot(ax, x_col, y_col, title):</span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a>    ax.scatter(survey_data_encoded[x_col], survey_data_encoded[y_col], alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb95-9"><a href="#cb95-9" tabindex="-1"></a>    ax.set_xlabel(x_col.replace(<span class="st">"_"</span>, <span class="st">" "</span>).title())</span>
<span id="cb95-10"><a href="#cb95-10" tabindex="-1"></a>    ax.set_ylabel(y_col.replace(<span class="st">"_"</span>, <span class="st">" "</span>).title())</span>
<span id="cb95-11"><a href="#cb95-11" tabindex="-1"></a>    ax.set_title(title)</span>
<span id="cb95-12"><a href="#cb95-12" tabindex="-1"></a>    </span>
<span id="cb95-13"><a href="#cb95-13" tabindex="-1"></a>scatter_plot(axs[<span class="dv">0</span>, <span class="dv">0</span>], <span class="st">"Age"</span>, <span class="st">"Total GBP"</span>, <span class="st">"Total compensation vs. Age"</span>)</span>
<span id="cb95-14"><a href="#cb95-14" tabindex="-1"></a>scatter_plot(axs[<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">"Years of experience"</span>, <span class="st">"Total GBP"</span>, <span class="st">"Total compensation vs. Years of experience"</span>)</span>
<span id="cb95-15"><a href="#cb95-15" tabindex="-1"></a>scatter_plot(axs[<span class="dv">0</span>, <span class="dv">2</span>], <span class="st">"Years in field"</span>, <span class="st">"Total GBP"</span>, <span class="st">"Total compensation vs. Years in field"</span>)</span>
<span id="cb95-16"><a href="#cb95-16" tabindex="-1"></a>scatter_plot(axs[<span class="dv">1</span>, <span class="dv">0</span>], <span class="st">"Highest level of education"</span>, <span class="st">"Total GBP"</span>, <span class="st">"Total compensation vs. Education level"</span>)</span>
<span id="cb95-17"><a href="#cb95-17" tabindex="-1"></a>scatter_plot(axs[<span class="dv">1</span>, <span class="dv">1</span>], <span class="st">"Additional monetary compensation GBP"</span>, <span class="st">"Annual salary GBP"</span>, <span class="st">"Additional compensation vs. Annual salary"</span>)</span>
<span id="cb95-18"><a href="#cb95-18" tabindex="-1"></a>scatter_plot(axs[<span class="dv">1</span>, <span class="dv">2</span>], <span class="st">"Additional monetary compensation GBP"</span>, <span class="st">"Total GBP"</span>, <span class="st">"Total compensation vs. Annual salary"</span>)</span>
<span id="cb95-19"><a href="#cb95-19" tabindex="-1"></a></span>
<span id="cb95-20"><a href="#cb95-20" tabindex="-1"></a>plt.show()</span></code></pre>
</div>
<figure><img src="../fig/02-data-exploration-and-preprocessing-rendered-unnamed-chunk-53-13.png" width="1920" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Looking again at the relationship between salary and additional
income, we can see that there is more structure than we might have
thought at first. It looks like there are two trends: people with the
highest incomes are less likely to have additional income; and as
additional income goes up, salary increases slightly. We can’t tell any
of this from the correlation alone.</p>
<div id="callout6" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>Correlations and summary statistics are useful and powerful, but they
can be misleading.</p>
<p>This is Anscombe’s quartet, a set of four datasets that have
identical mean, variance, correlation and regression, but resoundingly
varied structure.</p>
<p><img src="../fig/Anscombes_quartet_3.svg" alt="Correlation can be misleading" class="figure">{alt=‘Image of Anscombe’s quartet,
showing four datasets with the same correlation but very different
structures’} Attribution: Schutz(label using subscripts): Avenue -
Anscombe.svg, CC BY-SA 3.0, <a href="https://commons.wikimedia.org/w/index.php?curid=9838454" class="external-link uri">https://commons.wikimedia.org/w/index.php?curid=9838454</a></p>
<figure><img src="../fig/datasaurus_dozen.png" alt="Image of the Datasaurus Dozen, a set of 12 datasets with the same summary statistics but very, very different structures!" class="figure mx-auto d-block"><div class="figcaption">And this is the Datasaurus Dozen!</div>
</figure>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="use-pca-to-visualise-more-complex-structures">Use PCA to visualise more complex structures<a class="anchor" aria-label="anchor" href="#use-pca-to-visualise-more-complex-structures"></a>
</h2>
<hr class="half-width">
<p>Principal-components analysis (PCA) lets us project many variables
onto a 2-D plane while preserving as much variance as possible.</p>
<div class="codewrapper sourceCode" id="cb96">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a></span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a>features <span class="op">=</span> [</span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a>    <span class="st">"Age"</span>,</span>
<span id="cb96-6"><a href="#cb96-6" tabindex="-1"></a>    <span class="st">"Years of experience"</span>,</span>
<span id="cb96-7"><a href="#cb96-7" tabindex="-1"></a>    <span class="st">"Years in field"</span>,</span>
<span id="cb96-8"><a href="#cb96-8" tabindex="-1"></a>    <span class="st">"Highest level of education"</span>,</span>
<span id="cb96-9"><a href="#cb96-9" tabindex="-1"></a>    <span class="st">"Total GBP"</span>,</span>
<span id="cb96-10"><a href="#cb96-10" tabindex="-1"></a>]</span>
<span id="cb96-11"><a href="#cb96-11" tabindex="-1"></a></span>
<span id="cb96-12"><a href="#cb96-12" tabindex="-1"></a>X <span class="op">=</span> survey_data_encoded[features]</span>
<span id="cb96-13"><a href="#cb96-13" tabindex="-1"></a>X_scaled <span class="op">=</span> StandardScaler().fit_transform(X)</span>
<span id="cb96-14"><a href="#cb96-14" tabindex="-1"></a></span>
<span id="cb96-15"><a href="#cb96-15" tabindex="-1"></a><span class="co"># PCA</span></span>
<span id="cb96-16"><a href="#cb96-16" tabindex="-1"></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb96-17"><a href="#cb96-17" tabindex="-1"></a>components <span class="op">=</span> pca.fit_transform(X_scaled)</span>
<span id="cb96-18"><a href="#cb96-18" tabindex="-1"></a></span>
<span id="cb96-19"><a href="#cb96-19" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb96-20"><a href="#cb96-20" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">5</span>))</span>
<span id="cb96-21"><a href="#cb96-21" tabindex="-1"></a>scatter <span class="op">=</span> plt.scatter(</span>
<span id="cb96-22"><a href="#cb96-22" tabindex="-1"></a>    components[:,<span class="dv">0</span>], components[:,<span class="dv">1</span>],</span>
<span id="cb96-23"><a href="#cb96-23" tabindex="-1"></a>    c<span class="op">=</span>survey_data_encoded[<span class="st">"Total GBP"</span>], cmap<span class="op">=</span><span class="st">"viridis"</span>, alpha<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb96-24"><a href="#cb96-24" tabindex="-1"></a>)</span>
<span id="cb96-25"><a href="#cb96-25" tabindex="-1"></a>plt.colorbar(scatter, label<span class="op">=</span><span class="st">"Compensation (GBP)"</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;matplotlib.colorbar.Colorbar object at 0x000001D6FDFAE450&gt;</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb98">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>plt.xlabel(<span class="st">"PC 1 ("</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">round</span>(pca.explained_variance_ratio_[<span class="dv">0</span>]<span class="op">*</span><span class="dv">100</span>,<span class="dv">1</span>)) <span class="op">+</span> <span class="st">"% var)"</span>)</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>plt.ylabel(<span class="st">"PC 2 ("</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">round</span>(pca.explained_variance_ratio_[<span class="dv">1</span>]<span class="op">*</span><span class="dv">100</span>,<span class="dv">1</span>)) <span class="op">+</span> <span class="st">"% var)"</span>)</span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a>plt.title(<span class="st">"PCA of salary &amp; ordinal variables"</span>)</span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a>plt.show()</span></code></pre>
</div>
<figure><img src="../fig/02-data-exploration-and-preprocessing-rendered-unnamed-chunk-54-15.png" width="576" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This plot shows the first two principal components of the data, with
points coloured by total compensation. The axes represent the directions
of maximum variance in the data.</p>
<p>We can try to understand what those directions are like this:</p>
<div class="codewrapper sourceCode" id="cb99">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a>pca.components_</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>array([[ 0.55808865,  0.58493097,  0.54763911,  0.02735323,  0.21385984],
       [-0.10224567, -0.14076186, -0.00198261,  0.8150497 ,  0.55264997]])</code></pre>
</div>
<p>The first component consists mostly of the time-based factors. The
second component contains stronger contributions from education and
total compensation.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Pandas is a powerful library for data manipulation and
analysis.</li>
<li>DataFrames are two-dimensional, labelled data containers that can
contain mixed data types</li>
<li>Series are one-dimensional, labelled data containers that can only
contain a single data type</li>
<li>
<code>loc[]</code> can be used to select combinations of rows and
columns from a DataFrame</li>
<li>Use <code>loc[]</code> to access data by label, or use boolean
masking to select data based on logical conditions</li>
<li>Use <code>astype()</code> to change the data type of a column</li>
<li>Use <code>isna()</code> to find missing values, and
<code>fillna()</code> to fill them</li>
<li>Use <code>dropna()</code> to remove rows or columns with missing
values</li>
<li>Use <code>value_counts()</code> to count occurrences of categorical
variables</li>
<li>Use <code>groupby()</code> to perform calculations on groups of
data</li>
<li>Use <code>map()</code> to apply a function to every element in a
Series</li>
<li>Use <code>OrdinalEncoder()</code> to convert categorical variables
with an implicit order into numeric values</li>
<li>Use <code>corr()</code> to calculate correlations between variables
- but don’t rely on correlations alone!</li>
<li>Use PCA to visualise complex structures in high-dimensional
data</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section><div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p><a href="https://www.forbes.com/sites/gilpress/2016/03/23/data-preparation-most-time-consuming-least-enjoyable-data-science-task-survey-says/" class="external-link">Cleaning
Big Data: Most Time-Consuming, Least Enjoyable Data Science Task, Survey
Says. Forbes, 2016</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div></section><section id="aio-04-model-selection 2"><p>Content from <a href="04-model-selection%202.html">Machine learning: Model Selection</a></p>
<hr>
<p>Last updated on 2025-07-09 |

        <a href="https://github.com/RSEjas140/AAISS25_html/edit/main/episodes/04-model-selection%202.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 1000004 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is machine learning and what benefits does it present?</li>
<li>How do I select an appropriate model for my data?</li>
<li>What are the difference between supervised and unsupervised
models?</li>
<li>What are difference between traditional and deep learning machine
learning?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the background of machine learning and what it does.</li>
<li>To understand the aspects of your data to refine your model
selection.</li>
<li>To understand the difference between supervised and unsupervised
models.</li>
<li>To know the differences between traditional and deep learning
models.</li>
<li>To understand the positives and negatives to different model
approaches.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Machine learning comprises a variety of tools and methodologies
designed to uncover patterns within datasets. This lesson aims to
introduce a selection of these techniques, although there exist numerous
others beyond the scope of this session. These techniques can be broadly
categorised into two main groups: predictors and classifiers. Predictors
are employed to forecast a value or a set of values based on a given set
of inputs. For instance, they may predict the cost of an item
considering economic conditions and the price of raw materials or
forecast a country’s GDP based on its life expectancy. On the other
hand, classifiers are tasked with categorised data into distinct groups.
For example, they might discern visible characters within an image of
written text or determine whether a message is spam or legitimate.</p>
<div class="section level3">
<h3 id="general-overview">General overview<a class="anchor" aria-label="anchor" href="#general-overview"></a>
</h3>
<p>Many machine learning systems, although not all, acquire knowledge by
processing a sequence of input and output data, which they then utilize
to construct a model. The mathematical underpinnings of machine learning
are agnostic to the nature of the data, based upon whether it can be
represented numerically or categorized. Examples of such applications
include:</p>
<ul>
<li>Estimating an individual’s weight based on their height.</li>
<li>Predicting commute duration given prevailing traffic
conditions.</li>
<li>Forecasting housing prices based on stock market fluctuations.</li>
<li>Distinguishing between spam and legitimate emails.</li>
<li>Identifying whether an image contains a person or not.</li>
</ul>
<p>Typically, these models require extensive training with hundreds,
thousands, or even millions of examples before they achieve sufficient
accuracy for practical predictions or classifications. Some systems
undertake training as a one-time process, resulting in the creation of a
model. Others may continuously refine their training through real-world
system usage and human feedback known as reinforcement learning. For
instance, every time a user labels an email as spam or not spam, they
likely contribute to further training of the spam filter’s model.</p>
</div>
<div class="section level3">
<h3 id="types-of-output">Types of output<a class="anchor" aria-label="anchor" href="#types-of-output"></a>
</h3>
<p>Predictors will usually involve a continuous scale of outputs, such
as the price of something or as classifiers which will tell you which
class (or classes) are present in the data. For example, a system to
recognize handwriting numbers from an input image will need to classify
the output into one of a set of potential characters e.g. 1 to 9.</p>
</div>
<div class="section level3">
<h3 id="machine-learning-vs-artificial-intelligence">Machine learning vs Artificial Intelligence<a class="anchor" aria-label="anchor" href="#machine-learning-vs-artificial-intelligence"></a>
</h3>
<p>Artificial Intelligence encompasses systems with generalized
intelligence, theoretically capable of solving a wide array of problems.
However, AI is a broad term with varying interpretations. Machine
learning systems, on the other hand, are typically trained to address
specific problems. While they may exhibit learning behaviour, they lack
the generalized intelligence to solve any problem a human could tackle.
This usually means that a Machine Learning model trained on one domain
isn’t applicable to another without any additional training.
Additionally, these systems often require hundreds or thousands of
examples to learn and are limited to relatively straightforward
classifications. In contrast, a human-like system could learn from a
single example. Another definition of Artificial Intelligence traces
back to the 1950s and Alan Turing’s “Imitation Game.” According to this
concept, a system could be deemed intelligent if it could deceive a
human into believing they were interacting with another human when in
fact, they were conversing with a computer. Modern endeavours in this
realm are approaching the point of successfully fooling humans, yet
achieving a machine with full human-like intelligence remains a distant
prospect.</p>
<p>Some examples of Machine learning used within our daily lives
include:</p>
<ul>
<li>Image Recognition</li>
<li>Object Detection</li>
<li>Character Recognition</li>
<li>Insurance Premiums</li>
<li>Energy usage</li>
<li>Example of machine learning in research</li>
<li>Detecting water leaks in pipes.</li>
<li>Cancer detection.</li>
<li>Improving farming productivity.</li>
</ul>
<div id="reflecting-on-the-real-world." class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="reflecting-on-the-real-world." class="callout-inner">
<h3 class="callout-title">Reflecting on the real world.</h3>
<div class="callout-content">
<p>Q: What items/products that are called AI but after that definition
would you now consider to be machine learning?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>A: As we are yet to achieve general intelligence anything shown for
example on TV is actually just machine learning!!! e.g. the new smart
feature that are being incorperated into phones.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="limitations-of-machine-learning">Limitations of Machine Learning<a class="anchor" aria-label="anchor" href="#limitations-of-machine-learning"></a>
</h3>
<p>There is a common statement used in computer science, that defines
the effectiveness of machine learning methods.</p>
</div>
<div class="section level3">
<h3 id="garbage-in-garbage-out">Garbage In = Garbage Out !!!<a class="anchor" aria-label="anchor" href="#garbage-in-garbage-out"></a>
</h3>
<p>This slogan highlights the principle that if the input data provided
is of poor quality or irrelevant, the resulting output will likely be
similarly flawed. For example, if we attempt to train a machine learning
system to establish a correlation between two variables that are
fundamentally unrelated, the model may still generate a semblance of a
connection, but the output will lack meaningful significance. This is
often apparent when the model’s output appears erratic or seemingly
random.</p>
<p><img src="../fig/rubbish_in_rubbish_out.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>(credit: <a href="https://x.com/DSaience/status/1597612047889465344" class="external-link uri">https://x.com/DSaience/status/1597612047889465344</a>)</p>
</div>
<div class="section level3">
<h3 id="bias-or-lacking-training-data">Bias or lacking training data<a class="anchor" aria-label="anchor" href="#bias-or-lacking-training-data"></a>
</h3>
<p>The input data may also lack sufficient diversity to encompass all
potential scenarios. Biases present in the data collection process can
subsequently manifest in the machine learning system. For instance, if
data on crime reporting is gathered, it may skew towards wealthier areas
where incidents are more likely to be reported. Historical data might be
inadequate in terms of coverage or relevance to the specific context
being analysed. For example, imagine creating a model to transcribe
written text from historical documents. If the model is trained solely
on documents from the 1950s to 2000, it may perform well when tested on
similar samples from that era. However, testing the model on pre-1950s
material might yield poor results because handwriting styles and
language usage evolve over time.</p>
<p><img src="../fig/out_of_distrabution.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>(credit: <a href="https://www.researchgate.net/figure/n-distribution-data-gray-circle-and-out-of-distribution-data-red-circle-in-feature_fig1_349602822" class="external-link uri">https://www.researchgate.net/figure/n-distribution-data-gray-circle-and-out-of-distribution-data-red-circle-in-feature_fig1_349602822</a>)</p>
<div id="effect-of-outter-distrabution-testing." class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="effect-of-outter-distrabution-testing." class="callout-inner">
<h3 class="callout-title">Effect of outter-distrabution testing.</h3>
<div class="callout-content">
<p>Q: What do think would happen if say we trained a model on one type
of medical scan, say mammography (X-ray) and then tested our model using
ultrasound.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>A: As our model doesnt know how to detect features in ultrasound the
results would be random and unpredictable.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="extrapolation">Extrapolation<a class="anchor" aria-label="anchor" href="#extrapolation"></a>
</h3>
<p>We can only confidently forecast outcomes for data that falls within
the range of our training data. When attempting to extrapolate beyond
the scope of our training data, it’s likely that our predictions will be
inaccurate. An easy way to see this is to plot your training data based
on it features along with the sample you want to analyse. If the sample
is nowhere near your data, then you could consider this sample an
outlier.</p>
</div>
<div class="section level3">
<h3 id="over-fitting">Over fitting<a class="anchor" aria-label="anchor" href="#over-fitting"></a>
</h3>
<p>Sometimes ML algorithms become over trained to their training data
and struggle to work when presented with real data. Meaning that the
model has focused too much on certain characteristics that determine
said task, but these may not be applicable when it is used to predict on
the test set. This again results in some random predictions. Therefore,
its critical not to over train (train for too long) your model.</p>
<div id="overfiting-question." class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="overfiting-question." class="callout-inner">
<h3 class="callout-title">Overfiting question.</h3>
<div class="callout-content">
<p>Q: What do you think happens to the results of the test set if you
training your model for too long and it becomes over fitted.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>A: Typically the model will perform badly on the testing data, as
over fitting describes a model paying to much attention to
attributes/characteristics specific to the training data.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="inability-to-explain-answers">Inability to explain answers<a class="anchor" aria-label="anchor" href="#inability-to-explain-answers"></a>
</h3>
<p>Many machine learning techniques will give us an answer given some
input data even if that answer is wrong. Most are unable to explain any
kind of logic in arriving at that answer. This can make diagnosing and
even detecting problems with them difficult.</p>
<p><img src="../fig/explainability_of_ml.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>(cite: <a href="https://www.sciencedirect.com/science/article/abs/pii/S1389041723001225" class="external-link uri">https://www.sciencedirect.com/science/article/abs/pii/S1389041723001225</a>)</p>
<div id="the-issues-with-the-lack-of-explainablity" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="the-issues-with-the-lack-of-explainablity" class="callout-inner">
<h3 class="callout-title">The issues with the lack of explainablity</h3>
<div class="callout-content">
<p>Q: Say you have created a model that achieves 95% accuracy in
classification on a given task. Then you go to and expert and show them
the model, what do you think the first thing they are going to ask? What
fields do you think this lack of explainablity is a massive issue?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>A: Any medical field it becomes a massive issue, especially because
patents lives could be drectly effected.</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="ethics-and-machine-learning">Ethics and Machine Learning<a class="anchor" aria-label="anchor" href="#ethics-and-machine-learning"></a>
</h2>
<hr class="half-width">
<p>There are increasing worries about the ethics of using machine
learning. In recent year’s we’ve seen several worrying problems from
machine learning entering all kinds of aspects of daily life and the
economy:</p>
<ul>
<li>The first death from an autonomous car which failed to brake for a
pedestrian.[1]</li>
<li>Highly targeted advertising based around social media and internet
usage. [2]</li>
<li>The outcomes of elections and referendums being influenced by highly
targeted social media posts. This is compounded by the data being
obtained without the users’ consent. [3]</li>
<li>The mass deployment of facial recognition technologies. [4]</li>
<li>The possible first use of autonomous military robots planning to
kill in battle. [5]</li>
</ul>
<div class="section level3">
<h3 id="problems-with-bias">Problems with bias<a class="anchor" aria-label="anchor" href="#problems-with-bias"></a>
</h3>
<p>Machine learning systems are often presented as more impartial and
consistent ways to make decisions. For example, sentencing criminals or
deciding if somebody should be granted bail. There have been several
examples recently where machine learning systems have been shown to be
biased because the data they were trained on was already biased. This
can occur due to the training data being unrepresentative and under
representing certain groups. For example, if you were trying to
automatically screen job candidates and used a sample of people the same
company had previously decided to employ then any biases in their past
employment processes would be reflected in the machine learning.</p>
</div>
<div class="section level3">
<h3 id="problems-with-explaining-decisions">Problems with explaining decisions<a class="anchor" aria-label="anchor" href="#problems-with-explaining-decisions"></a>
</h3>
<p>Many machine learning systems (e.g. neural networks) can’t really
explain their decisions. Although the input and output are known trying
to explain why the training caused the network to behave in a certain
way can be very difficult. If a decision is questioned by a human, it’s
difficult to provide any rationale as to how a decision was arrived
at.</p>
</div>
<div class="section level3">
<h3 id="problems-with-accuracy">Problems with accuracy<a class="anchor" aria-label="anchor" href="#problems-with-accuracy"></a>
</h3>
<p>No machine learning system is ever 100% accurate. Getting into the
high 90s is usually considered good. But when we’re evaluating millions
of data items this can translate into 100s of thousands of
mis-identifications. If the implications of these incorrect decisions
are serious then it will cause major problems. For instance if it
results in somebody being imprisoned or even investigated for a crime or
maybe just being denied insurance or a credit card.</p>
</div>
<div class="section level3">
<h3 id="energy-usage">Energy Usage<a class="anchor" aria-label="anchor" href="#energy-usage"></a>
</h3>
<p>Many machine learning systems (especially deep learning) need vast
amounts of computational power which in turn can consume vast amounts of
energy. Depending on the source of that energy this might account for
significant amounts of fossil fuels being burned. It is not uncommon for
a modern GPU accelerated computer to use several kilowatts of power,
running this for one hour could easily use as much energy a typical home
would use in an entire day. This can be particularly bad when models are
constantly being retrained or when “parameter sweeps” are done to find
the best set of parameters to train with.</p>
</div>
<div class="section level3">
<h3 id="ethics-of-machine-learning-in-research">Ethics of machine learning in research<a class="anchor" aria-label="anchor" href="#ethics-of-machine-learning-in-research"></a>
</h3>
<ul>
<li>Not all research using machine learning will have major ethical
implications. Many research projects don’t directly affect the lives of
other people, but this isn’t always the case.</li>
<li>Some questions you might want to ask yourself (and which an ethics
committee might also ask you):</li>
<li>Will anything your machine learning system does decide that somehow
affects a person’s life?</li>
<li>Will anything your machine learning system does decide that somehow
affects an animal’s life?</li>
<li>Will you be using any people to create your training data? Will they
have to look at any disturbing or traumatic material during the training
process?</li>
<li>Are there any inherent biases in the dataset(s) you’re using for
training?</li>
<li>How much energy will this computation use? Are there more efficient
ways to get the same answer?</li>
</ul>
<div id="something-to-think-about." class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="something-to-think-about." class="callout-inner">
<h3 class="callout-title">Something to think about.</h3>
<div class="callout-content">
<p>Q: In groups discuss who you think is responsible if a AI/ML learning
model goes wrong?</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<p>A: There is no correct answer, this is a heavily debated topic.</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="machine-learning-pipeline">Machine learning Pipeline<a class="anchor" aria-label="anchor" href="#machine-learning-pipeline"></a>
</h2>
<hr class="half-width">
<p>Machine learning is a rapidly evolving and diverse field, making it
essential to select the most suitable methods for your specific problem.
To help guide your choice, refer to the flowchart below:</p>
<p><img src="../fig/ML_pipeline.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
</section><section><h2 class="section-heading" id="definitions">Definitions<a class="anchor" aria-label="anchor" href="#definitions"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="supervised-machine-learning">Supervised Machine Learning<a class="anchor" aria-label="anchor" href="#supervised-machine-learning"></a>
</h3>
<p><br></p>
<p><span class="math inline">\(Definition\)</span>: Supervised learning
is when the model is trained on a labelled dataset, meaning the data
includes both the inputs and the correct outputs (labels). The model
learns by comparing its predictions to the actual outcomes and adjusting
accordingly.</p>
<p><span class="math inline">\(Example\)</span>: You have a dataset with
features like hours studied, attendance, etc., and labels like
pass/fail. The model learns the relationship and can predict outcomes
for new data.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="unsupervised-machine-learning">Unsupervised Machine Learning<a class="anchor" aria-label="anchor" href="#unsupervised-machine-learning"></a>
</h3>
<p><br></p>
<p><span class="math inline">\(Definition\)</span>: Unsupervised
learning deals with unlabelled data. The model tries to find hidden
patterns, groupings, or structures within the data without being told
the “correct” answer.</p>
<p><span class="math inline">\(Example\)</span>: You have customer data
with purchase history but no predefined labels. The model can group
customers into similar segments based on their behaviour.</p>
<p>There are numerous types of machine learning, but the most common
divide is that of traditional and deep learning.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="traditional-machine-learning">Traditional Machine Learning<a class="anchor" aria-label="anchor" href="#traditional-machine-learning"></a>
</h3>
<p><br></p>
<p><span class="math inline">\(Definition\)</span>: Traditional machine
learning involves algorithms that learn patterns from data by applying
statistical methods and predefined features. It typically requires
manual feature engineering, where experts select the relevant attributes
of the data to train models like.</p>
<p><span class="math inline">\(Key Points\)</span>:</p>
<ul>
<li>Requires human effort for feature selection and extraction.</li>
<li>Performs well with structured data (tables, numerical data).</li>
<li>Simpler models, often faster to train with smaller datasets.</li>
</ul>
<p><br></p>
</div>
<div class="section level3">
<h3 id="deep-learning">Deep Learning<a class="anchor" aria-label="anchor" href="#deep-learning"></a>
</h3>
<p><br></p>
<p><span class="math inline">\(Definition\)</span>: Deep learning is a
subset of machine learning that uses artificial neural networks,
especially deep neural networks, to automatically learn complex patterns
from large datasets. It can automatically extract features from raw data
such as images, audio, or text.</p>
<p><span class="math inline">\(Key Points\)</span></p>
<ul>
<li>Uses multi-layered neural networks.</li>
<li>Excels with unstructured data (images, videos, text, audio).</li>
<li>Requires large amounts of data and computational power.</li>
<li>Capable of automatically learning relevant features.</li>
</ul>
<p><br></p>
</div>
</section><section><h2 class="section-heading" id="traditional-machine-learning-1">Traditional Machine Learning<a class="anchor" aria-label="anchor" href="#traditional-machine-learning-1"></a>
</h2>
<hr class="half-width">
<p><br></p>
<p>Traditional machine learning refers to a class of algorithms and
approaches that learn patterns from data using relatively structured,
often simpler methods compared to deep learning. These algorithms
typically require manual feature extraction and rely on mathematical
models that are easier to interpret and computationally cheaper.</p>
<p>Key Characteristics of Traditional Machine Learning:</p>
<ul>
<li>Manual Feature Engineering: Human experts define which features
(input variables) are important.</li>
<li>Structured Data: Works best on tabular or structured data (e.g.,
spreadsheets, databases).</li>
<li>Interpretable Models: Many traditional models are transparent and
explainable.</li>
<li>Less Computational Power Required: Compared to deep learning,
traditional ML usually runs faster and requires less hardware.</li>
</ul>
<p>Common Traditional Machine Learning Algorithms:</p>
<p><img src="../fig/ML_models_summary.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>Traditional machine learning is always a good starting point when
considering applying machine learning to your dataset. While these
models may not always achieve the highest accuracy, they offer the
advantage of being fully explainable. This allows you to understand how
the model is making decisions and assess whether it is analysing your
data in a way that aligns with your expectations.</p>
</section><section><h2 class="section-heading" id="unsupervised-clustering">Unsupervised (Clustering)<a class="anchor" aria-label="anchor" href="#unsupervised-clustering"></a>
</h2>
<hr class="half-width">
<p>Clustering involves the categorization of data points based on their
similarities, offering a robust method for detecting patterns within
datasets. It typically operates without the need for training,
distinguishing it as an unsupervised learning approach. This lack of
training requirement facilitates swift application.</p>
<p>Applications of Clustering:</p>
<ul>
<li>Looking for trends in data</li>
<li>Data compression, all data clustering around a point can be reduced
to just that point. For example, reducing colour depth of an image.</li>
<li>Pattern recognition</li>
</ul>
<div class="section level3">
<h3 id="example-in-k-means">Example in K-means<a class="anchor" aria-label="anchor" href="#example-in-k-means"></a>
</h3>
<p>K-means clustering algorithm is a straightforward technique aimed at
pinpointing the centroid of each cluster. It achieves this by seeking a
point that minimizes the distance between the centroid and all the
points within the cluster. While the algorithm requires a predetermined
number of clusters to identify, a common approach involves experimenting
with various cluster numbers and employing additional tests to determine
the optimal configuration.</p>
<p>Limitations of K-Means:</p>
<ul>
<li>Requires number of clusters to be known in advance</li>
<li>Struggles when clusters have irregular shapes</li>
<li>Will always produce an answer finding the required number of
clusters even if the data isn’t clustered (or clustered in that many
clusters).</li>
<li>Requires linear cluster boundaries</li>
</ul>
<p>Advantages of K-Means:</p>
<ul>
<li>Simple algorithm, fast to compute. A good choice as the first thing
to try when attempting to cluster data.</li>
<li>Suitable for large datasets due to its low memory and computing
requirements.</li>
</ul>
</div>
<div class="section level3">
<h3 id="algorithm">Algorithm<a class="anchor" aria-label="anchor" href="#algorithm"></a>
</h3>
<p><img src="../fig/k_means_summary.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>iris dataset <a href="https://drive.google.com/file/d/14hZdSJbOwBS6GdZvjcQf3qW9ueeVuBFW/view?usp=sharing" class="external-link uri">https://drive.google.com/file/d/14hZdSJbOwBS6GdZvjcQf3qW9ueeVuBFW/view?usp=sharing</a></p>
</div>
<div class="section level3">
<h3 id="coded-example">Coded example<a class="anchor" aria-label="anchor" href="#coded-example"></a>
</h3>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>iris_df <span class="op">=</span> pd.read_csv(<span class="st">"iris.csv"</span>) <span class="co">### make sure youhave the right path</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="bu">print</span>(iris_df.head()) </span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>sp <span class="op">=</span> iris_df.drop_duplicates(subset<span class="op">=</span>[<span class="st">'variety'</span>])</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>sp <span class="op">=</span> <span class="bu">list</span>(sp[<span class="st">'variety'</span>]) </span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="bu">print</span>(iris_df.head()) </span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="cf">for</span> opt <span class="kw">in</span> sp: </span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>      subset_df <span class="op">=</span> iris_df[iris_df[<span class="st">'variety'</span>] <span class="op">==</span> opt ]</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>      plt.scatter(subset_df[<span class="st">'petal.length'</span>], subset_df[<span class="st">'petal.width'</span>],label <span class="op">=</span>opt)</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>      plt.xlabel(<span class="st">'petal length (cm)'</span>) </span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>      plt.ylabel(<span class="st">'petal width (cm)'</span>)</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>      plt.title(<span class="st">'petal length vs petal width'</span>) </span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>      plt.legend() </span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>      <span class="co">#plt.close()</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans </span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>kmeans <span class="op">=</span> KMeans(n_clusters<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>random_state<span class="op">=</span><span class="dv">0</span>, n_init<span class="op">=</span><span class="st">"auto"</span>).fit(iris_df.iloc[:,<span class="dv">2</span>:<span class="dv">4</span>])</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="bu">print</span>(kmeans.cluster_centers_) </span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a><span class="bu">print</span>(kmeans.labels_)</span></code></pre>
</div>
<p><img src="../fig/iris_dataset.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>As observed, the “setosa” species appears to cluster more distinctly,
while there is some overlap or noise between “versicolor” and
“virginica,” despite their apparent similarity. Now, let’s execute the
model. Since the kmeans function is included in the base package of R,
there’s no need to install any additional packages. When using the
kmeans function, it’s essential to specify the “centers” parameter,
which represents the number of clusters we intend to create. In this
scenario, we know that the appropriate value is 3. Let’s proceed by
setting it accordingly. Now lets try and cluster all the features</p>
</div>
<div class="section level3">
<h3 id="plotting-the-prediction">Plotting the prediction<a class="anchor" aria-label="anchor" href="#plotting-the-prediction"></a>
</h3>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>iris_df[<span class="st">"Kmeans_petal"</span>] <span class="op">=</span> kmeans.labels_</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>sp <span class="op">=</span> iris_df.drop_duplicates(subset<span class="op">=</span>[<span class="st">'Kmeans_petal'</span>]) </span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>sp <span class="op">=</span> <span class="bu">list</span>(sp[<span class="st">'Kmeans_petal'</span>])</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="cf">for</span> opt <span class="kw">in</span> sp: </span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>    subset_df <span class="op">=</span> iris_df[iris_df[<span class="st">'Kmeans_petal'</span>] <span class="op">==</span> opt ]</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    plt.scatter(subset_df[<span class="st">'petal.length'</span>], subset_df[<span class="st">'petal.width'</span>], label <span class="op">=</span>opt)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>    plt.xlabel(<span class="st">'Petal Length (cm)'</span>) </span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    plt.ylabel(<span class="st">'Petal Width (cm)'</span>)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>    plt.title(<span class="st">'Petal Length vs Petal Width'</span>) </span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>    plt.legend() </span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>    <span class="co">#plt.show() </span></span></code></pre>
</div>
<p><img src="../fig/kmeans_clustering.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
</div>
</section><section><h2 class="section-heading" id="supervised">Supervised<a class="anchor" aria-label="anchor" href="#supervised"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="classification">Classification<a class="anchor" aria-label="anchor" href="#classification"></a>
</h3>
<p>Supervised classification is a machine learning approach where a
model is trained to assign data to specific, predefined categories or
labels based on example data. The term ‘supervised’ refers to the fact
that the model learns from a labeled dataset, where each example is
already associated with a known outcome or class. Typically, supervised
classification models rely on either manually crafted rules or
algorithms that are generally straightforward to interpret and
explain.</p>
</div>
<div class="section level3">
<h3 id="how-it-works">How it Works<a class="anchor" aria-label="anchor" href="#how-it-works"></a>
</h3>
<p>Training Phase:</p>
<ul>
<li>You provide the model with a dataset containing input features
(e.g., measurements, text, images) and the correct labels or
categories.</li>
<li>The model learns the patterns and relationships between the inputs
and their corresponding labels.</li>
</ul>
<p>Testing/Prediction Phase:</p>
<ul>
<li>Once trained, the model is given new, unseen data without
labels.</li>
<li>It predicts the most likely category for each new data point based
on what it learned.</li>
</ul>
</div>
<div class="section level3">
<h3 id="example-knn">Example: KNN<a class="anchor" aria-label="anchor" href="#example-knn"></a>
</h3>
<p>The k-nearest Neighbors algorithm, commonly referred to as KNN or
k-NN, is a supervised learning classifier that falls under the
non-parametric category. It leverages proximity to classify or predict
the grouping of a specific data point. Although it can tackle both
regression and classification tasks, it is predominantly employed as a
classification tool. The underlying principle assumes that similar data
points tend to cluster together. In classification scenarios, the
algorithm assigns a class label through a majority vote mechanism. In
other words, the label that appears most frequently among neighboring
data points is adopted. While technically termed “plurality voting,” it
is often referred to as “majority vote” in literature. The distinction
lies in the requirement for a true majority (over 50%), which suits
binary classification situations. In cases involving multiple classes
(e.g., four categories), a conclusive decision regarding a class label
can be made with a threshold vote exceeding 25%.</p>
<p>Before we train any non-linear machine learning models, we need to
divide our data into train and test sets. To do this we use a library
called scikit learn. Furthermore, traditionally machine learning models
only accept inputs which are between zero and one. so we will also need
to scale our data.</p>
<p>How it works (Euclidean Distance)</p>
<p><img src="../fig/knn_pipeline.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p><span class="math inline">\(d=\sqrt{(x_2 - x_1)^2 + (y_2 -
y_1)^2}\)</span></p>
<p>where:</p>
<ul>
<li>point 1 is <span class="math inline">\((x_1, y_1)\)</span>
</li>
<li>point 2 is <span class="math inline">\((x_2, y_2)\)</span>
</li>
</ul>
<p>Strengths:</p>
<ul>
<li>Simple to implement and understand</li>
<li>Non-parametric (no assumptions about data distribution)</li>
<li>Works well with small datasets</li>
</ul>
<p>Limitations:</p>
<ul>
<li>Slow with large datasets (since it computes distances to all
points)</li>
<li>Sensitive to irrelevant features and feature scaling</li>
<li>Choosing the right K can be tricky (too small = noisy; too big = too
generalized)</li>
</ul>
</div>
<div class="section level3">
<h3 id="worked-example">Worked example<a class="anchor" aria-label="anchor" href="#worked-example"></a>
</h3>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt </span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> neighbors </span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>iris_df <span class="op">=</span> pd.read_csv(<span class="st">"iris.csv"</span>) </span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>iris_df[<span class="st">'labels'</span>] <span class="op">=</span> iris_df.variety.astype(<span class="st">'category'</span>).cat.codes </span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>X, y <span class="op">=</span> iris_df.iloc[:, :<span class="dv">4</span>], iris_df[<span class="st">'labels'</span>] </span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="bu">print</span>(X)</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X,y, test_size <span class="op">=</span> <span class="fl">0.25</span>, random_state <span class="op">=</span> <span class="dv">0</span>) </span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>clf <span class="op">=</span> neighbors.KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">5</span>) </span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>clf.fit(X_train, y_train)</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>result <span class="op">=</span> clf.predict(X_test) </span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>ground <span class="op">=</span> np.array(y_test) </span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="bu">print</span>(result)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[2 1 0 2 0 2 0 1 1 1 2 1 1 1 1 0 1 1 0 0 2 1 0 0 2 0 0 1 1 0 2
1 0 2 2 1 0 2] </code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="regression">Regression<a class="anchor" aria-label="anchor" href="#regression"></a>
</h2>
<hr class="half-width">
<p>Machine Learning Regression refers to a category of algorithms that
predict continuous numeric values (as opposed to classification, which
predicts discrete labels). The goal of regression is to model the
relationship between one or more input variables (features) and a
continuous output variable (target).</p>
<div class="section level3">
<h3 id="what-is-regression-in-machine-learning">What Is Regression in Machine Learning?<a class="anchor" aria-label="anchor" href="#what-is-regression-in-machine-learning"></a>
</h3>
<p>In simple terms:</p>
<ul>
<li>Input: A set of known features (e.g., square footage, age of a
house)</li>
<li>Output: A continuous value (e.g., price of the house)</li>
</ul>
<p>Linear Regression is one of the most fundamental algorithms in
traditional machine learning, primarily used for predicting a continuous
numeric value based on one or more input features.</p>
</div>
<div class="section level3">
<h3 id="what-is-linear-regression">What Is Linear Regression?<a class="anchor" aria-label="anchor" href="#what-is-linear-regression"></a>
</h3>
<p>Linear regression models the relationship between a dependent
variable y and one or more independent variables x. It assumes that this
relationship can be approximated with a straight line (in 2D) or a
hyperplane (in higher dimensions).</p>
</div>
<div class="section level3">
<h3 id="simple-linear-regression">Simple Linear Regression:<a class="anchor" aria-label="anchor" href="#simple-linear-regression"></a>
</h3>
<p>Predicts y from a single input variable x:</p>
<p><span class="math inline">\(y=mx+c\)</span></p>
<p>Where:</p>
<ul>
<li>y is the output (target)</li>
<li>x is the input (feature)</li>
<li>m is the slope (how much y changes per unit change in x)</li>
<li>c is the intercept (value of y when x = 0)</li>
</ul>
<p><img src="../fig/linear_regression.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>(cite: <a href="https://slideplayer.com/slide/17020575/" class="external-link uri">https://slideplayer.com/slide/17020575/</a>)</p>
</div>
<div class="section level3">
<h3 id="code-example-linear-regression">Code example: Linear regression<a class="anchor" aria-label="anchor" href="#code-example-linear-regression"></a>
</h3>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression </span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>iris_df <span class="op">=</span> pd.read_csv(<span class="st">"iris.csv"</span>) </span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split </span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>iris_df[<span class="st">'labels'</span>] <span class="op">=</span> iris_df.variety.astype(<span class="st">'category'</span>).cat.codes </span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>y<span class="op">=</span> iris_df[<span class="st">'petal.length'</span>]</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>iris_df <span class="op">=</span> iris_df.drop(labels<span class="op">=</span> <span class="st">'petal.length'</span>, axis <span class="op">=</span> <span class="dv">1</span>) </span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>iris_df <span class="op">=</span> iris_df.drop(labels <span class="op">=</span> <span class="st">'variety'</span>, axis<span class="op">=</span><span class="dv">1</span>) </span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(iris_df, y, test_size<span class="op">=</span> <span class="fl">0.33</span>, random_state<span class="op">=</span><span class="dv">101</span>) </span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>reg <span class="op">=</span> LinearRegression().fit(X_train, y_train)</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="bu">print</span>(reg.intercept_) </span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>reg.predict(X_test) </span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>pred <span class="op">=</span> reg.predict(X_test)</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>pred <span class="op">=</span> reg.predict(X_test) </span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Predicted petal length (cm):'</span>,pred[<span class="dv">0</span>]) </span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Actual petal length (cm):'</span>, <span class="fl">1.4</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Predicted petal length (cm): 1.37097289501913 Actual petal length (cm):
1.4
</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="types-of-time-series-classification">Types of time series classification<a class="anchor" aria-label="anchor" href="#types-of-time-series-classification"></a>
</h3>
<p>There are many algorithms that are designed to perform time series
classification. Depending on the data, one type might produce higher
classification accuracies than other types. This is why it’s important
to consider a range of algorithms when diving into a time series
classification problem. The use of an automated platform that would
rigorously explore the space of available algorithms and hyperparameters
might save significant time in at least the initial stages of
exploration by indicating the algorithmic pipeline that produces the
optimized accuracy for the input data set. Such platforms with time
series classification capability are expected in the near future.</p>
</div>
<div class="section level3">
<h3 id="example-distance-based-approaches">Example: Distance-based approaches<a class="anchor" aria-label="anchor" href="#example-distance-based-approaches"></a>
</h3>
<p>A distance measure is an objective score that summarizes the relative
difference between two objects in a problem domain. The smaller the
distance measure between two objects (typically data describing
something), the more similar the items are. Some types of distance
measures that are typically used in machine learning are:</p>
<ul>
<li>Euclidian distance</li>
<li>Hamming distance</li>
<li>Manhattan distance</li>
<li>Minkowski distance</li>
</ul>
<p>These distance measurements are used along with some well-known
distance-based algorithms such as k-nearest neighbors (KNN). It measures
the distance between the test object and all of the objects in the
training data set. The k shortest distances are then selected, and the
new object is assigned the class that is most represented in the k
objects from the training set. When k is set to one, the algorithm
reduces to the one-nearest neighbor, and the test object is assigned the
class of the training set sample with the shortest distance.</p>
<p>There are other kernel-based algorithms that use distance measures at
their core. Perhaps the most well-known of these algorithms is the
support vector machine (SVM). This algorithm creates a hyperplane (or
line in 2-dimensions) to separate objects into classes. The position of
the test object is then calculated with respect to the hyperplane and
the class is assigned accordingly.</p>
<p>Dynamic time warping (DTW) is a distance-based algorithm that is used
for measuring the distance between two time series. DTW does this by
calculating the distances between each point in the time series and
summing these for the overall distance. The algorithm is constructed to
deal with slight shifts between very similar time series. DTW in
conjunction with 1-NN has been the gold standard for time series
classification for the past decade and is almost always used as a
comparative algorithm in benchmarking studies.</p>
</div>
<div class="section level3">
<h3 id="code-example">Code example<a class="anchor" aria-label="anchor" href="#code-example"></a>
</h3>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="im">from</span> sktime.classification.distance_based <span class="im">import</span> KNeighborsTimeSeriesClassifier</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="im">from</span> sktime.datasets <span class="im">import</span> load_arrow_head</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co"># Load a sample time series dataset (e.g., ArrowHead)</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>X, y <span class="op">=</span> load_arrow_head(return_X_y<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="bu">print</span>(y)</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co"># Create a KNeighborsTimeSeriesClassifier instance (e.g., using DTW with 3 neighbors and distance weighting)</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>knn <span class="op">=</span> KNeighborsTimeSeriesClassifier(distance<span class="op">=</span><span class="st">"dtw"</span>, n_neighbors<span class="op">=</span><span class="dv">3</span>, weights<span class="op">=</span><span class="st">"distance"</span>)</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co"># Train the classifier</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>knn.fit(X_train, y_train)</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co"># Make predictions on the test data</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>y_pred <span class="op">=</span> knn.predict(X_test)</span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co"># Evaluate the accuracy</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy: </span><span class="sc">{</span>accuracy<span class="sc">}</span><span class="ss">"</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>['0' '1' '2' '0' '1' '2' '0' '1' '2' '0' '1' '2' '0' '1' '2' '0' '1' '2'
 '0' '1' '2' '0' '1' '2' '0' '1' '2' '0' '1' '2' '0' '1' '2' '0' '1' '2'
 '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0'
 '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0'
 '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0'
 '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '0' '1' '1' '1'
 '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1'
 '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1'
 '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '1' '2' '2' '2' '2'
 '2' '2' '2' '2' '2' '2' '2' '2' '2' '2' '2' '2' '2' '2' '2' '2' '2' '2'
 '2' '2' '2' '2' '2' '2' '2' '2' '2' '2' '2' '2' '2' '2' '2' '2' '2' '2'
 '2' '2' '2' '2' '2' '2' '2' '2' '2' '2' '2' '2' '2']
Accuracy: 0.8604651162790697</code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="deep-learning-1">Deep learning<a class="anchor" aria-label="anchor" href="#deep-learning-1"></a>
</h2>
<hr class="half-width">
<p>Neural networks, drawing inspiration from the workings of the human
brain, represent a machine learning approach adept at discerning
patterns and categorizing data, frequently leveraging images as input.
This technique, rooted in the 1950s, has evolved through successive
iterations, surmounting inherent constraints. Today, the pinnacle of
neural network advancement is often denoted as deep learning. This
method uses the concept of self-learned features which describes the
ability to automatically extract and learn relevant features from raw
data without the need for manual feature engineering.</p>
<div class="section level3">
<h3 id="perceptrons">Perceptron’s<a class="anchor" aria-label="anchor" href="#perceptrons"></a>
</h3>
<p>Perceptron’s serve as the foundational units within neural networks,
mirroring the functionality of individual neurons in the brain.
Typically equipped with one or more inputs and a solitary output, they
operate by weighting each input and aggregating these weighted values.
Subsequently, the summed result undergoes evaluation by an activation
function, determining whether the neuron emits a signal. While some
activation functions employ a straightforward threshold step mechanism,
delineating between zero and one based on input magnitude, alternative
designs may utilize different functions. Nevertheless, these functions
commonly yield outputs ranging from zero to one and retain a stepwise
characteristic.</p>
</div>
<div class="section level3">
<h3 id="construction-of-a-perceptron-model">Construction of a perceptron model<a class="anchor" aria-label="anchor" href="#construction-of-a-perceptron-model"></a>
</h3>
<p>The function requires three parameters: Inputs, a list of input
values; Weights, a list of weight values; and Threshold, denoting the
activation threshold. Initially, we perform element-wise multiplication
of each input with its corresponding weight. Subsequently, the total sum
of these products is computed. If this sum falls below the activation
threshold, the output is zero; otherwise, it is one.</p>
<p><img src="../fig/MLP.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>(cite:<a href="https://muneebsa.medium.com/deep-learning-101-lesson-7-perceptron-f6a698d81be8" class="external-link uri">https://muneebsa.medium.com/deep-learning-101-lesson-7-perceptron-f6a698d81be8</a>)</p>
</div>
<div class="section level3">
<h3 id="perceptron-limitations">Perceptron limitations<a class="anchor" aria-label="anchor" href="#perceptron-limitations"></a>
</h3>
<p>A solitary perceptron is incapable of resolving any function that
lacks linear separability, necessitating the ability to partition input
and output classes with a straight line. An illustrative instance is the
XOR function below:</p>
<p><img src="../fig/MLP_output.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>which yields zero output when all inputs are either one or zero,
defying straightforward linear separation. This inadequacy, termed
linear separability, was recognized in the 1960s, leading to a
stagnation in neural network advancement for over a decade, often
referred to as the “AI Winter.”</p>
</div>
<div class="section level3">
<h3 id="multi-layer-perceptrons">Multi-layer Perceptrons<a class="anchor" aria-label="anchor" href="#multi-layer-perceptrons"></a>
</h3>
<p>A single perceptron lacks the capability to address functions that
lack linear separability. To tackle such nonlinear challenges, we rely
on multiple perceptrons, often organized into several layers. These
layers constitute networks of artificial neurons, each capable of
processing one or more inputs and producing a single output. The neurons
interconnect within expansive networks, commonly comprising tens to
thousands of units. Typically, these networks are structured in layers,
encompassing an input layer, one or more hidden layers, and ultimately,
an output layer.</p>
</div>
<div class="section level3">
<h3 id="training-multi-layer-perceptrons">Training Multi-layer perceptron’s<a class="anchor" aria-label="anchor" href="#training-multi-layer-perceptrons"></a>
</h3>
<p>Multi-layer perceptron’s need to be trained by showing them a set of
training data and measuring the error between the network’s predicted
output and the true value. Training takes an iterative approach that
improves the network a little each time a new training example is
presented. There are several training algorithms available for a neural
network today, but we are going to use one of the best established and
well known, the backpropagation algorithm. The algorithm is called back
propagation because it takes the error calculated between an output of
the network and the true value and takes it back through the network to
update the weights. If you want to read more about back propagation,
please see this chapter from the book “Neural Networks - A Systematic
Introduction”.</p>
<p><img src="../fig/Multilayer_mlp.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>(cite:<a href="https://machinelearninggeek.com/multi-layer-perceptron-neural-network-using-python/" class="external-link uri">https://machinelearninggeek.com/multi-layer-perceptron-neural-network-using-python/</a>)</p>
</div>
<div class="section level3">
<h3 id="what-is-an-activation-layer">What is an Activation Layer?<a class="anchor" aria-label="anchor" href="#what-is-an-activation-layer"></a>
</h3>
<p>An activation layer, often referred to as an activation function, is
a crucial component in neural networks that determines whether a neuron
should be “activated” or not. It introduces non-linearity into the
network, enabling it to learn complex patterns and relationships in the
data.</p>
</div>
<div class="section level3">
<h3 id="why-is-it-important">Why is it Important?<a class="anchor" aria-label="anchor" href="#why-is-it-important"></a>
</h3>
<p>Without activation layers, a neural network would essentially behave
like a simple linear model, no matter how many layers it has. Non-linear
activation functions allow the network to model complex, real-world
relationships, such as recognizing objects in images, understanding
speech, or making predictions based on complicated data.</p>
<p>How it Works:</p>
<ul>
<li>After each layer of computations (e.g., weighted sums), the
activation function transforms the output.</li>
<li>This transformed output is then passed to the next layer or used as
the final prediction.</li>
</ul>
<p><img src="../fig/activation_functions.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>(cite:<a href="https://www.v7labs.com/blog/neural-networks-activation-functions" class="external-link uri">https://www.v7labs.com/blog/neural-networks-activation-functions</a>)</p>
</div>
<div class="section level3">
<h3 id="use-cases">Use cases<a class="anchor" aria-label="anchor" href="#use-cases"></a>
</h3>
<p>Multi-layer perceptrons offer the flexibility to function as either a
regressor or a classifier by simply changing the activation function
applied to the output layer (along with the objective function, which
we’ll cover later). For instance, if you want your model to perform
classification, you would typically use an activation function like
SoftMax, which converts the outputs into probabilities that sum to one
across all classes. On the other hand, for regression tasks where you
want to estimate continuous values, you would usually apply a linear
activation function to the output layer.</p>
</div>
<div class="section level3">
<h3 id="code-example-classification">Code example classification:<a class="anchor" aria-label="anchor" href="#code-example-classification"></a>
</h3>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="im">from</span> sklearn.neural_network</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="im">import</span> MLPClassifier <span class="im">from</span> sklearn.model_selection</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="im">import</span> train_test_split</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>iris_df <span class="op">=</span> pd.read_csv(<span class="st">"iris.csv"</span>)</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>iris_df[<span class="st">'labels'</span>] <span class="op">=</span> iris_df.variety.astype(<span class="st">'category'</span>).cat.codes</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>X, y <span class="op">=</span> iris_df.iloc[:, :<span class="dv">4</span>], iris_df[<span class="st">'labels'</span>] </span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size <span class="op">=</span> <span class="fl">0.25</span>, random_state <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="bu">print</span>(X_train.shape, y_train.shape)</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>clf <span class="op">=</span> MLPClassifier(solver<span class="op">=</span><span class="st">'lbfgs'</span>, random_state<span class="op">=</span><span class="dv">1</span>, max_iter<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>clf.fit(X, y) result <span class="op">=</span> clf.predict(X_test)</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>ground <span class="op">=</span> np.array(y_test)</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="bu">print</span>(result, ground)</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>clf.score(X_test, y_test)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
[2 1 0 2 0 2 0 1 1 1 2 1 1 1 1 0 1 1 0 0 2 1 0 0 2 0 0 1 1 0 2 1 0 2 2 1
02]

[2 1 0 2 0 2 0 1 1 1 2 1 1 1 1 0 1 1 0 0 2 1 0 0 2 0 0 1 1 0 2 1 0 2 2 1
01]

Out[19]: 0.9736842105263158</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="code-example-regression">Code example: regression<a class="anchor" aria-label="anchor" href="#code-example-regression"></a>
</h3>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="im">from</span> sklearn.neural_network <span class="im">import</span> MLPRegressor</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>iris_df <span class="op">=</span> pd.read_csv(<span class="st">"iris.csv"</span>)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>X, y <span class="op">=</span> iris_df.iloc[:, :<span class="dv">3</span>], iris_df[<span class="st">"petal.width"</span>]</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size <span class="op">=</span> <span class="fl">0.25</span>, random_state <span class="op">=</span> <span class="dv">0</span>) <span class="bu">print</span>(X_train.shape, y_train.shape)</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>clf <span class="op">=</span> MLPRegressor(solver<span class="op">=</span><span class="st">'lbfgs'</span>, random_state<span class="op">=</span><span class="dv">1</span>, max_iter<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>clf.fit(X, y)</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>result <span class="op">=</span> clf.predict(X_test)</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>ground <span class="op">=</span> np.array(y_test)</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="bu">print</span>(result, ground)</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>clf.score(X_test, y_test) </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
(112, 3) (112,) [1.88532522 1.14165756 0.27955749 2.06547563 0.24919028
2.28388127 0.2155882 1.51092191 1.53244915 1.19834217 1.86483485
1.45142482 1.6306123 1.4613069 1.63934615 0.23025832 1.51957326
1.54290422 0.20987057 0.24845432 1.85473185 1.6255684 0.39085837
0.18676907 1.67834109 0.14667113 0.40639156 1.34237052 0.91551074
0.27895251 2.07143315 1.67419905 0.26318909 1.79216822 1.94143883
1.2643635 0.33543957 1.81911754]
/home/corcor27/anaconda3/envs/tensorflow-gpu2/lib/python3.9/site-packages/sklearn/neural_network/\_multilayer_perceptron.py:546:
ConvergenceWarning: lbfgs failed to converge (status=1): STOP: TOTAL NO.
of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown
in: &lt;https://scikit-learn.org/stable/modules/preprocessing.html&gt;
self.n_iter\_ = \_check_optimize_result("lbfgs", opt_res, self.max_iter)

Out[14]: 0.9227530392362144</code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="convolutional-neural-network">Convolutional Neural Network<a class="anchor" aria-label="anchor" href="#convolutional-neural-network"></a>
</h2>
<hr class="half-width">
<p>A Convolutional Neural Network (CNN) is a specialized type of neural
network designed to process grid-like data, such as images. CNNs are the
foundation of computer vision tasks like image classification, object
detection, and facial recognition. A CNN is a deep learning model that
uses convolutional layers to automatically extract spatial features from
input data, especially images, and uses those features for tasks like
classification or detection.</p>
<div class="section level3">
<h3 id="how-do-convolutional-neural-network-work">How do Convolutional Neural Network work?<a class="anchor" aria-label="anchor" href="#how-do-convolutional-neural-network-work"></a>
</h3>
<p>The core of Convolutional Neural Networks (CNNs) lies in their
convolutional layers, which are specifically designed to extract
features from input data most commonly images using a process called
convolution. These layers use learnable filters, or kernels, that slide
over the input, performing element-wise multiplications followed by
summation to generate feature maps. These feature maps capture important
patterns within the data, such as edges, textures, or shapes, allowing
the network to learn increasingly complex, hierarchical representations.
Typically, CNNs consist of multiple stacked convolutional layers, where
each layer processes progressively smaller regions of the input,
enabling the extraction of more abstract and high-level features as you
move deeper into the network.</p>
<p>Convolutional Layer</p>
<ul>
<li>Applies filters/kernels to the input.</li>
<li>These filters slide over the input image, performing element-wise
multiplications and summing the results (convolution operation).</li>
<li>Detects features like edges, corners, textures, etc.</li>
<li>Each filter learns to detect specific patterns during training.</li>
</ul>
</div>
<div class="section level3">
<h3 id="d-convolutions">2D-Convolutions<a class="anchor" aria-label="anchor" href="#d-convolutions"></a>
</h3>
<p>2D convolutions are commonly applied for image classification tasks.
In this process, the kernel also known as the sliding window takes the
form of an NxN matrix, where N represents the desired size of the
window. You can think of an image as a map, and the kernel functions
like a tool that highlights features within that map, such as edges,
boundaries, or specific textures. The diagram below illustrates how an
image is represented from a computer’s perspective:</p>
<p><img src="../fig/image_in_pixels.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>(cite:<a href="https://www.analytixlabs.co.in/blog/convolutional-neural-network/" class="external-link uri">https://www.analytixlabs.co.in/blog/convolutional-neural-network/</a>)</p>
<p>Then at each layer the image is multiplied by the kernel using the
process below to create the feature maps:</p>
<p><img src="../fig/how_kernals_work.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>(cite:<a href="https://www.analytixlabs.co.in/blog/convolutional-neural-network/" class="external-link uri">https://www.analytixlabs.co.in/blog/convolutional-neural-network/</a>)</p>
<p>Then below are the resulting feature maps:</p>
<p><img src="../fig/kernal_features.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>(cite:<a href="https://datahacker.rs/028-visualization-and-understanding-of-convolutional-neural-networks-in-pytorch/" class="external-link uri">https://datahacker.rs/028-visualization-and-understanding-of-convolutional-neural-networks-in-pytorch/</a>)</p>
<p>The values in the kernel are critical for the model to understand
different structures in images and that will eventually be used to form
a decision. When the model is initialised these kernel values are
randomly generated and only through training do they get refined such
that they identify different structures based upon the objective
function using Backpropagation.</p>
</div>
<div class="section level3">
<h3 id="backpropagation">Backpropagation<a class="anchor" aria-label="anchor" href="#backpropagation"></a>
</h3>
<p>Backpropagation is a fundamental algorithm used to train neural
networks. It works by calculating how much each weight in the network
contributes to the overall error (difference between the predicted
output and the actual output) and then adjusting those weights to reduce
the error.</p>
<p>In simple terms:</p>
<ul>
<li>Forward Pass: The input data moves through the network, producing an
output.</li>
<li>Error Calculation: The difference between the predicted output and
the actual target is measured using a loss function.</li>
<li>Backward Pass (Backpropagation):</li>
<li>The algorithm calculates the gradient (rate of change) of the loss
with respect to each weight in the network using the chain rule of
calculus.</li>
<li>Gradients indicate how to adjust each weight to reduce the
error.</li>
<li>Weight Update: Weights are updated using an optimization algorithm
like Gradient Descent, moving in the direction that minimizes the
loss.</li>
</ul>
<p>Example Analogy:</p>
<p>Imagine trying to get a dart to hit the bullseye. Each throw
(prediction) shows how far off you are (error), and based on that, you
adjust your aim (update weights) to get closer to the target over
time.</p>
</div>
</section><section><h2 class="section-heading" id="time-series-data-with-1-d-convolutions">Time series data with 1-D convolutions<a class="anchor" aria-label="anchor" href="#time-series-data-with-1-d-convolutions"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="what-are-1d-convolutions">What Are 1D Convolutions?<a class="anchor" aria-label="anchor" href="#what-are-1d-convolutions"></a>
</h3>
<p>1D Convolutions are typically used when working with sequential data
like time series, audio signals, or any data arranged in a
one-dimensional sequence.</p>
<p>In this approach, a small filter or “kernel” slides along the
sequence (one dimension) and extracts patterns or features, like how 2D
convolutions scan over images.</p>
<p>How It Works:</p>
<ul>
<li>The input is a 1D array (or sequence) of values for example, stock
prices over time or audio waveforms.</li>
<li>A kernel of size N moves along the sequence, step by step (called
the stride).</li>
<li>At each position, the kernel performs a weighted sum (dot product)
of the values under the window.</li>
<li>This produces an output feature map that highlights important
patterns, like peaks, trends, or repeating signals.</li>
</ul>
<p>Example Analogy:</p>
<p>Imagine you’re reading a long string of text, and you slide a small
window over 3 words at a time to spot specific phrases. Similarly, a 1D
convolution slides over a sequence to detect relevant features.</p>
<p><img src="../fig/1D_convolution.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>(cite:<a href="https://www.sciencedirect.com/science/article/abs/pii/S0167404822001432" class="external-link uri">https://www.sciencedirect.com/science/article/abs/pii/S0167404822001432</a>)</p>
<p>The challenge with training these models is that they require several
components, such as an optimizer, loss function, and learning rate,
among others. As a result, there is no code example provided in this
section, since we first need to explore these various elements before we
can proceed with training the models.</p>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-05-training"><p>Content from <a href="05-training.html">Machine learning: model training</a></p>
<hr>
<p>Last updated on 2025-07-09 |

        <a href="https://github.com/RSEjas140/AAISS25_html/edit/main/episodes/05-training.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 46 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is required to train a machine learning model?</li>
<li>How do I deal with bias in my dataset?</li>
<li>How do I know if my model is training correctly?</li>
<li>What are hyper parameters?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>To learn all the aspect required to train a machine learning
model.</li>
<li>To use dataset configurations to deal with dataset bias.</li>
<li>Learn about cross-validation training.</li>
<li>To understand all the different hyper parameters and how to decided
what configurations to select.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="training-machine-learning-models">Training Machine learning models<a class="anchor" aria-label="anchor" href="#training-machine-learning-models"></a>
</h2>
<hr class="half-width">
<p>Training a machine learning model is often considered the most
difficult part for several reasons, many of which go beyond just running
code. So far, we have covered the following:</p>
<p><br><br></p>
<div class="section level3">
<h3 id="data-quality-preparation-the-biggest-bottleneck">Data Quality &amp; Preparation (The Biggest Bottleneck)<a class="anchor" aria-label="anchor" href="#data-quality-preparation-the-biggest-bottleneck"></a>
</h3>
<ul>
<li><p>Garbage In, Garbage Out: No matter how advanced your model, if
the data is incomplete, noisy, biased, or inconsistent, the model will
perform poorly.</p></li>
<li><p>Data Cleaning: Real-world data is messy. Handling missing values,
duplicates, incorrect labels, or outliers is tedious and
time-consuming.</p></li>
<li><p>Feature Engineering: Identifying which aspects of the data are
relevant requires domain expertise and creativity. It’s often more
impactful than tweaking algorithms.</p></li>
</ul>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="selecting-the-right-model">Selecting the Right Model<a class="anchor" aria-label="anchor" href="#selecting-the-right-model"></a>
</h3>
<ul>
<li>There’s no one-size-fits-all model. Choosing between decision trees,
neural networks, support vector machines, etc.</li>
<li>Understanding the benefit of certain model types compared to
others.</li>
</ul>
<p><br><br></p>
<div id="lets-look-at-the-distrabution" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="lets-look-at-the-distrabution" class="callout-inner">
<h3 class="callout-title">Lets look at the distrabution</h3>
<div class="callout-content">
<p>Q: Which type of model are you going to focus on
(supervised/unsupervised)</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>A: results on board</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p>Now in this section we are going to cover the actual process of
training with more complex machine learning methods like deep learning
and what aspects to pay attention to too. These include:</p>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="dataset-configuration">Dataset configuration<a class="anchor" aria-label="anchor" href="#dataset-configuration"></a>
</h3>
<ul>
<li><p>Evaluate the level of bias in your dataset (sampling methods, or
class wieghts).</p></li>
<li><p>Constructing a reproducible training method (cross
validation).</p></li>
</ul>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="loss-functions-and-curves">Loss functions and curves<a class="anchor" aria-label="anchor" href="#loss-functions-and-curves"></a>
</h3>
<ul>
<li>Striking the balance between over fitting and underfitting, which
requires constant testing, validation, and sometimes redesigning the
model or features.</li>
</ul>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="hyperparameter-tuning">Hyperparameter Tuning<a class="anchor" aria-label="anchor" href="#hyperparameter-tuning"></a>
</h3>
<ul>
<li>Most models have hyperparameters (e.g., learning rate, number of
layers) that significantly affect performance.</li>
<li>How to find the most optimal configuration (Trial and error, Grid
search)</li>
<li>This can be computationally expensive and time-consuming. <br><br>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="compute-resources-scalability">Compute Resources &amp; Scalability<a class="anchor" aria-label="anchor" href="#compute-resources-scalability"></a>
</h3>
<ul>
<li>Especially with deep learning or large datasets, training requires
powerful GPUs/TPUs, distributed computing, or cloud resources.</li>
<li>Managing these resources efficiently adds another layer of
complexity.</li>
</ul>
<p><br><br></p>
<p>Training is where all the complexity of creating a machine learning
model converges: technical, mathematical, computational, and
domain-specific. It’s not just about applying an algorithm; it’s about
understanding the nuances of your data, selecting the right tools,
balancing performance, and iterating continuously.</p>
<p><br></p>
<div id="hpc-resources" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="hpc-resources" class="callout-inner">
<h3 class="callout-title">HPC resources</h3>
<div class="callout-content">
<p>Q: Do you know of any HPC resources available to you? and when should
you consider using them?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>A: aberystwyth own HPC, Super computing wales. You should consider
using these when you code takes reasonable amount of time, the good
thing is these systems are scalable.</p>
</div>
</div>
</div>
</div>
<p><br><br></p>
</div>
</section><section><h2 class="section-heading" id="dataset-configuration-1">Dataset configuration<a class="anchor" aria-label="anchor" href="#dataset-configuration-1"></a>
</h2>
<hr class="half-width">
<p>The first thing we need to consider is whether there’s any bias
present in our training data. For discrete data, this could mean that
one class is significantly more represented than others. In the case of
continuous data, it might involve most data points being concentrated
within a specific range of values.</p>
<p>These types of imbalances are easy to check. For discrete data, you
can simply count the number of samples in each class. For continuous
data, plotting a histogram of your target variable will reveal any
uneven distributions.</p>
<p>You might wonder why this matters and, in some cases, it’s not a
major issue. However, for certain approaches like deep learning, models
often develop a bias toward the most common class, leading them to
predict that class most of the time, regardless of the input.</p>
<p>An analogy for this is imagining a river flowing down a mountain.
When the river meets a fork, most of the water will naturally flow down
the wider or easier path following the path of least resistance.
Similarly, if our data is imbalanced, the model tends to take the
“easiest” option by favouring the dominant class, rather than truly
learning to distinguish between different classes based on meaningful
patterns.</p>
<p>To build a more balanced and well-rounded model, we need to correct
for these imbalances. Two common strategies are:</p>
<ul>
<li>Resampling the Data — either by oversampling minority classes or
under sampling the majority class</li>
<li>Applying Class Weights — adjusting the model to penalize incorrect
predictions more heavily for underrepresented classes</li>
</ul>
<p>Both approaches aim to encourage the model to use the actual features
for prediction, rather than being influenced by biased distributions in
the training data.</p>
</section><section><h2 class="section-heading" id="sampling-methods">Sampling methods<a class="anchor" aria-label="anchor" href="#sampling-methods"></a>
</h2>
<hr class="half-width">
<p>sampling methods in machine learning, which are essential for
creating balanced, representative datasets, especially in classification
problems, imbalanced datasets, or evaluation tasks like
cross-validation.</p>
<p>Types of Sampling Methods in Machine Learning</p>
<ul>
<li>Random Sampling: Selects data points randomly from the dataset.</li>
<li>Stratified Sampling: Ensures each class is proportionally
represented in the sample.</li>
<li>Systematic Sampling: Selects every k-th data point from the
dataset.</li>
<li>Cluster Sampling: Divides the dataset into clusters and randomly
selects some clusters.</li>
<li>Reservoir Sampling: Efficient method to sample k items from a very
large or streaming dataset.</li>
<li>Over-Sampling: Increases the number of samples in the minority
class.</li>
<li>Under-Sampling: Reduces the number of samples in the majority
class.</li>
<li>Bootstrapping: Samples with replacement. Used often in ensemble
methods like bagging.</li>
<li>Cross-Validation Sampling: Splits the data into multiple folds to
validate models reliably.</li>
</ul>
<p>Each method has its own benefit and disadvantages, therefore it’s
important to do a lot of testing to work out which is the most optimal
for your data type. The most common and is usually effective no matter
what your data type is Under-Sampling. The main downside of this method
is that you are removing samples, which means that you are restricting
your model’s knowledge base. Let’s move on to our method, which doesn’t
involve removing any data.</p>
<p><img src="../fig/probability-sampling.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>(cite: <a href="https://www.scribbr.co.uk/research-methods/sampling/" class="external-link uri">https://www.scribbr.co.uk/research-methods/sampling/</a>)</p>
<div class="section level3">
<h3 id="stratified-sampling-example">Stratified Sampling example<a class="anchor" aria-label="anchor" href="#stratified-sampling-example"></a>
</h3>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> datasets</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>iris <span class="op">=</span> datasets.load_iris()</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>iris_df<span class="op">=</span>pd.DataFrame(iris.data)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>iris_df[<span class="st">'class'</span>]<span class="op">=</span>iris.target</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>iris_df.columns<span class="op">=</span>[<span class="st">'sepal_len'</span>, <span class="st">'sepal_wid'</span>, <span class="st">'petal_len'</span>, <span class="st">'petal_wid'</span>, <span class="st">'class'</span>]</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>iris_df[<span class="st">'class'</span>].value_counts()</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>y <span class="op">=</span> iris_df[<span class="st">"class"</span>]</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>X <span class="op">=</span> iris_df[iris_df.columns]</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>X_train, X_test, y_train, y_test<span class="op">=</span> train_test_split(X,y, train_size<span class="op">=</span><span class="fl">0.8</span>, random_state<span class="op">=</span><span class="va">None</span>,shuffle<span class="op">=</span><span class="va">True</span>, stratify<span class="op">=</span>y)</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Class distribution of train set"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="bu">print</span>(y_train.value_counts())</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Class distribution of test set"</span>)</span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="bu">print</span>(y_test.value_counts())</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Class distribution of train set
class
0    40
2    40
1    40
Name: count, dtype: int64

Class distribution of test set
class
1    10
2    10
0    10
Name: count, dtype: int64</code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="what-are-class-weights">What Are Class Weights?<a class="anchor" aria-label="anchor" href="#what-are-class-weights"></a>
</h2>
<hr class="half-width">
<p>Class weights are numerical values assigned to different classes
during model training to handle class imbalance, where one or more
classes are significantly underrepresented compared to others.</p>
<p>In simple terms:</p>
<ul>
<li>The model is “told” that some classes are more important or costly
to miss-classify.</li>
<li>It increases the penalty for incorrect predictions on minority
classes.</li>
<li>This prevents the model from being biased toward the dominant
class.</li>
</ul>
<div class="section level3">
<h3 id="why-use-class-weights">Why Use Class Weights?<a class="anchor" aria-label="anchor" href="#why-use-class-weights"></a>
</h3>
<p>In imbalanced datasets, if no adjustments are made:</p>
<ul>
<li>A model might predict the majority class most of the time and still
appear to perform well (e.g., 95% accuracy might just mean it’s always
predicting the dominant class).</li>
<li>Minority classes get neglected, which is a problem for tasks like
fraud detection, medical diagnosis, etc.</li>
</ul>
<p>Class weights help by:</p>
<ul>
<li>Encouraging the model to “pay more attention” to rare classes</li>
<li>Reducing bias toward the majority class</li>
<li>Improving recall and precision for minority classes</li>
</ul>
</div>
<div class="section level3">
<h3 id="how-class-weights-work-conceptually">How Class Weights Work (Conceptually)<a class="anchor" aria-label="anchor" href="#how-class-weights-work-conceptually"></a>
</h3>
<p>During training:</p>
<ul>
<li>The loss function (more on the loss function later) calculates how
wrong the model is.</li>
<li>Class weights scale the loss differently for each class:</li>
<li>Misclassifying a minority class → Higher penalty</li>
<li>Misclassifying a majority class → Lower penalty</li>
</ul>
<p>This nudges the optimization process to treat minority classes more
seriously.</p>
</div>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>Imagine a binary classification problem:</p>
<pre><code>Class 0 = 90% of data

Class 1 = 10% of data </code></pre>
<p>Without class weights:</p>
<pre><code>The model might always predict Class 0 to get high accuracy. </code></pre>
<p>With class weights:</p>
<pre><code>Assign higher weight to Class 1: </code></pre>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="im">from</span> sklearn.utils.class_weight <span class="im">import</span> compute_class_weight</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>y <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>compute_class_weight(class_weight<span class="op">=</span><span class="st">"balanced"</span>, classes<span class="op">=</span>np.unique(y), y<span class="op">=</span>y)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Out[14]: array([1.5 , 0.75])</code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="cross-validation">Cross validation<a class="anchor" aria-label="anchor" href="#cross-validation"></a>
</h2>
<hr class="half-width">
<p>Cross-validation is a technique used to evaluate the performance of a
machine learning model by splitting the data into multiple parts
(folds), training on some and validating on the rest repeatedly. This
helps ensure the model generalizes well to unseen data.</p>
<div class="section level3">
<h3 id="why-use-cross-validation">Why Use Cross-Validation?<a class="anchor" aria-label="anchor" href="#why-use-cross-validation"></a>
</h3>
<ul>
<li>Prevents overfitting to a single train/test split.</li>
<li>Gives a better estimate of model performance.</li>
<li>Works especially well with limited datasets.</li>
</ul>
</div>
<div class="section level3">
<h3 id="common-types-of-cross-validation">Common Types of Cross-Validation<a class="anchor" aria-label="anchor" href="#common-types-of-cross-validation"></a>
</h3>
<ul>
<li>K-Fold Cross-Validation: Splits data into K equal folds.</li>
<li>Stratified K-Fold: Like K-Fold but preserves class proportions in
each fold.</li>
<li>Leave-One-Out (LOO): Extreme case of K-Fold where K = N (number of
samples).</li>
<li>Repeated K-Fold: Repeats K-Fold CV multiple times with different
splits.</li>
</ul>
<p><img src="../fig/cross_validation.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>(cite: <a href="https://vitalflux.com/k-fold-cross-validation-python-example/" class="external-link uri">https://vitalflux.com/k-fold-cross-validation-python-example/</a>)</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> datasets</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> KFold</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co"># synthetic regression dataset</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>X, y <span class="op">=</span> datasets.make_regression(</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  n_samples<span class="op">=</span><span class="dv">10</span>, n_features<span class="op">=</span><span class="dv">1</span>, n_informative<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  noise<span class="op">=</span><span class="dv">0</span>, random_state<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co"># KFold split</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>kf <span class="op">=</span> KFold(n_splits<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="cf">for</span> i, (train_index, test_index) <span class="kw">in</span> <span class="bu">enumerate</span>(kf.split(X)):</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Fold </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Training dataset index: </span><span class="sc">{</span>train_index<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Test dataset index: </span><span class="sc">{</span>test_index<span class="sc">}</span><span class="ss">"</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Fold 0:
  Training dataset index: [3 4 5 6 7 8 9]
  Test dataset index: [0 1 2]
Fold 1:
  Training dataset index: [0 1 2 6 7 8 9]
  Test dataset index: [3 4 5]
Fold 2:
  Training dataset index: [0 1 2 3 4 5 8 9]
  Test dataset index: [6 7]
Fold 3:
  Training dataset index: [0 1 2 3 4 5 6 7]
  Test dataset index: [8 9]</code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="loss-function">Loss function<a class="anchor" aria-label="anchor" href="#loss-function"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="what-is-a-loss-function-in-machine-learning">What is a Loss Function in Machine Learning?<a class="anchor" aria-label="anchor" href="#what-is-a-loss-function-in-machine-learning"></a>
</h3>
<p>A loss function (also called a cost function) is a mathematical
function that measures the difference between the predicted output and
the actual target value. It tells the model how wrong it is and is
essential for the learning process and is variable tending on the type
of task the model is performing. With the goal of training is to
minimize the loss function.</p>
</div>
<div class="section level3">
<h3 id="why-is-it-important">Why Is It Important?<a class="anchor" aria-label="anchor" href="#why-is-it-important"></a>
</h3>
<ul>
<li>Guides the model during training (via optimization, e.g., gradient
descent).</li>
<li>Helps compare performance between different models.</li>
<li>Lower loss = better model (usually).</li>
</ul>
</div>
<div class="section level3">
<h3 id="common-types-of-loss-functions">Common Types of Loss Functions<a class="anchor" aria-label="anchor" href="#common-types-of-loss-functions"></a>
</h3>
</div>
<div class="section level3">
<h3 id="for-regression">For Regression<a class="anchor" aria-label="anchor" href="#for-regression"></a>
</h3>
<p>MAE (Mean Absolute Error) and MSE (Mean Squared Error) are two
commonly used metrics to evaluate the performance of regression models
by measuring the difference between predicted values and actual
values.</p>
</div>
<div class="section level3">
<h3 id="mean-absolute-error-mae">Mean Absolute Error (MAE)<a class="anchor" aria-label="anchor" href="#mean-absolute-error-mae"></a>
</h3>
<p>Definition: MAE is the average of the absolute differences between
predicted values and actual values.</p>
<p>Formula:</p>
<p><span class="math inline">\(MAE = \frac{1}{n}\sum_{i = 1}^{n} ∣y_i −
x_i∣\)</span></p>
<p>Where:</p>
<ul>
<li>
<span class="math inline">\(n\)</span> = number of data points</li>
<li>
<span class="math inline">\(x_i\)</span>= actual value</li>
<li>
<span class="math inline">\(y_i\)</span> = predicted value</li>
</ul>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_absolute_error</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>y_true <span class="op">=</span> [<span class="dv">3</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">7</span>]</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>y_pred <span class="op">=</span> [<span class="fl">2.5</span>, <span class="fl">0.0</span>, <span class="dv">2</span>, <span class="dv">8</span>]</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>mean_absolute_error(y_true, y_pred)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>y_true <span class="op">=</span> [[<span class="fl">0.5</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">7</span>, <span class="op">-</span><span class="dv">6</span>]]</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>y_pred <span class="op">=</span> [[<span class="dv">0</span>, <span class="dv">2</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">8</span>, <span class="op">-</span><span class="dv">5</span>]]</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>mean_absolute_error(y_true, y_pred)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>mean_absolute_error(y_true, y_pred, multioutput<span class="op">=</span><span class="st">'raw_values'</span>)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>mean_absolute_error(y_true, y_pred, multioutput<span class="op">=</span>[<span class="fl">0.3</span>, <span class="fl">0.7</span>])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">Out</span><span class="op">[</span><span class="fl">26</span><span class="op">]</span><span class="op">:</span> <span class="fl">0.85</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="mean-squared-error-mse">Mean Squared Error (MSE)<a class="anchor" aria-label="anchor" href="#mean-squared-error-mse"></a>
</h3>
<p>Definition: MSE is the average of the squared differences between
predicted values and actual values.</p>
<p>Formula: <span class="math inline">\(MAE = \frac{1}{n}\sum_{i =
1}^{n}(y_i − x_i)^2\)</span> Where:</p>
<ul>
<li>
<span class="math inline">\(n\)</span> = number of data points</li>
<li>
<span class="math inline">\(x_i\)</span>= actual value</li>
<li>
<span class="math inline">\(y_i\)</span> = predicted value</li>
</ul>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>y_true <span class="op">=</span> [<span class="dv">3</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">7</span>]</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>y_pred <span class="op">=</span> [<span class="fl">2.5</span>, <span class="fl">0.0</span>, <span class="dv">2</span>, <span class="dv">8</span>]</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>mean_squared_error(y_true, y_pred)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>y_true <span class="op">=</span> [[<span class="fl">0.5</span>, <span class="dv">1</span>],[<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>],[<span class="dv">7</span>, <span class="op">-</span><span class="dv">6</span>]]</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>y_pred <span class="op">=</span> [[<span class="dv">0</span>, <span class="dv">2</span>],[<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>],[<span class="dv">8</span>, <span class="op">-</span><span class="dv">5</span>]]</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>mean_squared_error(y_true, y_pred)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>mean_squared_error(y_true, y_pred, multioutput<span class="op">=</span><span class="st">'raw_values'</span>)</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>mean_squared_error(y_true, y_pred, multioutput<span class="op">=</span>[<span class="fl">0.3</span>, <span class="fl">0.7</span>])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">Out</span><span class="op">[</span><span class="fl">28</span><span class="op">]</span><span class="op">:</span> <span class="fl">0.825</span></span></code></pre>
</div>
<p>In summary,</p>
<ul>
<li>Use MAE if you want a metric that is more interpretable and less
affected by outliers.</li>
<li>Use MSE (or RMSE, its square root) if large errors are especially
undesirable and need stronger penalization.</li>
</ul>
<p><img src="../fig/mse.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
</div>
<div class="section level3">
<h3 id="for-classification">For Classification<a class="anchor" aria-label="anchor" href="#for-classification"></a>
</h3>
</div>
<div class="section level3">
<h3 id="binary-crossentropy-log-loss">Binary Crossentropy (Log Loss)<a class="anchor" aria-label="anchor" href="#binary-crossentropy-log-loss"></a>
</h3>
<p>When to Use: - For binary classification problems (two classes: 0 or
1) - Also works for multi-label classification where each label is
treated independently</p>
<p>Formula:</p>
<p>For a single data point:</p>
<p>L=<span class="math inline">\(−(y*log(y^i)+(1−y)*log(1−y^i))\)</span></p>
<p>Where:</p>
<ul>
<li>
<span class="math inline">\(y=\)</span> actual label (0 or 1)</li>
<li>
<span class="math inline">\(y^i=\)</span> predicted probability for
class 1 (between 0 and 1)</li>
</ul>
<p>Example Use Case:</p>
<ul>
<li>Spam detection (spam = 1, not spam = 0)</li>
<li>Predicting disease presence (positive/negative)</li>
</ul>
<p>Example:</p>
<p>Let’s say you have two data points:</p>
<ul>
<li>Point 1: True label (y) = 1, predicted probability (p) = 0.8</li>
<li>Point 2: True label (y) = 0, predicted probability (p) = 0.3</li>
<li>Point 1 loss: -(1 * log(0.8) + (1 - 1) * log(1 - 0.8)) = -log(0.8) ≈
0.223</li>
<li>Point 2 loss: -(0 * log(0.3) + (1 - 0) * log(1 - 0.3)) = -log(0.7) ≈
0.357</li>
</ul>
<p>Total loss: 0.223 + 0.357 = 0.58 Average loss: 0.58 / 2 = 0.29</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> log_loss</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>log_loss([<span class="st">"spam"</span>, <span class="st">"ham"</span>, <span class="st">"ham"</span>, <span class="st">"spam"</span>],[[<span class="fl">.1</span>, <span class="fl">.9</span>], [<span class="fl">.9</span>, <span class="fl">.1</span>], [<span class="fl">.8</span>, <span class="fl">.2</span>], [<span class="fl">.35</span>, <span class="fl">.65</span>]])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">0.21616</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="categorical-crossentropy">Categorical Crossentropy<a class="anchor" aria-label="anchor" href="#categorical-crossentropy"></a>
</h3>
<p>When to Use: - For multi-class classification problems (more than 2
classes) - Labels are one-hot encoded (e.g., for 3 classes: [1, 0, 0],
[0, 1, 0], [0, 0, 1])</p>
<p>Formula:</p>
<p>L<span class="math inline">\(=−c\sum_{i = 1}^{n} yc
⋅log(y^c)\)</span></p>
<p>Where:</p>
<ul>
<li>
<span class="math inline">\(C=\)</span> number of classes</li>
<li>
<span class="math inline">\(yc=\)</span> actual label (1 for correct
class, 0 otherwise)</li>
<li>
<span class="math inline">\(y^c =\)</span> predicted probability for
class c (output of softmax)</li>
</ul>
<p>Example Use Case:</p>
<ul>
<li>Image classification with multiple classes (e.g., cats, dogs,
horses)</li>
<li>Sentiment analysis with multiple categories (positive, neutral,
negative)</li>
</ul>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="im">from</span> torch <span class="im">import</span> nn</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co"># Example of target with class indices</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>loss <span class="op">=</span> nn.CrossEntropyLoss()</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="bu">input</span> <span class="op">=</span> torch.randn(<span class="dv">3</span>, <span class="dv">5</span>, requires_grad<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>target <span class="op">=</span> torch.empty(<span class="dv">3</span>, dtype<span class="op">=</span>torch.<span class="bu">long</span>).random_(<span class="dv">5</span>)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="bu">print</span>(target)</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>output <span class="op">=</span> loss(<span class="bu">input</span>, target)</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="bu">print</span>(output)</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>output.backward()</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co"># Example of target with class probabilities</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="bu">input</span> <span class="op">=</span> torch.randn(<span class="dv">3</span>, <span class="dv">5</span>, requires_grad<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>target <span class="op">=</span> torch.randn(<span class="dv">3</span>, <span class="dv">5</span>).softmax(dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>output <span class="op">=</span> loss(<span class="bu">input</span>, target)</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>output.backward()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>tensor([0, 1, 4])
tensor(1.5236, grad_fn=&lt;NllLossBackward0&gt;)
</code></pre>
</div>
<p><img src="../fig/differences.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>Summary</p>
<ul>
<li>Use Binary Crossentropy for 2-class problems or independent
multi-label outputs</li>
<li>Use Categorical Crossentropy for multi-class, one-hot encoded
labels</li>
<li>Use Sparse Categorical Crossentropy for multi-class problems with
integer labels</li>
</ul>
</div>
</section><section><h2 class="section-heading" id="analysing-loss-curves">Analysing loss curves<a class="anchor" aria-label="anchor" href="#analysing-loss-curves"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="what-are-loss-curves">What Are Loss Curves?<a class="anchor" aria-label="anchor" href="#what-are-loss-curves"></a>
</h3>
<p>Loss curves plot the model’s loss over time (typically per epoch)
for:</p>
<ul>
<li>Training Loss: How well the model fits the training data</li>
<li>Validation Loss: How well the model generalizes to unseen data</li>
</ul>
<p>Goal:</p>
<ul>
<li>Steady decrease in training and validation loss, with minimal gap
between them to avoid overfitting</li>
</ul>
</div>
<div class="section level3">
<h3 id="how-to-interpret-loss-curves">How to Interpret Loss Curves<a class="anchor" aria-label="anchor" href="#how-to-interpret-loss-curves"></a>
</h3>
</div>
<div class="section level3">
<h3 id="ideal-scenario">Ideal Scenario<a class="anchor" aria-label="anchor" href="#ideal-scenario"></a>
</h3>
<ul>
<li>Both training and validation loss decrease smoothly Validation loss
stabilizes or slightly increases at the end</li>
<li>Model is learning and generalizing well</li>
</ul>
<p><img src="../fig/864224b4224e47216fdf443996b517f9e259438d.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>(cite: <a href="https://discuss.pytorch.org/t/plotting-loss-curve/42632" class="external-link uri">https://discuss.pytorch.org/t/plotting-loss-curve/42632</a>)</p>
<p><img src="../fig/images.jpeg" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>(cite:<a href="https://www.digilab.ai/" class="external-link uri">https://www.digilab.ai/</a>)</p>
</div>
<div class="section level3">
<h3 id="overfitting">Overfitting<a class="anchor" aria-label="anchor" href="#overfitting"></a>
</h3>
<ul>
<li>Training loss keeps decreasing</li>
<li>Validation loss decreases initially, then starts increasing</li>
</ul>
<p>Symptoms: - High accuracy on training data - Poor performance on
validation/test data</p>
<p>Solutions:</p>
<ul>
<li>Early stopping</li>
<li>Add dropout or regularization</li>
<li>Reduce model complexity</li>
<li>Data augmentation</li>
</ul>
<p><img src="../fig/images2.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>(cite:<a href="https://developers.google.com/machine-learning/crash-course/overfitting/interpreting-loss-curves" class="external-link uri">https://developers.google.com/machine-learning/crash-course/overfitting/interpreting-loss-curves</a>)</p>
</div>
<div class="section level3">
<h3 id="underfitting">Underfitting<a class="anchor" aria-label="anchor" href="#underfitting"></a>
</h3>
<ul>
<li>Both training and validation loss stay high</li>
<li>Minimal improvement across epochs</li>
</ul>
<p>Symptoms: - Model isn’t learning patterns well</p>
<p>Solutions:</p>
<ul>
<li>Increase model complexity (more layers/units)</li>
<li>Train for more epochs</li>
<li>Try a lower learning rate</li>
<li>Change activation functions or optimizer</li>
</ul>
<p><img src="../fig/maxresdefault.jpg" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>(cite:<a href="https://developers.google.com/machine-learning/crash-course/overfitting/interpreting-loss-curves" class="external-link uri">https://developers.google.com/machine-learning/crash-course/overfitting/interpreting-loss-curves</a>)</p>
</div>
<div class="section level3">
<h3 id="high-variance-noisy-loss-curves">High Variance (Noisy Loss Curves)<a class="anchor" aria-label="anchor" href="#high-variance-noisy-loss-curves"></a>
</h3>
<p>Loss curves are erratic with spikes</p>
<p>Causes:</p>
<ul>
<li>Too high learning rate</li>
<li>Small batch size</li>
</ul>
<p>Insufficient data</p>
<p>Solutions:</p>
<ul>
<li>Reduce learning rate</li>
<li>Increase batch size</li>
<li>Collect more data</li>
</ul>
<p><img src="../fig/loss_curve.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
</div>
</section><section><h2 class="section-heading" id="what-is-hyperparameter-tuning">What is Hyperparameter Tuning?<a class="anchor" aria-label="anchor" href="#what-is-hyperparameter-tuning"></a>
</h2>
<hr class="half-width">
<p>Hyperparameters are settings defined before training that control the
learning process and model structure.</p>
<ul>
<li>They are not learned from the data</li>
<li>Must be set manually or via search strategies</li>
<li>Tuning them properly can dramatically boost model performance</li>
</ul>
<p><img src="../fig/common_hypers.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>As you can see the majority of machine learning models have some sort
of hyperparameter that can be configured. Usually when you go and use
these models they will have default parameters already coding into the
functions, allowing you to train a model before delevin into the actual
parameter refinement. Even then be prepared depending on your models
training time hyper parameter selection can be a long process, but there
are a few methods to speed it up.</p>
<p><img src="../fig/tuning_methods.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>Traditional machine learning usually has very few hyper parameters
compared to deep learning and therefore are normally quicker and easier.
Lets have a focus of a deep learning and see what hyper parameters are
required to run them.</p>
<p><img src="../fig/NN_hyper.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p><img src="../fig/NN_hyper_refined.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>Lets focus on two important hyper parameters.</p>
<div class="section level3">
<h3 id="learning-rate">Learning rate<a class="anchor" aria-label="anchor" href="#learning-rate"></a>
</h3>
<p>The learning rate is one of the most critical hyperparameters in
training machine learning models, especially in gradient-based
optimization (like with neural networks). It controls how much the
model’s weights are updated during training in response to the
calculated loss gradient. Here’s how it affects training: If the
learning rate is too high:</p>
<ul>
<li>Overshooting: The model may skip over the optimal weights and never
converge, or even diverge completely.</li>
<li>Instability: The loss can fluctuate wildly and fail to
decrease.</li>
<li>Poor performance: May result in worse accuracy, even if the model
initially improves quickly.</li>
</ul>
<p>If the learning rate is too low:</p>
<ul>
<li>Slow convergence: Training takes a very long time, and you might
waste compute resources.</li>
<li>Getting stuck: The model can get trapped in local minima or plateaus
and not make meaningful progress.</li>
<li>Overfitting risk: More epochs might be needed, which can lead to
overfitting if regularization isn’t strong enough.</li>
</ul>
</div>
<div class="section level3">
<h3 id="optimizer">Optimizer<a class="anchor" aria-label="anchor" href="#optimizer"></a>
</h3>
<p>A machine learning optimizer is an algorithm used to adjust the
parameters (weights) of a machine learning model to minimize a loss
function during training.The purpose of an optimizer is to find the set
of model parameters that results in the best performance on your
training data, typically by minimizing error or maximizing accuracy.</p>
<p><img src="../fig/optimiser.png" alt="Flow Diagram for determining supvervised vs unsupervised" class="figure">.</p>
<p>A detailed understanding of how optimizers work is beyond the scope
of this course, so using SGD or Adam as a starting point is generally
recommended.</p>
</div>
<div class="section level3">
<h3 id="transfer-learning-the-hero-in-the-night">Transfer Learning (The hero in the night)<a class="anchor" aria-label="anchor" href="#transfer-learning-the-hero-in-the-night"></a>
</h3>
<p>Definition: Using a pre-trained model on a similar task and
fine-tuning it for your specific task.</p>
<p>How it Works:</p>
<ul>
<li>Take a model trained on a large dataset (e.g., ImageNet for
images)</li>
<li>Keep learned weights (often in lower layers)</li>
<li>Replace final layers for your task</li>
<li>Optionally, fine-tune some or all layers</li>
</ul>
<p>Benefits:</p>
<ul>
<li>Speeds up training</li>
<li>Requires less labeled data</li>
<li>Boosts performance on smaller datasets</li>
</ul>
</div>
</section><section><h2 class="section-heading" id="putting-it-all-together-examples">Putting it all together examples<a class="anchor" aria-label="anchor" href="#putting-it-all-together-examples"></a>
</h2>
<hr class="half-width"></section><section><h2 class="section-heading" id="classification-example">Classification example<a class="anchor" aria-label="anchor" href="#classification-example"></a>
</h2>
<hr class="half-width">
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="im">import</span> torchvision</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="im">import</span> torchvision.transforms <span class="im">as</span> transforms</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>transform <span class="op">=</span> transforms.Compose(</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>    [transforms.ToTensor(),</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>     transforms.Normalize((<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), (<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))])</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>trainset <span class="op">=</span> torchvision.datasets.CIFAR10(root<span class="op">=</span><span class="st">'./data'</span>, train<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>                                        download<span class="op">=</span><span class="va">True</span>, transform<span class="op">=</span>transform)</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>trainloader <span class="op">=</span> torch.utils.data.DataLoader(trainset, batch_size<span class="op">=</span>batch_size,</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>                                          shuffle<span class="op">=</span><span class="va">True</span>, num_workers<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>testset <span class="op">=</span> torchvision.datasets.CIFAR10(root<span class="op">=</span><span class="st">'./data'</span>, train<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>                                       download<span class="op">=</span><span class="va">True</span>, transform<span class="op">=</span>transform)</span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>testloader <span class="op">=</span> torch.utils.data.DataLoader(testset, batch_size<span class="op">=</span>batch_size,</span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>                                         shuffle<span class="op">=</span><span class="va">False</span>, num_workers<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>classes <span class="op">=</span> (<span class="st">'plane'</span>, <span class="st">'car'</span>, <span class="st">'bird'</span>, <span class="st">'cat'</span>,</span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a>           <span class="st">'deer'</span>, <span class="st">'dog'</span>, <span class="st">'frog'</span>, <span class="st">'horse'</span>, <span class="st">'ship'</span>, <span class="st">'truck'</span>)</span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a><span class="kw">def</span> imshow(img):</span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a>    img <span class="op">=</span> img <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> <span class="fl">0.5</span>     <span class="co"># unnormalize</span></span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a>    npimg <span class="op">=</span> img.numpy()</span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a>    plt.imshow(np.transpose(npimg, (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>)))</span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a>    plt.show()</span>
<span id="cb18-31"><a href="#cb18-31" tabindex="-1"></a>    </span>
<span id="cb18-32"><a href="#cb18-32" tabindex="-1"></a>    <span class="co"># get some random training images</span></span>
<span id="cb18-33"><a href="#cb18-33" tabindex="-1"></a>dataiter <span class="op">=</span> <span class="bu">iter</span>(trainloader)</span>
<span id="cb18-34"><a href="#cb18-34" tabindex="-1"></a>images, labels <span class="op">=</span> <span class="bu">next</span>(dataiter)</span>
<span id="cb18-35"><a href="#cb18-35" tabindex="-1"></a></span>
<span id="cb18-36"><a href="#cb18-36" tabindex="-1"></a><span class="co"># show images</span></span>
<span id="cb18-37"><a href="#cb18-37" tabindex="-1"></a>imshow(torchvision.utils.make_grid(images))</span>
<span id="cb18-38"><a href="#cb18-38" tabindex="-1"></a><span class="co"># print labels</span></span>
<span id="cb18-39"><a href="#cb18-39" tabindex="-1"></a><span class="bu">print</span>(<span class="st">' '</span>.join(<span class="ss">f'</span><span class="sc">{</span>classes[labels[j]]<span class="sc">:5s}</span><span class="ss">'</span> <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(batch_size)))</span>
<span id="cb18-40"><a href="#cb18-40" tabindex="-1"></a></span>
<span id="cb18-41"><a href="#cb18-41" tabindex="-1"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb18-42"><a href="#cb18-42" tabindex="-1"></a><span class="im">import</span> torch.nn.functional <span class="im">as</span> F</span>
<span id="cb18-43"><a href="#cb18-43" tabindex="-1"></a></span>
<span id="cb18-44"><a href="#cb18-44" tabindex="-1"></a></span>
<span id="cb18-45"><a href="#cb18-45" tabindex="-1"></a><span class="kw">class</span> Net(nn.Module):</span>
<span id="cb18-46"><a href="#cb18-46" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb18-47"><a href="#cb18-47" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb18-48"><a href="#cb18-48" tabindex="-1"></a>        <span class="va">self</span>.conv1 <span class="op">=</span> nn.Conv2d(<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">5</span>)</span>
<span id="cb18-49"><a href="#cb18-49" tabindex="-1"></a>        <span class="va">self</span>.pool <span class="op">=</span> nn.MaxPool2d(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb18-50"><a href="#cb18-50" tabindex="-1"></a>        <span class="va">self</span>.conv2 <span class="op">=</span> nn.Conv2d(<span class="dv">6</span>, <span class="dv">16</span>, <span class="dv">5</span>)</span>
<span id="cb18-51"><a href="#cb18-51" tabindex="-1"></a>        <span class="va">self</span>.fc1 <span class="op">=</span> nn.Linear(<span class="dv">16</span> <span class="op">*</span> <span class="dv">5</span> <span class="op">*</span> <span class="dv">5</span>, <span class="dv">120</span>)</span>
<span id="cb18-52"><a href="#cb18-52" tabindex="-1"></a>        <span class="va">self</span>.fc2 <span class="op">=</span> nn.Linear(<span class="dv">120</span>, <span class="dv">84</span>)</span>
<span id="cb18-53"><a href="#cb18-53" tabindex="-1"></a>        <span class="va">self</span>.fc3 <span class="op">=</span> nn.Linear(<span class="dv">84</span>, <span class="dv">10</span>)</span>
<span id="cb18-54"><a href="#cb18-54" tabindex="-1"></a></span>
<span id="cb18-55"><a href="#cb18-55" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb18-56"><a href="#cb18-56" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.pool(F.relu(<span class="va">self</span>.conv1(x)))</span>
<span id="cb18-57"><a href="#cb18-57" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.pool(F.relu(<span class="va">self</span>.conv2(x)))</span>
<span id="cb18-58"><a href="#cb18-58" tabindex="-1"></a>        x <span class="op">=</span> torch.flatten(x, <span class="dv">1</span>) <span class="co"># flatten all dimensions except batch</span></span>
<span id="cb18-59"><a href="#cb18-59" tabindex="-1"></a>        x <span class="op">=</span> F.relu(<span class="va">self</span>.fc1(x))</span>
<span id="cb18-60"><a href="#cb18-60" tabindex="-1"></a>        x <span class="op">=</span> F.relu(<span class="va">self</span>.fc2(x))</span>
<span id="cb18-61"><a href="#cb18-61" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc3(x)</span>
<span id="cb18-62"><a href="#cb18-62" tabindex="-1"></a>        <span class="cf">return</span> x</span>
<span id="cb18-63"><a href="#cb18-63" tabindex="-1"></a></span>
<span id="cb18-64"><a href="#cb18-64" tabindex="-1"></a></span>
<span id="cb18-65"><a href="#cb18-65" tabindex="-1"></a>net <span class="op">=</span> Net()</span>
<span id="cb18-66"><a href="#cb18-66" tabindex="-1"></a></span>
<span id="cb18-67"><a href="#cb18-67" tabindex="-1"></a><span class="im">import</span> torch.optim <span class="im">as</span> optim</span>
<span id="cb18-68"><a href="#cb18-68" tabindex="-1"></a></span>
<span id="cb18-69"><a href="#cb18-69" tabindex="-1"></a>criterion <span class="op">=</span> nn.CrossEntropyLoss()</span>
<span id="cb18-70"><a href="#cb18-70" tabindex="-1"></a>optimizer <span class="op">=</span> optim.SGD(net.parameters(), lr<span class="op">=</span><span class="fl">0.001</span>, momentum<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb18-71"><a href="#cb18-71" tabindex="-1"></a></span>
<span id="cb18-72"><a href="#cb18-72" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):  <span class="co"># loop over the dataset multiple times</span></span>
<span id="cb18-73"><a href="#cb18-73" tabindex="-1"></a></span>
<span id="cb18-74"><a href="#cb18-74" tabindex="-1"></a>    running_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb18-75"><a href="#cb18-75" tabindex="-1"></a>    <span class="cf">for</span> i, data <span class="kw">in</span> <span class="bu">enumerate</span>(trainloader, <span class="dv">0</span>):</span>
<span id="cb18-76"><a href="#cb18-76" tabindex="-1"></a>        <span class="co"># get the inputs; data is a list of [inputs, labels]</span></span>
<span id="cb18-77"><a href="#cb18-77" tabindex="-1"></a>        inputs, labels <span class="op">=</span> data</span>
<span id="cb18-78"><a href="#cb18-78" tabindex="-1"></a></span>
<span id="cb18-79"><a href="#cb18-79" tabindex="-1"></a>        <span class="co"># zero the parameter gradients</span></span>
<span id="cb18-80"><a href="#cb18-80" tabindex="-1"></a>        optimizer.zero_grad()</span>
<span id="cb18-81"><a href="#cb18-81" tabindex="-1"></a></span>
<span id="cb18-82"><a href="#cb18-82" tabindex="-1"></a>        <span class="co"># forward + backward + optimize</span></span>
<span id="cb18-83"><a href="#cb18-83" tabindex="-1"></a>        outputs <span class="op">=</span> net(inputs)</span>
<span id="cb18-84"><a href="#cb18-84" tabindex="-1"></a>        loss <span class="op">=</span> criterion(outputs, labels)</span>
<span id="cb18-85"><a href="#cb18-85" tabindex="-1"></a>        loss.backward()</span>
<span id="cb18-86"><a href="#cb18-86" tabindex="-1"></a>        optimizer.step()</span>
<span id="cb18-87"><a href="#cb18-87" tabindex="-1"></a></span>
<span id="cb18-88"><a href="#cb18-88" tabindex="-1"></a>        <span class="co"># print statistics</span></span>
<span id="cb18-89"><a href="#cb18-89" tabindex="-1"></a>        running_loss <span class="op">+=</span> loss.item()</span>
<span id="cb18-90"><a href="#cb18-90" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">%</span> <span class="dv">2000</span> <span class="op">==</span> <span class="dv">1999</span>:    <span class="co"># print every 2000 mini-batches</span></span>
<span id="cb18-91"><a href="#cb18-91" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f'[</span><span class="sc">{</span>epoch <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>i <span class="op">+</span> <span class="dv">1</span><span class="sc">:5d}</span><span class="ss">] loss: </span><span class="sc">{</span>running_loss <span class="op">/</span> <span class="dv">2000</span><span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb18-92"><a href="#cb18-92" tabindex="-1"></a>            running_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb18-93"><a href="#cb18-93" tabindex="-1"></a></span>
<span id="cb18-94"><a href="#cb18-94" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Finished Training'</span>)</span>
<span id="cb18-95"><a href="#cb18-95" tabindex="-1"></a></span>
<span id="cb18-96"><a href="#cb18-96" tabindex="-1"></a>dataiter <span class="op">=</span> <span class="bu">iter</span>(testloader)</span>
<span id="cb18-97"><a href="#cb18-97" tabindex="-1"></a>images, labels <span class="op">=</span> <span class="bu">next</span>(dataiter)</span>
<span id="cb18-98"><a href="#cb18-98" tabindex="-1"></a></span>
<span id="cb18-99"><a href="#cb18-99" tabindex="-1"></a><span class="co"># print images</span></span>
<span id="cb18-100"><a href="#cb18-100" tabindex="-1"></a>imshow(torchvision.utils.make_grid(images))</span>
<span id="cb18-101"><a href="#cb18-101" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'GroundTruth: '</span>, <span class="st">' '</span>.join(<span class="ss">f'</span><span class="sc">{</span>classes[labels[j]]<span class="sc">:5s}</span><span class="ss">'</span> <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>)))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>car   deer  bird  bird
[1,  2000] loss: 2.221
[1,  4000] loss: 1.841
[1,  6000] loss: 1.684
[1,  8000] loss: 1.575
[1, 10000] loss: 1.522
[1, 12000] loss: 1.490
[2,  2000] loss: 1.422
[2,  4000] loss: 1.401
[2,  6000] loss: 1.341
[2,  8000] loss: 1.356
[2, 10000] loss: 1.317
[2, 12000] loss: 1.308
[3,  2000] loss: 1.253
[3,  4000] loss: 1.232
[3,  6000] loss: 1.228
[3,  8000] loss: 1.194
[3, 10000] loss: 1.206
[3, 12000] loss: 1.205
[4,  2000] loss: 1.125
[4,  4000] loss: 1.118
[4,  6000] loss: 1.125
[4,  8000] loss: 1.151
[4, 10000] loss: 1.128
[4, 12000] loss: 1.114
[5,  2000] loss: 1.051
[5,  4000] loss: 1.053
[5,  6000] loss: 1.069
[5,  8000] loss: 1.047
[5, 10000] loss: 1.057
[5, 12000] loss: 1.073
Finished Training
GroundTruth:  cat   ship  ship  plane
Predicted:  cat   ship  ship  ship
Accuracy of the network on the 10000 test images: 59 %
</code></pre>
</div>
</section><section><h2 class="section-heading" id="time-series-parameter-example">Time series parameter example<a class="anchor" aria-label="anchor" href="#time-series-parameter-example"></a>
</h2>
<hr class="half-width">
<p>data: <a href="https://drive.google.com/file/d/1CkL0_PEZwMFHz97sExRBluh_CYxwKqFr/view?usp=sharing" class="external-link uri">https://drive.google.com/file/d/1CkL0_PEZwMFHz97sExRBluh_CYxwKqFr/view?usp=sharing</a></p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="im">import</span> torch.optim <span class="im">as</span> optim</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="im">import</span> torch.utils.data <span class="im">as</span> data</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a> </span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'AirPassengers.csv'</span>)</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>timeseries <span class="op">=</span> df[[<span class="st">"Passengers"</span>]].values.astype(<span class="st">'float32'</span>)</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a> </span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co"># train-test split for time series</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>train_size <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(timeseries) <span class="op">*</span> <span class="fl">0.67</span>)</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>test_size <span class="op">=</span> <span class="bu">len</span>(timeseries) <span class="op">-</span> train_size</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>train, test <span class="op">=</span> timeseries[:train_size], timeseries[train_size:]</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a> </span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a><span class="kw">def</span> create_dataset(dataset, lookback):</span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>    <span class="co">"""Transform a time series into a prediction dataset</span></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a><span class="co">        dataset: A numpy array of time series, first dimension is the time steps</span></span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a><span class="co">        lookback: Size of window for prediction</span></span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a>    X, y <span class="op">=</span> [], []</span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dataset)<span class="op">-</span>lookback):</span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a>        feature <span class="op">=</span> dataset[i:i<span class="op">+</span>lookback]</span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a>        target <span class="op">=</span> dataset[i<span class="op">+</span><span class="dv">1</span>:i<span class="op">+</span>lookback<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a>        X.append(feature)</span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a>        y.append(target)</span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a>    <span class="cf">return</span> torch.tensor(X), torch.tensor(y)</span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a> </span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a>lookback <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb20-33"><a href="#cb20-33" tabindex="-1"></a>X_train, y_train <span class="op">=</span> create_dataset(train, lookback<span class="op">=</span>lookback)</span>
<span id="cb20-34"><a href="#cb20-34" tabindex="-1"></a>X_test, y_test <span class="op">=</span> create_dataset(test, lookback<span class="op">=</span>lookback)</span>
<span id="cb20-35"><a href="#cb20-35" tabindex="-1"></a> </span>
<span id="cb20-36"><a href="#cb20-36" tabindex="-1"></a><span class="kw">class</span> AirModel(nn.Module):</span>
<span id="cb20-37"><a href="#cb20-37" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb20-38"><a href="#cb20-38" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb20-39"><a href="#cb20-39" tabindex="-1"></a>        <span class="va">self</span>.lstm <span class="op">=</span> nn.LSTM(input_size<span class="op">=</span><span class="dv">1</span>, hidden_size<span class="op">=</span><span class="dv">50</span>, num_layers<span class="op">=</span><span class="dv">1</span>, batch_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-40"><a href="#cb20-40" tabindex="-1"></a>        <span class="va">self</span>.linear <span class="op">=</span> nn.Linear(<span class="dv">50</span>, <span class="dv">1</span>)</span>
<span id="cb20-41"><a href="#cb20-41" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb20-42"><a href="#cb20-42" tabindex="-1"></a>        x, _ <span class="op">=</span> <span class="va">self</span>.lstm(x)</span>
<span id="cb20-43"><a href="#cb20-43" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.linear(x)</span>
<span id="cb20-44"><a href="#cb20-44" tabindex="-1"></a>        <span class="cf">return</span> x</span>
<span id="cb20-45"><a href="#cb20-45" tabindex="-1"></a> </span>
<span id="cb20-46"><a href="#cb20-46" tabindex="-1"></a>model <span class="op">=</span> AirModel()</span>
<span id="cb20-47"><a href="#cb20-47" tabindex="-1"></a>optimizer <span class="op">=</span> optim.Adam(model.parameters())</span>
<span id="cb20-48"><a href="#cb20-48" tabindex="-1"></a>loss_fn <span class="op">=</span> nn.MSELoss()</span>
<span id="cb20-49"><a href="#cb20-49" tabindex="-1"></a>loader <span class="op">=</span> data.DataLoader(data.TensorDataset(X_train, y_train), shuffle<span class="op">=</span><span class="va">True</span>, batch_size<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb20-50"><a href="#cb20-50" tabindex="-1"></a> </span>
<span id="cb20-51"><a href="#cb20-51" tabindex="-1"></a>n_epochs <span class="op">=</span> <span class="dv">2000</span></span>
<span id="cb20-52"><a href="#cb20-52" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(n_epochs):</span>
<span id="cb20-53"><a href="#cb20-53" tabindex="-1"></a>    model.train()</span>
<span id="cb20-54"><a href="#cb20-54" tabindex="-1"></a>    <span class="cf">for</span> X_batch, y_batch <span class="kw">in</span> loader:</span>
<span id="cb20-55"><a href="#cb20-55" tabindex="-1"></a>        y_pred <span class="op">=</span> model(X_batch)</span>
<span id="cb20-56"><a href="#cb20-56" tabindex="-1"></a>        loss <span class="op">=</span> loss_fn(y_pred, y_batch)</span>
<span id="cb20-57"><a href="#cb20-57" tabindex="-1"></a>        optimizer.zero_grad()</span>
<span id="cb20-58"><a href="#cb20-58" tabindex="-1"></a>        loss.backward()</span>
<span id="cb20-59"><a href="#cb20-59" tabindex="-1"></a>        optimizer.step()</span>
<span id="cb20-60"><a href="#cb20-60" tabindex="-1"></a>    <span class="co"># Validation</span></span>
<span id="cb20-61"><a href="#cb20-61" tabindex="-1"></a>    <span class="cf">if</span> epoch <span class="op">%</span> <span class="dv">100</span> <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb20-62"><a href="#cb20-62" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb20-63"><a href="#cb20-63" tabindex="-1"></a>    model.<span class="bu">eval</span>()</span>
<span id="cb20-64"><a href="#cb20-64" tabindex="-1"></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb20-65"><a href="#cb20-65" tabindex="-1"></a>        y_pred <span class="op">=</span> model(X_train)</span>
<span id="cb20-66"><a href="#cb20-66" tabindex="-1"></a>        train_rmse <span class="op">=</span> np.sqrt(loss_fn(y_pred, y_train))</span>
<span id="cb20-67"><a href="#cb20-67" tabindex="-1"></a>        y_pred <span class="op">=</span> model(X_test)</span>
<span id="cb20-68"><a href="#cb20-68" tabindex="-1"></a>        test_rmse <span class="op">=</span> np.sqrt(loss_fn(y_pred, y_test))</span>
<span id="cb20-69"><a href="#cb20-69" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Epoch </span><span class="sc">%d</span><span class="st">: train RMSE </span><span class="sc">%.4f</span><span class="st">, test RMSE </span><span class="sc">%.4f</span><span class="st">"</span> <span class="op">%</span> (epoch, train_rmse, test_rmse))</span>
<span id="cb20-70"><a href="#cb20-70" tabindex="-1"></a> </span>
<span id="cb20-71"><a href="#cb20-71" tabindex="-1"></a><span class="cf">with</span> torch.no_grad():</span>
<span id="cb20-72"><a href="#cb20-72" tabindex="-1"></a>    <span class="co"># shift train predictions for plotting</span></span>
<span id="cb20-73"><a href="#cb20-73" tabindex="-1"></a>    train_plot <span class="op">=</span> np.ones_like(timeseries) <span class="op">*</span> np.nan</span>
<span id="cb20-74"><a href="#cb20-74" tabindex="-1"></a>    y_pred <span class="op">=</span> model(X_train)</span>
<span id="cb20-75"><a href="#cb20-75" tabindex="-1"></a>    y_pred <span class="op">=</span> y_pred[:, <span class="op">-</span><span class="dv">1</span>, :]</span>
<span id="cb20-76"><a href="#cb20-76" tabindex="-1"></a>    train_plot[lookback:train_size] <span class="op">=</span> model(X_train)[:, <span class="op">-</span><span class="dv">1</span>, :]</span>
<span id="cb20-77"><a href="#cb20-77" tabindex="-1"></a>    <span class="co"># shift test predictions for plotting</span></span>
<span id="cb20-78"><a href="#cb20-78" tabindex="-1"></a>    test_plot <span class="op">=</span> np.ones_like(timeseries) <span class="op">*</span> np.nan</span>
<span id="cb20-79"><a href="#cb20-79" tabindex="-1"></a>    test_plot[train_size<span class="op">+</span>lookback:<span class="bu">len</span>(timeseries)] <span class="op">=</span> model(X_test)[:, <span class="op">-</span><span class="dv">1</span>, :]</span>
<span id="cb20-80"><a href="#cb20-80" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb20-81"><a href="#cb20-81" tabindex="-1"></a>plt.plot(timeseries)</span>
<span id="cb20-82"><a href="#cb20-82" tabindex="-1"></a>plt.plot(train_plot, c<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb20-83"><a href="#cb20-83" tabindex="-1"></a>plt.plot(test_plot, c<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb20-84"><a href="#cb20-84" tabindex="-1"></a>plt.show()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/home/corcor27/Documents/time_series_example.py:66: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  train_rmse = np.sqrt(loss_fn(y_pred, y_train))
/home/corcor27/Documents/time_series_example.py:68: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  test_rmse = np.sqrt(loss_fn(y_pred, y_test))
Epoch 0: train RMSE 226.0555, test RMSE 425.2918
Epoch 100: train RMSE 180.3027, test RMSE 377.3510
Epoch 200: train RMSE 145.4659, test RMSE 339.4402
Epoch 300: train RMSE 116.3985, test RMSE 305.5107
Epoch 400: train RMSE 94.1039, test RMSE 275.5995
Epoch 500: train RMSE 72.6241, test RMSE 244.1789
Epoch 600: train RMSE 56.9958, test RMSE 215.7754
Epoch 700: train RMSE 45.2195, test RMSE 190.4163
Epoch 800: train RMSE 37.3441, test RMSE 168.7669
Epoch 900: train RMSE 31.8818, test RMSE 150.3023
Epoch 1000: train RMSE 28.1362, test RMSE 134.6788
Epoch 1100: train RMSE 25.6366, test RMSE 121.9030
Epoch 1200: train RMSE 24.1227, test RMSE 110.8427
Epoch 1300: train RMSE 23.1641, test RMSE 102.8851
Epoch 1400: train RMSE 22.0363, test RMSE 96.8792
Epoch 1500: train RMSE 21.3094, test RMSE 90.6086
Epoch 1600: train RMSE 20.6500, test RMSE 86.9244
Epoch 1700: train RMSE 20.8895, test RMSE 83.7368
Epoch 1800: train RMSE 20.1709, test RMSE 82.1835
Epoch 1900: train RMSE 19.8376, test RMSE 80.0266
/home/corcor27/Documents/time_series_example.py:76: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  train_plot[lookback:train_size] = model(X_train)[:, -1, :]
/home/corcor27/Documents/time_series_example.py:79: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  test_plot[train_size+lookback:len(timeseries)] = model(X_test)[:, -1, :]
</code></pre>
</div>
</section><section><h2 class="section-heading" id="parameter-estimation-example">Parameter estimation example<a class="anchor" aria-label="anchor" href="#parameter-estimation-example"></a>
</h2>
<hr class="half-width">
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="im">import</span> torch.optim <span class="im">as</span> optim</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="im">import</span> tqdm</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> fetch_california_housing</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a> </span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="co"># Read data</span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>data <span class="op">=</span> fetch_california_housing()</span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>X, y <span class="op">=</span> data.data, data.target</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a> </span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="co"># train-test split for model evaluation</span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a>X_train_raw, X_test_raw, y_train, y_test <span class="op">=</span> train_test_split(X, y, train_size<span class="op">=</span><span class="fl">0.7</span>, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a> </span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a><span class="co"># Standardizing data</span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a>scaler.fit(X_train_raw)</span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a>X_train <span class="op">=</span> scaler.transform(X_train_raw)</span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a>X_test <span class="op">=</span> scaler.transform(X_test_raw)</span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a> </span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a><span class="co"># Convert to 2D PyTorch tensors</span></span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a>X_train <span class="op">=</span> torch.tensor(X_train, dtype<span class="op">=</span>torch.float32)</span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a>y_train <span class="op">=</span> torch.tensor(y_train, dtype<span class="op">=</span>torch.float32).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a>X_test <span class="op">=</span> torch.tensor(X_test, dtype<span class="op">=</span>torch.float32)</span>
<span id="cb22-29"><a href="#cb22-29" tabindex="-1"></a>y_test <span class="op">=</span> torch.tensor(y_test, dtype<span class="op">=</span>torch.float32).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb22-30"><a href="#cb22-30" tabindex="-1"></a> </span>
<span id="cb22-31"><a href="#cb22-31" tabindex="-1"></a><span class="co"># Define the model</span></span>
<span id="cb22-32"><a href="#cb22-32" tabindex="-1"></a>model <span class="op">=</span> nn.Sequential(</span>
<span id="cb22-33"><a href="#cb22-33" tabindex="-1"></a>    nn.Linear(<span class="dv">8</span>, <span class="dv">24</span>),</span>
<span id="cb22-34"><a href="#cb22-34" tabindex="-1"></a>    nn.ReLU(),</span>
<span id="cb22-35"><a href="#cb22-35" tabindex="-1"></a>    nn.Linear(<span class="dv">24</span>, <span class="dv">12</span>),</span>
<span id="cb22-36"><a href="#cb22-36" tabindex="-1"></a>    nn.ReLU(),</span>
<span id="cb22-37"><a href="#cb22-37" tabindex="-1"></a>    nn.Linear(<span class="dv">12</span>, <span class="dv">6</span>),</span>
<span id="cb22-38"><a href="#cb22-38" tabindex="-1"></a>    nn.ReLU(),</span>
<span id="cb22-39"><a href="#cb22-39" tabindex="-1"></a>    nn.Linear(<span class="dv">6</span>, <span class="dv">1</span>)</span>
<span id="cb22-40"><a href="#cb22-40" tabindex="-1"></a>)</span>
<span id="cb22-41"><a href="#cb22-41" tabindex="-1"></a> </span>
<span id="cb22-42"><a href="#cb22-42" tabindex="-1"></a><span class="co"># loss function and optimizer</span></span>
<span id="cb22-43"><a href="#cb22-43" tabindex="-1"></a>loss_fn <span class="op">=</span> nn.MSELoss()  <span class="co"># mean square error</span></span>
<span id="cb22-44"><a href="#cb22-44" tabindex="-1"></a>optimizer <span class="op">=</span> optim.Adam(model.parameters(), lr<span class="op">=</span><span class="fl">0.0001</span>)</span>
<span id="cb22-45"><a href="#cb22-45" tabindex="-1"></a> </span>
<span id="cb22-46"><a href="#cb22-46" tabindex="-1"></a>n_epochs <span class="op">=</span> <span class="dv">20</span>   <span class="co"># number of epochs to run</span></span>
<span id="cb22-47"><a href="#cb22-47" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">10</span>  <span class="co"># size of each batch</span></span>
<span id="cb22-48"><a href="#cb22-48" tabindex="-1"></a>batch_start <span class="op">=</span> torch.arange(<span class="dv">0</span>, <span class="bu">len</span>(X_train), batch_size)</span>
<span id="cb22-49"><a href="#cb22-49" tabindex="-1"></a> </span>
<span id="cb22-50"><a href="#cb22-50" tabindex="-1"></a><span class="co"># Hold the best model</span></span>
<span id="cb22-51"><a href="#cb22-51" tabindex="-1"></a>best_mse <span class="op">=</span> np.inf   <span class="co"># init to infinity</span></span>
<span id="cb22-52"><a href="#cb22-52" tabindex="-1"></a>best_weights <span class="op">=</span> <span class="va">None</span></span>
<span id="cb22-53"><a href="#cb22-53" tabindex="-1"></a>history <span class="op">=</span> []</span>
<span id="cb22-54"><a href="#cb22-54" tabindex="-1"></a> </span>
<span id="cb22-55"><a href="#cb22-55" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(n_epochs):</span>
<span id="cb22-56"><a href="#cb22-56" tabindex="-1"></a>    model.train()</span>
<span id="cb22-57"><a href="#cb22-57" tabindex="-1"></a>    <span class="bu">print</span>(epoch)</span>
<span id="cb22-58"><a href="#cb22-58" tabindex="-1"></a>    <span class="cf">with</span> tqdm.tqdm(batch_start, unit<span class="op">=</span><span class="st">"batch"</span>, mininterval<span class="op">=</span><span class="dv">0</span>, disable<span class="op">=</span><span class="va">True</span>) <span class="im">as</span> bar:</span>
<span id="cb22-59"><a href="#cb22-59" tabindex="-1"></a>        bar.set_description(<span class="ss">f"Epoch </span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb22-60"><a href="#cb22-60" tabindex="-1"></a>        <span class="cf">for</span> start <span class="kw">in</span> bar:</span>
<span id="cb22-61"><a href="#cb22-61" tabindex="-1"></a>            <span class="co"># take a batch</span></span>
<span id="cb22-62"><a href="#cb22-62" tabindex="-1"></a>            X_batch <span class="op">=</span> X_train[start:start<span class="op">+</span>batch_size]</span>
<span id="cb22-63"><a href="#cb22-63" tabindex="-1"></a>            y_batch <span class="op">=</span> y_train[start:start<span class="op">+</span>batch_size]</span>
<span id="cb22-64"><a href="#cb22-64" tabindex="-1"></a>            <span class="co"># forward pass</span></span>
<span id="cb22-65"><a href="#cb22-65" tabindex="-1"></a>            y_pred <span class="op">=</span> model(X_batch)</span>
<span id="cb22-66"><a href="#cb22-66" tabindex="-1"></a>            loss <span class="op">=</span> loss_fn(y_pred, y_batch)</span>
<span id="cb22-67"><a href="#cb22-67" tabindex="-1"></a>            <span class="co"># backward pass</span></span>
<span id="cb22-68"><a href="#cb22-68" tabindex="-1"></a>            optimizer.zero_grad()</span>
<span id="cb22-69"><a href="#cb22-69" tabindex="-1"></a>            loss.backward()</span>
<span id="cb22-70"><a href="#cb22-70" tabindex="-1"></a>            <span class="co"># update weights</span></span>
<span id="cb22-71"><a href="#cb22-71" tabindex="-1"></a>            optimizer.step()</span>
<span id="cb22-72"><a href="#cb22-72" tabindex="-1"></a>            <span class="co"># print progress</span></span>
<span id="cb22-73"><a href="#cb22-73" tabindex="-1"></a>            bar.set_postfix(mse<span class="op">=</span><span class="bu">float</span>(loss))</span>
<span id="cb22-74"><a href="#cb22-74" tabindex="-1"></a>    <span class="co"># evaluate accuracy at end of each epoch</span></span>
<span id="cb22-75"><a href="#cb22-75" tabindex="-1"></a>    model.<span class="bu">eval</span>()</span>
<span id="cb22-76"><a href="#cb22-76" tabindex="-1"></a>    y_pred <span class="op">=</span> model(X_test)</span>
<span id="cb22-77"><a href="#cb22-77" tabindex="-1"></a>    mse <span class="op">=</span> loss_fn(y_pred, y_test)</span>
<span id="cb22-78"><a href="#cb22-78" tabindex="-1"></a>    mse <span class="op">=</span> <span class="bu">float</span>(mse)</span>
<span id="cb22-79"><a href="#cb22-79" tabindex="-1"></a>    history.append(mse)</span>
<span id="cb22-80"><a href="#cb22-80" tabindex="-1"></a>    <span class="cf">if</span> mse <span class="op">&lt;</span> best_mse:</span>
<span id="cb22-81"><a href="#cb22-81" tabindex="-1"></a>        best_mse <span class="op">=</span> mse</span>
<span id="cb22-82"><a href="#cb22-82" tabindex="-1"></a> </span>
<span id="cb22-83"><a href="#cb22-83" tabindex="-1"></a><span class="co"># restore model and return best accuracy</span></span>
<span id="cb22-84"><a href="#cb22-84" tabindex="-1"></a><span class="co">#model.load_state_dict(best_weights)</span></span>
<span id="cb22-85"><a href="#cb22-85" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"MSE: </span><span class="sc">%.2f</span><span class="st">"</span> <span class="op">%</span> best_mse)</span>
<span id="cb22-86"><a href="#cb22-86" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"RMSE: </span><span class="sc">%.2f</span><span class="st">"</span> <span class="op">%</span> np.sqrt(best_mse))</span>
<span id="cb22-87"><a href="#cb22-87" tabindex="-1"></a>plt.plot(history)</span>
<span id="cb22-88"><a href="#cb22-88" tabindex="-1"></a>plt.show()</span>
<span id="cb22-89"><a href="#cb22-89" tabindex="-1"></a> </span>
<span id="cb22-90"><a href="#cb22-90" tabindex="-1"></a>model.<span class="bu">eval</span>()</span>
<span id="cb22-91"><a href="#cb22-91" tabindex="-1"></a><span class="cf">with</span> torch.no_grad():</span>
<span id="cb22-92"><a href="#cb22-92" tabindex="-1"></a>    <span class="co"># Test out inference with 5 samples</span></span>
<span id="cb22-93"><a href="#cb22-93" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb22-94"><a href="#cb22-94" tabindex="-1"></a>        X_sample <span class="op">=</span> X_test_raw[i: i<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb22-95"><a href="#cb22-95" tabindex="-1"></a>        X_sample <span class="op">=</span> scaler.transform(X_sample)</span>
<span id="cb22-96"><a href="#cb22-96" tabindex="-1"></a>        X_sample <span class="op">=</span> torch.tensor(X_sample, dtype<span class="op">=</span>torch.float32)</span>
<span id="cb22-97"><a href="#cb22-97" tabindex="-1"></a>        y_pred <span class="op">=</span> model(X_sample)</span>
<span id="cb22-98"><a href="#cb22-98" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>X_test_raw[i]<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span>y_pred[<span class="dv">0</span>]<span class="sc">.</span>numpy()<span class="sc">}</span><span class="ss"> (expected </span><span class="sc">{</span>y_test[i]<span class="sc">.</span>numpy()<span class="sc">}</span><span class="ss">)"</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
MSE: 0.39
RMSE: 0.63
[   3.3214       47.            4.91287879    1.10606061  704.
    2.66666667   33.96       -118.32      ] -&gt; [2.4658601] (expected [1.665])
[   2.2019       24.            4.96732026    1.09477124  882.
    2.88235294   37.07       -120.84      ] -&gt; [1.0679097] (expected [1.])
[   3.5128       23.            5.17777778    0.95061728  911.
    2.24938272   36.74       -119.69      ] -&gt; [1.26838] (expected [1.216])
[ 5.70180000e+00  2.40000000e+01  6.49022556e+00  1.01954887e+00
  2.28600000e+03  3.43759398e+00  3.38300000e+01 -1.18050000e+02] -&gt; [2.6457143] (expected [2.867])
[   3.5781       35.            6.24624625    1.0960961  1026.
    3.08108108   36.62       -119.73      ] -&gt; [1.273118] (expected [0.928])</code></pre>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/RSEjas140/AAISS25_html/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/RSEjas140/AAISS25_html/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/RSEjas140/AAISS25_html/" class="external-link">Source</a></p>
				<p><a href="https://github.com/RSEjas140/AAISS25_html/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:jas140@aber.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/d03c89cd0fa3931a82df26aa15388efab7cf4e9b" class="external-link">sandpaper (0.16.13.9000)</a>, <a href="https://github.com/carpentries/pegboard/tree/5e0d711121a581777d83cf270e298c933f112d52" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.6" class="external-link">varnish (1.0.6)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://RSEjas140.github.io/AAISS25_html/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://RSEjas140.github.io/AAISS25_html/instructor/aio.html",
  "identifier": "https://RSEjas140.github.io/AAISS25_html/instructor/aio.html",
  "dateCreated": "2025-07-04",
  "dateModified": "2025-07-09",
  "datePublished": "2025-07-09"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

